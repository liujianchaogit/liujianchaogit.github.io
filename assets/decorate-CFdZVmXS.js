import{_ as T,P as U}from"./util-VxtuanPC.js";import{d as B,u as F,_ as G,L as p}from"./index-DiGvuAxb.js";import{g as H,u as j}from"./template-B9H3yEhb.js";import{u as x}from"./page-CRHcERpU.js";import{u as q}from"./tagsView-B3xQDSQ0.js";import{s as A,o as Q,t as E,I as J}from"./form-designer-drfGvdgz.js";import{k as K,r,P as N,e as O,u as a,y as V,C as W,m as g,z as d,H as w,l as X,G as Y,$ as Z}from"./form-create-D7wT855o.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./Qrcode-CbGQ2bNY.js";import"./IFrame.vue_vue_type_script_setup_true_lang-ls-ueish.js";import"./vuedraggable.umd-f2FZsIjZ.js";const y="diy_page_index",ee=K({name:"DiyTemplateDecorate",__name:"decorate",setup(ae){const l=r(0),s=N([{name:"\u57FA\u7840\u8BBE\u7F6E",icon:"ep:iphone"},{name:"\u9996\u9875",icon:"ep:home-filled"},{name:"\u6211\u7684",icon:"ep:user-filled"}]),h=B(),u=r(!1),n=r(),_=r(),i=r({property:""}),m=r(new Map),b=r(""),I=[],c=r(I),S=o=>{m.value.set(s[l.value].name,i.value);const e=m.value.get(s[o].name);if(l.value=o,o===0)return c.value=I,void(i.value=p(e)?n.value:e);c.value=U,i.value=p(e)?n.value.pages.find(t=>t.name===s[o].name):e},$=async()=>{var o;if(_){u.value=!0;try{for(let e=0;e<s.length;e++){const t=m.value.get(s[e].name);e!==0?(o=i.value)!=null&&o.name.includes(s[e].name)?await x(a(i)):p(t)||await x(t):await j(p(t)?a(n):t)}h.success("\u4FDD\u5B58\u6210\u529F")}finally{u.value=!1}}},P=()=>z(),z=()=>sessionStorage.setItem(y,`${l.value}`),{currentRoute:f}=F(),{delView:C}=q();return O(async()=>{var o;if(n.value={id:void 0,name:"",used:!1,usedTime:void 0,remark:"",previewPicUrls:[],property:"",pages:[]},(o=_.value)==null||o.resetFields(),!f.value.params.id)return h.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u9875\u9762\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void C(a(f));await(async e=>{u.value=!0;try{n.value=await H(e);const t="http://mall.yudao.iocoder.cn";b.value=`${t}/#/pages/index/index?templateId=${n.value.id}`}finally{u.value=!1}})(f.value.params.id),(()=>{const e=J(sessionStorage.getItem(y))||0;sessionStorage.removeItem(y),i.value=n.value,m.value=new Map,e!==l.value&&S(e)})()}),(o,e)=>{const t=G,D=E,L=Q,M=A,R=T;return a(n)&&!a(u)?(g(),V(R,{key:0,modelValue:a(i).property,"onUpdate:modelValue":e[0]||(e[0]=v=>a(i).property=v),libs:a(c),"preview-url":a(b),"show-navigation-bar":a(l)!==0,"show-page-config":a(l)!==0,"show-tab-bar":a(l)===0,title:a(s)[a(l)].name,onReset:P,onSave:$},{toolBarLeft:d(()=>[w(M,{"model-value":a(l),class:"h-full!",onChange:S},{default:d(()=>[(g(!0),X(Y,null,Z(a(s),(v,k)=>(g(),V(L,{key:k,content:v.name},{default:d(()=>[w(D,{value:k},{default:d(()=>[w(t,{icon:v.icon,size:24},null,8,["icon"])]),_:2},1032,["value"])]),_:2},1032,["content"]))),128))]),_:1},8,["model-value"])]),_:1},8,["modelValue","libs","preview-url","show-navigation-bar","show-page-config","show-tab-bar","title"])):W("",!0)}}});export{ee as default};
