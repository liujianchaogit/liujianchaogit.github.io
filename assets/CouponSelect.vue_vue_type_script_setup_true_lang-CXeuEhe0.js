import{h as q,D as s,_ as G}from"./index-DiGvuAxb.js";import{_ as H}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{_ as L}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as Q}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{_ as $}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{d as B,v as J,r as X,t as W}from"./formatter-hroZ_PAn.js";import{g as ee}from"./couponTemplate-BH0KUrpk.js";import{h as ae}from"./constants-C3gLHYOK.js";import{h as le,ai as te,k as oe,x as pe,Q as ue,f as ne,aj as re,Z as ie,_ as se}from"./form-designer-drfGvdgz.js";import{k as me,r,P as ce,y as b,m as _,u as a,h as de,z as o,H as e,l as fe,G as _e,$ as ye,E as m,A as Te,F as ve}from"./form-create-D7wT855o.js";const be=me({name:"CouponSelect",__name:"CouponSelect",props:{multipleSelection:{},takeType:{}},emits:["update:multipleSelection","change"],setup(U,{expose:x,emit:V}){const g=U,h=V,i=r(!1),E=r("\u9009\u62E9\u4F18\u60E0\u52B5"),M=r(!1),y=r(!0),O=r(0),S=r([]),p=ce({pageNo:1,pageSize:10,name:null,discountType:null,canTakeTypes:[ae.USER.type]}),c=r(),C=r([]),w=async()=>{y.value=!0;try{p.canTakeTypes=[g.takeType];const n=await ee(p);S.value=n.list,O.value=n.total}finally{y.value=!1}},T=()=>{p.pageNo=1,w()},k=()=>{var n;(n=c==null?void 0:c.value)==null||n.resetFields(),T()};x({open:async()=>{i.value=!0,k()}});const R=n=>{g.multipleSelection?h("update:multipleSelection",n):C.value=n},I=()=>{i.value=!1,h("change",C.value)};return(n,t)=>{const z=oe,v=te,A=ue,D=pe,N=G,d=ne,F=le,P=$,u=se,f=Q,Y=ie,K=L,Z=H,j=re;return _(),b(Z,{modelValue:a(i),"onUpdate:modelValue":t[5]||(t[5]=l=>de(i)?i.value=l:null),title:a(E),width:"65%"},{footer:o(()=>[e(d,{disabled:a(M),type:"primary",onClick:I},{default:o(()=>t[8]||(t[8]=[m("\u786E \u5B9A")])),_:1},8,["disabled"]),e(d,{onClick:t[4]||(t[4]=l=>i.value=!1)},{default:o(()=>t[9]||(t[9]=[m("\u53D6 \u6D88")])),_:1})]),default:o(()=>[e(P,null,{default:o(()=>[e(F,{ref_key:"queryFormRef",ref:c,inline:!0,model:a(p),class:"-mb-15px","label-width":"82px"},{default:o(()=>[e(v,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:o(()=>[e(z,{modelValue:a(p).name,"onUpdate:modelValue":t[0]||(t[0]=l=>a(p).name=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",onKeyup:T},null,8,["modelValue"])]),_:1}),e(v,{label:"\u4F18\u60E0\u7C7B\u578B",prop:"discountType"},{default:o(()=>[e(D,{modelValue:a(p).discountType,"onUpdate:modelValue":t[1]||(t[1]=l=>a(p).discountType=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:o(()=>[(_(!0),fe(_e,null,ye(a(q)(a(s).PROMOTION_DISCOUNT_TYPE),l=>(_(),b(A,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:o(()=>[e(d,{onClick:T},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:search"}),t[6]||(t[6]=m(" \u641C\u7D22 "))]),_:1}),e(d,{onClick:k},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:refresh"}),t[7]||(t[7]=m(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:o(()=>[Te((_(),b(Y,{data:a(S),onSelectionChange:R},{default:o(()=>[e(u,{type:"selection",width:"55"}),e(u,{label:"\u4F18\u60E0\u5238\u540D\u79F0","min-width":"140",prop:"name"}),e(u,{label:"\u7C7B\u578B","min-width":"80",prop:"productScope"},{default:o(l=>[e(f,{type:a(s).PROMOTION_PRODUCT_SCOPE,value:l.row.productScope},null,8,["type","value"])]),_:1}),e(u,{label:"\u4F18\u60E0","min-width":"100",prop:"discount"},{default:o(l=>[e(f,{type:a(s).PROMOTION_DISCOUNT_TYPE,value:l.row.discountType},null,8,["type","value"]),m(" "+ve(a(B)(l.row)),1)]),_:1}),e(u,{label:"\u9886\u53D6\u65B9\u5F0F","min-width":"100",prop:"takeType"},{default:o(l=>[e(f,{type:a(s).PROMOTION_COUPON_TAKE_TYPE,value:l.row.takeType},null,8,["type","value"])]),_:1}),e(u,{formatter:a(J),align:"center",label:"\u4F7F\u7528\u65F6\u95F4",prop:"validityType",width:"185"},null,8,["formatter"]),e(u,{align:"center",label:"\u53D1\u653E\u6570\u91CF",prop:"totalCount"}),e(u,{formatter:a(X),align:"center",label:"\u5269\u4F59\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),e(u,{formatter:a(W),align:"center",label:"\u9886\u53D6\u4E0A\u9650",prop:"takeLimitCount"},null,8,["formatter"]),e(u,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:o(l=>[e(f,{type:a(s).COMMON_STATUS,value:l.row.status},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[j,a(y)]]),e(K,{limit:a(p).pageSize,"onUpdate:limit":t[2]||(t[2]=l=>a(p).pageSize=l),page:a(p).pageNo,"onUpdate:page":t[3]||(t[3]=l=>a(p).pageNo=l),total:a(O),onPagination:w},null,8,["limit","page","total"])]),_:1})]),_:1},8,["modelValue","title"])}}});export{be as _};
