import{d as j,a as A,_ as B,D,au as G}from"./index-DiGvuAxb.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as V}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{g as F,d as W}from"./index-BZ5-F52f.js";import{_ as Y}from"./ReceivableForm.vue_vue_type_script_setup_true_lang-BAH5QTB1.js";import{b as Z}from"./formatTime-DeTj2b0K.js";import{i as q,f as J,aj as K,_ as O,Z as Q}from"./form-designer-drfGvdgz.js";import{k as X,r as p,P as $,b as ee,af as ae,l as te,m,G as re,H as a,z as n,E as I,A as g,u as o,y as _}from"./form-create-D7wT855o.js";const oe=X({name:"CrmReceivableList",__name:"ReceivableList",props:{customerId:{},contractId:{}},setup(C,{expose:x}){const t=C,v=j(),{t:R}=A(),d=p(!0),b=p(0),y=p([]),r=$({pageNo:1,pageSize:10,customerId:void 0,contractId:void 0}),s=async()=>{d.value=!0;try{t.customerId&&!t.contractId?r.customerId=t.customerId:t.customerId&&t.contractId&&(r.customerId=t.customerId,r.contractId=t.contractId);const l=await F(r);y.value=l.list,b.value=l.total}finally{d.value=!1}},u=p(),w=(l,e)=>{u.value.open(l,e,{customerId:t.customerId,contractId:t.contractId})};return x({createReceivable:l=>{const e=l;u.value.open("create",void 0,e)}}),ee(()=>[t.customerId,t.contractId],l=>{l[0]&&(r.pageNo=1,r.customerId=void 0,r.contractId=void 0,s())},{immediate:!0,deep:!0}),(l,e)=>{const h=B,f=J,N=q,c=O,E=V,S=Q,z=M,T=H,k=ae("hasPermi"),P=K;return m(),te(re,null,[a(N,{justify:"end"},{default:n(()=>[a(f,{onClick:e[0]||(e[0]=i=>w("create"))},{default:n(()=>[a(h,{class:"mr-5px",icon:"icon-park:income-one"}),e[3]||(e[3]=I(" \u521B\u5EFA\u56DE\u6B3E "))]),_:1})]),_:1}),a(T,{class:"mt-10px"},{default:n(()=>[g((m(),_(S,{data:o(y),"show-overflow-tooltip":!0,stripe:!0},{default:n(()=>[a(c,{align:"center",label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no"}),a(c,{align:"center",label:"\u5BA2\u6237",prop:"customerName"}),a(c,{align:"center",label:"\u5408\u540C",prop:"contract.no"}),a(c,{formatter:o(Z),align:"center",label:"\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"150px"},null,8,["formatter"]),a(c,{align:"center",label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType",width:"130px"},{default:n(i=>[a(E,{type:o(D).CRM_RECEIVABLE_RETURN_TYPE,value:i.row.returnType},null,8,["type","value"])]),_:1}),a(c,{align:"center",label:"\u56DE\u6B3E\u91D1\u989D(\u5143)",prop:"price",formatter:o(G)},null,8,["formatter"]),a(c,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName"}),a(c,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(c,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"130px"},{default:n(i=>[g((m(),_(f,{link:"",type:"primary",onClick:U=>w("update",i.row.id)},{default:n(()=>e[4]||(e[4]=[I(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[k,["crm:receivable:update"]]]),g((m(),_(f,{link:"",type:"danger",onClick:U=>(async L=>{try{await v.delConfirm(),await W(L),v.success(R("common.delSuccess")),await s()}catch{}})(i.row.id)},{default:n(()=>e[5]||(e[5]=[I(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[k,["crm:receivable:delete"]]])]),_:1})]),_:1},8,["data"])),[[P,o(d)]]),a(z,{limit:o(r).pageSize,"onUpdate:limit":e[1]||(e[1]=i=>o(r).pageSize=i),page:o(r).pageNo,"onUpdate:page":e[2]||(e[2]=i=>o(r).pageNo=i),total:o(b),onPagination:s},null,8,["limit","page","total"])]),_:1}),a(Y,{ref_key:"formRef",ref:u,onSuccess:s},null,512)],64)}}});export{oe as _};
