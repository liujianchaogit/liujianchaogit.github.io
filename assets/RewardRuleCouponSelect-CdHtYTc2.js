import{aA as S,D as f,L as m,c as P}from"./index-C1TKk8vI.js";import{_ as b}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{e as D}from"./couponTemplate-if6DBRiW.js";import{d as E}from"./formatter-BBGnTCQg.js";import{h as M}from"./constants-IYPHa1Ih.js";import{_ as j}from"./CouponSelect.vue_vue_type_script_setup_true_lang-B3O0DEjA.js";import{f as N,k as U}from"./form-designer-BpYekVAY.js";import{x as L,r as x,j as A,n as z,y as r,z as c,O as u,F as y,K as p,M as g,a4 as F,C as i,L as _,u as n}from"./form-create-7GAbgMwl.js";import"./color-BN7ZL7BD.js";import"./formatTime-EbFUBcAO.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";const G={class:"coupon-list-item-left flex items-center flex-wrap"},K={class:"mr-10px"},Y={class:"mr-10px"},q={class:"flex items-center"},B={class:"coupon-list-item-right"},H=P(L({name:"RewardRuleCouponSelect",__name:"RewardRuleCouponSelect",props:{modelValue:{}},emits:["update:modelValue"],setup(T,{expose:O,emit:k}){const a=S(T,"modelValue",k),l=x([]),v=x(),h=()=>{var o;(o=v.value)==null||o.open()},w=o=>{for(const e of o)l.value.some(t=>t.id===e.id)||l.value.push(e)};return O({setGiveCouponList:()=>{m(a.value)||m(l.value)||l.value.forEach(o=>{a.value.giveCouponTemplateCounts||(a.value.giveCouponTemplateCounts={}),a.value.giveCouponTemplateCounts[o.id]=o.giveCount})}}),A(async()=>{await z(),await(async()=>{if(m(a.value)||m(a.value.giveCouponTemplateCounts))return;const o=Object.keys(a.value.giveCouponTemplateCounts).map(t=>parseInt(t)),e=await D(o);e&&e.forEach(t=>{l.value.push({...t,giveCount:a.value.giveCouponTemplateCounts[t.id]})})})()}),(o,e)=>{const t=N,d=b,R=U;return r(),c(g,null,[u(t,{class:"ml-10px",type:"text",onClick:h},{default:y(()=>e[0]||(e[0]=[p("\u6DFB\u52A0\u4F18\u60E0\u52B5")])),_:1}),(r(!0),c(g,null,F(n(l),(s,V)=>(r(),c("div",{key:s.id,class:"coupon-list-item p-x-10px mb-10px flex justify-between"},[i("div",G,[i("div",K," \u4F18\u60E0\u5238\u540D\u79F0\uFF1A"+_(s.name),1),i("div",Y,[e[1]||(e[1]=p(" \u8303\u56F4\uFF1A ")),u(d,{type:n(f).PROMOTION_PRODUCT_SCOPE,value:s.productScope},null,8,["type","value"])]),i("div",q,[e[2]||(e[2]=p(" \u4F18\u60E0\uFF1A ")),u(d,{type:n(f).PROMOTION_DISCOUNT_TYPE,value:s.discountType},null,8,["type","value"]),p(" "+_(n(E)(s)),1)])]),i("div",B,[e[4]||(e[4]=p(" \u9001 ")),u(R,{modelValue:s.giveCount,"onUpdate:modelValue":C=>s.giveCount=C,class:"w-150px! p-x-20px!",placeholder:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"]),e[5]||(e[5]=p(" \u5F20 ")),u(t,{class:"ml-20px",link:"",type:"danger",onClick:C=>(I=>{l.value.splice(I,1)})(V)},{default:y(()=>e[3]||(e[3]=[p("\u5220\u9664")])),_:2},1032,["onClick"])])]))),128)),u(n(j),{ref_key:"couponSelectRef",ref:v,"take-type":n(M).ADMIN.type,onChange:w},null,8,["take-type"])],64)}}}),[["__scopeId","data-v-55987cd1"]]);export{H as default};
