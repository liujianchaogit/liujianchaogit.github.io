import{d as D,u as G,e as H}from"./index-DiGvuAxb.js";import{_ as L,g as O}from"./index-CW_9iX_V.js";import{u as Q}from"./tagsView-B3xQDSQ0.js";import{a as V}from"./index-CTd4bIoJ.js";import{_ as $}from"./BusinessDetailsHeader.vue_vue_type_script_setup_true_lang-BXIJ3468.js";import{_ as q}from"./BusinessDetailsInfo.vue_vue_type_script_setup_true_lang-B4pg2Pbh.js";import{_ as J}from"./PermissionList.vue_vue_type_script_setup_true_lang-DuRPTcsq.js";import{B as m}from"./index-BbXovwRQ.js";import{_ as K}from"./BusinessForm.vue_vue_type_script_setup_true_lang-Cjx3XcOv.js";import{_ as P}from"./TransferForm.vue_vue_type_script_setup_true_lang-BAOmVy5z.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-m0iBWoAP.js";import{_ as Y}from"./ContactList.vue_vue_type_script_setup_true_lang-CnVMUTlm.js";import{_ as Z}from"./BusinessUpdateStatusForm.vue_vue_type_script_setup_true_lang-BDVT_lJk.js";import{_ as ii}from"./ContractList.vue_vue_type_script_setup_true_lang-CKenmohU.js";import{_ as ei}from"./BusinessProductList.vue_vue_type_script_setup_true_lang-BhzuLJbG.js";import{aj as ai,f as ri,a0 as si,$ as ti,j as oi}from"./form-designer-drfGvdgz.js";import{k as li,r as t,e as mi,l as ui,m as u,A as pi,H as e,u as i,y as d,z as r,C as c,E as z,G as ni}from"./form-create-D7wT855o.js";import"./formatTime-DeTj2b0K.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CDu_CIl5.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./index-BEHCTgo8.js";import"./index-ql53Efwg.js";import"./index-CwL9yoSU.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-DxqNVEr9.js";import"./index-BecHlYrv.js";import"./index-lUjDMm-F.js";import"./index-5ADGgtek.js";import"./index-D4xnjFDX.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DbaMdrhi.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-CRRE-olZ.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DnGaMf8w.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DjDqRBUp.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-B6rwY0dr.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CyzVB0Fa.js";import"./index-BXr639vD.js";import"./tree-COGD3qag.js";import"./ContractForm.vue_vue_type_script_setup_true_lang-D9pcCpO-.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-DjxMSPjL.js";const di=li({name:"CrmBusinessDetail",__name:"index",setup(fi){const U=D(),p=t(0),f=t(!0),a=t({}),n=t(),b=async()=>{f.value=!0;try{a.value=await V(p.value),await g(p.value)}finally{f.value=!1}},S=t(),v=t(),C=t(),M=()=>{var l;(l=C.value)==null||l.open(a.value.id)},k=t([]),g=async l=>{if(!l)return;const s=await O({bizType:m.CRM_BUSINESS,bizId:l});k.value=s.list},{delView:x}=Q(),{currentRoute:j}=G(),_=()=>{x(i(j))},{params:R}=H();return mi(async()=>{if(!R.id)return U.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5546\u673A\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void _();p.value=R.id,await b()}),(l,s)=>{const y=ri,o=ti,F=L,T=si,W=oi,h=ai;return u(),ui(ni,null,[pi((u(),d($,{business:i(a)},{default:r(()=>{var w,B,I;return[(w=i(n))!=null&&w.validateWrite?(u(),d(y,{key:0,onClick:s[0]||(s[0]=A=>{return E="update",N=i(a).id,void S.value.open(E,N);var E,N})},{default:r(()=>s[2]||(s[2]=[z(" \u7F16\u8F91 ")])),_:1})):c("",!0),(B=i(n))!=null&&B.validateWrite?(u(),d(y,{key:1,disabled:i(a).endStatus,type:"success",onClick:s[1]||(s[1]=A=>{v.value.open(a.value)})},{default:r(()=>s[3]||(s[3]=[z(" \u53D8\u66F4\u5546\u673A\u72B6\u6001 ")])),_:1},8,["disabled"])):c("",!0),(I=i(n))!=null&&I.validateOwnerUser?(u(),d(y,{key:2,type:"primary",onClick:M},{default:r(()=>s[4]||(s[4]=[z(" \u8F6C\u79FB ")])),_:1})):c("",!0)]}),_:1},8,["business"])),[[h,i(f)]]),e(W,null,{default:r(()=>[e(T,null,{default:r(()=>[e(o,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:r(()=>[e(X,{"biz-id":i(p),"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:r(()=>[e(q,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u8054\u7CFB\u4EBA",lazy:""},{default:r(()=>[e(Y,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"business-id":i(a).id,"customer-id":i(a).customerId},null,8,["biz-id","biz-type","business-id","customer-id"])]),_:1}),e(o,{label:"\u4EA7\u54C1"},{default:r(()=>[e(ei,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u5408\u540C",lazy:""},{default:r(()=>[e(ii,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:r(()=>[e(F,{"log-list":i(k)},null,8,["log-list"])]),_:1}),e(o,{label:"\u56E2\u961F\u6210\u5458"},{default:r(()=>[e(J,{ref_key:"permissionListRef",ref:n,"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"show-action":!0,onQuitTeam:_},null,8,["biz-id","biz-type"])]),_:1})]),_:1})]),_:1}),e(K,{ref_key:"formRef",ref:S,onSuccess:b},null,512),e(Z,{ref_key:"statusFormRef",ref:v,onSuccess:b},null,512),e(P,{ref_key:"transferFormRef",ref:C,"biz-type":i(m).CRM_BUSINESS,onSuccess:_},null,8,["biz-type"])],64)}}});export{di as default};
