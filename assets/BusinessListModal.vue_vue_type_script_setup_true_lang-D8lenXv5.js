import{au as T,d as $,u as A,_ as H}from"./index-C1TKk8vI.js";import{_ as J}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as W}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{x as Y,r as s,X as Z,y,E as v,F as l,O as a,K as p,u as t,a5 as ee,G as V,L as ae,l as le,aq as te}from"./form-create-7GAbgMwl.js";import{g as oe}from"./index-DLPyhh9r.js";import{_ as re}from"./BusinessForm.vue_vue_type_script_setup_true_lang-C-tbO4kY.js";import{k as se,ai as ie,f as ne,h as ue,$ as pe,P as me,_ as ce,aj as de}from"./form-designer-BpYekVAY.js";const fe=Y({name:"BusinessListModal",__name:"BusinessListModal",props:{customerId:{}},emits:["success"],setup(I,{expose:P,emit:R}){const U=$(),b=I,i=s(!1),d=s(!0),k=s(0),w=s([]),x=s(),B=s(!1),r=Z({pageNo:1,pageSize:10,name:void 0,customerId:b.customerId});P({open:async()=>{i.value=!0,r.customerId=b.customerId,await c()}});const c=async()=>{d.value=!0;try{const n=await oe(r);w.value=n.list,k.value=n.total}finally{d.value=!1}},f=()=>{r.pageNo=1,c()},z=()=>{x.value.resetFields(),f()},h=s(),F=R,_=s(),L=async()=>{const n=_.value.getSelectionRows().map(e=>e.id);if(n.length===0)return U.error("\u672A\u9009\u62E9\u5546\u673A");i.value=!1,F("success",n,_.value.getSelectionRows())},{push:q}=A();return(n,e)=>{const K=se,C=ie,g=H,m=ne,M=ue,N=W,u=pe,X=me,j=ce,D=Q,E=J,G=te("hasPermi"),O=de;return y(),v(E,{title:"\u5173\u8054\u5546\u673A",modelValue:t(i),"onUpdate:modelValue":e[5]||(e[5]=o=>le(i)?i.value=o:null)},{footer:l(()=>[a(m,{onClick:L,type:"primary",disabled:t(B)},{default:l(()=>e[9]||(e[9]=[p("\u786E \u5B9A")])),_:1},8,["disabled"]),a(m,{onClick:e[4]||(e[4]=o=>i.value=!1)},{default:l(()=>e[10]||(e[10]=[p("\u53D6 \u6D88")])),_:1})]),default:l(()=>[a(N,null,{default:l(()=>[a(M,{class:"-mb-15px",model:t(r),ref_key:"queryFormRef",ref:x,inline:!0,"label-width":"68px"},{default:l(()=>[a(C,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:l(()=>[a(K,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(r).name=o),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0",clearable:"",onKeyup:ee(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(C,null,{default:l(()=>[a(m,{onClick:f},{default:l(()=>[a(g,{icon:"ep:search",class:"mr-5px"}),e[6]||(e[6]=p(" \u641C\u7D22"))]),_:1}),a(m,{onClick:z},{default:l(()=>[a(g,{icon:"ep:refresh",class:"mr-5px"}),e[7]||(e[7]=p(" \u91CD\u7F6E"))]),_:1}),V((y(),v(m,{type:"primary",onClick:e[1]||(e[1]=o=>{h.value.open("create")})},{default:l(()=>[a(g,{icon:"ep:plus",class:"mr-5px"}),e[8]||(e[8]=p(" \u65B0\u589E "))]),_:1})),[[G,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(N,{class:"mt-10px"},{default:l(()=>[V((y(),v(j,{ref_key:"businessRef",ref:_,data:t(w),stripe:!0,"show-overflow-tooltip":!0},{default:l(()=>[a(u,{type:"selection",width:"55"}),a(u,{label:"\u5546\u673A\u540D\u79F0",fixed:"left",align:"center",prop:"name"},{default:l(o=>[a(X,{type:"primary",underline:!1,onClick:_e=>{return S=o.row.id,void q({name:"CrmBusinessDetail",params:{id:S}});var S}},{default:l(()=>[p(ae(o.row.name),1)]),_:2},1032,["onClick"])]),_:1}),a(u,{label:"\u5546\u673A\u91D1\u989D",align:"center",prop:"totalPrice",formatter:t(T)},null,8,["formatter"]),a(u,{label:"\u5BA2\u6237\u540D\u79F0",align:"center",prop:"customerName"}),a(u,{label:"\u5546\u673A\u7EC4",align:"center",prop:"statusTypeName"}),a(u,{label:"\u5546\u673A\u9636\u6BB5",align:"center",prop:"statusName"})]),_:1},8,["data"])),[[O,t(d)]]),a(D,{total:t(k),page:t(r).pageNo,"onUpdate:page":e[2]||(e[2]=o=>t(r).pageNo=o),limit:t(r).pageSize,"onUpdate:limit":e[3]||(e[3]=o=>t(r).pageSize=o),onPagination:c},null,8,["total","page","limit"])]),_:1}),a(re,{ref_key:"formRef",ref:h,onSuccess:c},null,512)]),_:1},8,["modelValue"])}}});export{fe as _};
