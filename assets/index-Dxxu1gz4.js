import{e as G,d as H,u as Q}from"./index-DiGvuAxb.js";import{_ as U,g as V}from"./index-CW_9iX_V.js";import{u as W}from"./tagsView-B3xQDSQ0.js";import{b as $}from"./index-D4xnjFDX.js";import{_ as q}from"./ContractDetailsInfo.vue_vue_type_script_setup_true_lang-BGx8yd06.js";import{_ as J}from"./ContractDetailsHeader.vue_vue_type_script_setup_true_lang-D8Ma4tcz.js";import{_ as K}from"./ContractProductList.vue_vue_type_script_setup_true_lang-BBaZs4lz.js";import{B as s}from"./index-BbXovwRQ.js";import{_ as P}from"./ContractForm.vue_vue_type_script_setup_true_lang-D9pcCpO-.js";import{_ as X}from"./TransferForm.vue_vue_type_script_setup_true_lang-BAOmVy5z.js";import{_ as Y}from"./PermissionList.vue_vue_type_script_setup_true_lang-DuRPTcsq.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_lang-m0iBWoAP.js";import{_ as tt}from"./ReceivableList.vue_vue_type_script_setup_true_lang-C_GsQtZN.js";import{_ as rt}from"./ReceivablePlanList.vue_vue_type_script_setup_true_lang-2zK3CKOM.js";import{aj as at,f as it,a0 as et,$ as ot,j as mt}from"./form-designer-drfGvdgz.js";import{k as lt,r as m,e as st,l as pt,m as p,A as ut,H as r,u as t,y as d,z as o,C as O,E as A,G as nt}from"./form-create-D7wT855o.js";import"./formatTime-DeTj2b0K.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./index-CwL9yoSU.js";import"./index-BEHCTgo8.js";import"./index-5ADGgtek.js";import"./index-CTd4bIoJ.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-DjxMSPjL.js";import"./index-BecHlYrv.js";import"./index-lUjDMm-F.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CDu_CIl5.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DbaMdrhi.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-CRRE-olZ.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DnGaMf8w.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DjDqRBUp.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-Cjx3XcOv.js";import"./index-ql53Efwg.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-DxqNVEr9.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-B6rwY0dr.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CyzVB0Fa.js";import"./index-BXr639vD.js";import"./tree-COGD3qag.js";import"./index-BZ5-F52f.js";import"./ReceivableForm.vue_vue_type_script_setup_true_lang-BAH5QTB1.js";import"./index-LzLQUCg-.js";import"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-Cw6CG5o7.js";const ct=lt({name:"CrmContractDetail",__name:"index",props:{id:{}},setup(g){const M=g,N=G(),x=H(),u=m(0),n=m(!0),a=m({}),c=m(),_=m(),b=async()=>{n.value=!0;try{a.value=await $(u.value),await I(u.value)}finally{n.value=!1}},y=m([]),I=async i=>{if(!i)return;const e=await V({bizType:s.CRM_CONTRACT,bizId:i});y.value=e.list},v=m(),j=i=>{var e;(e=v.value)==null||e.createReceivable(i)},C=m(),L=()=>{var i;(i=C.value)==null||i.open(a.value.id)},{delView:S}=W(),{currentRoute:h}=Q(),f=()=>{S(t(h))};return st(async()=>{const i=M.id||N.params.id;if(!i)return x.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5408\u540C\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void f();u.value=i,await b()}),(i,e)=>{const R=it,l=ot,B=U,D=et,E=mt,F=at;return p(),pt(nt,null,[ut((p(),d(J,{contract:t(a)},{default:o(()=>{var z,T;return[(z=t(c))!=null&&z.validateWrite?(p(),d(R,{key:0,onClick:e[0]||(e[0]=ft=>{return k="update",w=t(a).id,void _.value.open(k,w);var k,w})},{default:o(()=>e[1]||(e[1]=[A(" \u7F16\u8F91 ")])),_:1})):O("",!0),(T=t(c))!=null&&T.validateOwnerUser?(p(),d(R,{key:1,type:"primary",onClick:L},{default:o(()=>e[2]||(e[2]=[A(" \u8F6C\u79FB ")])),_:1})):O("",!0)]}),_:1},8,["contract"])),[[F,t(n)]]),r(E,null,{default:o(()=>[r(D,null,{default:o(()=>[r(l,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:o(()=>[r(Z,{"biz-id":t(a).id,"biz-type":t(s).CRM_CONTRACT},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u57FA\u672C\u4FE1\u606F"},{default:o(()=>[r(q,{contract:t(a)},null,8,["contract"])]),_:1}),r(l,{label:"\u4EA7\u54C1"},{default:o(()=>[r(K,{contract:t(a)},null,8,["contract"])]),_:1}),r(l,{label:"\u56DE\u6B3E"},{default:o(()=>[r(rt,{"contract-id":t(a).id,"customer-id":t(a).customerId,onCreateReceivable:j},null,8,["contract-id","customer-id"]),r(tt,{ref_key:"receivableListRef",ref:v,"contract-id":t(a).id,"customer-id":t(a).customerId},null,8,["contract-id","customer-id"])]),_:1}),r(l,{label:"\u56E2\u961F\u6210\u5458"},{default:o(()=>[r(Y,{ref_key:"permissionListRef",ref:c,"biz-id":t(a).id,"biz-type":t(s).CRM_CONTRACT,"show-action":!0,onQuitTeam:f},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:o(()=>[r(B,{"log-list":t(y)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),r(P,{ref_key:"formRef",ref:_,onSuccess:b},null,512),r(X,{ref_key:"transferFormRef",ref:C,"biz-type":t(s).CRM_CONTRACT,onSuccess:f},null,8,["biz-type"])],64)}}});export{ct as default};
