import{e as T,D as f,X as C,b as Q,d as H,az as Z}from"./index-C1TKk8vI.js";import{_ as $}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{a as D,V as Y,D as K,P as O}from"./index-DDlNWlg-.js";import{P as ee}from"./index-_dacQFh7.js";import{f as ae,k as le,ai as de,Q as te,x as ue,u as oe,s as re,ac as ie,ab as pe,h as se,aj as ce}from"./form-designer-BpYekVAY.js";import{x as me,r as m,X as ne,y as o,E as i,F as t,O as u,K as v,u as e,G as ve,z as y,a4 as b,M as _,L as A,J as S,l as ye}from"./form-create-7GAbgMwl.js";const be=me({name:"IoTProductForm",__name:"ProductForm",emits:["success"],setup(_e,{expose:R,emit:W}){const{t:g}=Q(),F=H(),c=m(!1),x=m(""),n=m(!1),p=m(""),d=m({id:void 0,name:void 0,productKey:"",categoryId:void 0,icon:void 0,picUrl:void 0,description:void 0,deviceType:void 0,netType:void 0,protocolType:void 0,protocolId:void 0,dataFormat:D.JSON,validateType:Y.WEAK}),L=ne({productKey:[{required:!0,message:"ProductKey \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deviceType:[{required:!0,message:"\u8BBE\u5907\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],netType:[{required:!0,message:"\u8054\u7F51\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],protocolType:[{required:!0,message:"\u63A5\u5165\u7F51\u5173\u534F\u8BAE\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],dataFormat:[{required:!0,message:"\u6570\u636E\u683C\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],validateType:[{required:!0,message:"\u6570\u636E\u6821\u9A8C\u7EA7\u522B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),V=m(),q=m([]);R({open:async(s,l)=>{if(c.value=!0,x.value=g("action."+s),p.value=s,N(),l){n.value=!0;try{d.value=await O.getProduct(l)}finally{n.value=!1}}else w();q.value=await ee.getSimpleProductCategoryList()},close:()=>c.value=!1});const G=W,J=async()=>{await V.value.validate(),n.value=!0;try{const s=d.value;p.value==="create"?(await O.createProduct(s),F.success(g("common.createSuccess"))):(await O.updateProduct(s),F.success(g("common.updateSuccess"))),c.value=!1,G("success")}finally{n.value=!1}},N=()=>{var s;d.value={id:void 0,name:void 0,productKey:"",categoryId:void 0,icon:void 0,picUrl:void 0,description:void 0,deviceType:void 0,netType:void 0,protocolType:void 0,protocolId:void 0,dataFormat:D.JSON,validateType:Y.WEAK},(s=V.value)==null||s.resetFields()},w=()=>{d.value.productKey=Z(16)};return(s,l)=>{const U=ae,h=le,r=de,I=te,P=ue,E=oe,k=re,z=ie,M=pe,X=se,j=$,B=ce;return o(),i(j,{title:e(x),modelValue:e(c),"onUpdate:modelValue":l[12]||(l[12]=a=>ye(c)?c.value=a:null)},{footer:t(()=>[u(U,{onClick:J,type:"primary",disabled:e(n)},{default:t(()=>l[14]||(l[14]=[v("\u786E \u5B9A")])),_:1},8,["disabled"]),u(U,{onClick:l[11]||(l[11]=a=>c.value=!1)},{default:t(()=>l[15]||(l[15]=[v("\u53D6 \u6D88")])),_:1})]),default:t(()=>[ve((o(),i(X,{ref_key:"formRef",ref:V,model:e(d),rules:e(L),"label-width":"110px"},{default:t(()=>[u(r,{label:"ProductKey",prop:"productKey"},{default:t(()=>[u(h,{modelValue:e(d).productKey,"onUpdate:modelValue":l[0]||(l[0]=a=>e(d).productKey=a),placeholder:"\u8BF7\u8F93\u5165 ProductKey",readonly:e(p)==="update"},{append:t(()=>[u(U,{onClick:w,disabled:e(p)==="update"},{default:t(()=>l[13]||(l[13]=[v(" \u91CD\u65B0\u751F\u6210 ")])),_:1},8,["disabled"])]),_:1},8,["modelValue","readonly"])]),_:1}),u(r,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:t(()=>[u(h,{modelValue:e(d).name,"onUpdate:modelValue":l[1]||(l[1]=a=>e(d).name=a),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(r,{label:"\u4EA7\u54C1\u5206\u7C7B",prop:"categoryId"},{default:t(()=>[u(P,{modelValue:e(d).categoryId,"onUpdate:modelValue":l[2]||(l[2]=a=>e(d).categoryId=a),placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u5206\u7C7B",clearable:""},{default:t(()=>[(o(!0),y(_,null,b(e(q),a=>(o(),i(I,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(r,{label:"\u8BBE\u5907\u7C7B\u578B",prop:"deviceType"},{default:t(()=>[u(k,{modelValue:e(d).deviceType,"onUpdate:modelValue":l[3]||(l[3]=a=>e(d).deviceType=a),disabled:e(p)==="update"},{default:t(()=>[(o(!0),y(_,null,b(e(T)(e(f).IOT_PRODUCT_DEVICE_TYPE),a=>(o(),i(E,{key:a.value,label:a.value},{default:t(()=>[v(A(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),[e(K).DEVICE,e(K).GATEWAY].includes(e(d).deviceType)?(o(),i(r,{key:0,label:"\u8054\u7F51\u65B9\u5F0F",prop:"netType"},{default:t(()=>[u(P,{modelValue:e(d).netType,"onUpdate:modelValue":l[4]||(l[4]=a=>e(d).netType=a),placeholder:"\u8BF7\u9009\u62E9\u8054\u7F51\u65B9\u5F0F",disabled:e(p)==="update"},{default:t(()=>[(o(!0),y(_,null,b(e(T)(e(f).IOT_NET_TYPE),a=>(o(),i(I,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):S("",!0),e(d).deviceType===e(K).GATEWAY_SUB?(o(),i(r,{key:1,label:"\u63A5\u5165\u7F51\u5173\u534F\u8BAE",prop:"protocolType"},{default:t(()=>[u(P,{modelValue:e(d).protocolType,"onUpdate:modelValue":l[5]||(l[5]=a=>e(d).protocolType=a),placeholder:"\u8BF7\u9009\u62E9\u63A5\u5165\u7F51\u5173\u534F\u8BAE",disabled:e(p)==="update"},{default:t(()=>[(o(!0),y(_,null,b(e(T)(e(f).IOT_PROTOCOL_TYPE),a=>(o(),i(I,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):S("",!0),u(r,{label:"\u6570\u636E\u683C\u5F0F",prop:"dataFormat"},{default:t(()=>[u(k,{modelValue:e(d).dataFormat,"onUpdate:modelValue":l[6]||(l[6]=a=>e(d).dataFormat=a),disabled:e(p)==="update"},{default:t(()=>[(o(!0),y(_,null,b(e(T)(e(f).IOT_DATA_FORMAT),a=>(o(),i(E,{key:a.value,label:a.value},{default:t(()=>[v(A(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),u(r,{label:"\u6570\u636E\u6821\u9A8C\u7EA7\u522B",prop:"validateType"},{default:t(()=>[u(k,{modelValue:e(d).validateType,"onUpdate:modelValue":l[7]||(l[7]=a=>e(d).validateType=a),disabled:e(p)==="update"},{default:t(()=>[(o(!0),y(_,null,b(e(T)(e(f).IOT_VALIDATE_TYPE),a=>(o(),i(E,{key:a.value,label:a.value},{default:t(()=>[v(A(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),u(M,null,{default:t(()=>[u(z,{title:"\u66F4\u591A\u914D\u7F6E"},{default:t(()=>[u(r,{label:"\u4EA7\u54C1\u56FE\u6807",prop:"icon"},{default:t(()=>[u(e(C),{modelValue:e(d).icon,"onUpdate:modelValue":l[8]||(l[8]=a=>e(d).icon=a),height:"80px",width:"80px"},null,8,["modelValue"])]),_:1}),u(r,{label:"\u4EA7\u54C1\u56FE\u7247",prop:"picUrl"},{default:t(()=>[u(e(C),{modelValue:e(d).picUrl,"onUpdate:modelValue":l[9]||(l[9]=a=>e(d).picUrl=a),height:"120px",width:"120px"},null,8,["modelValue"])]),_:1}),u(r,{label:"\u4EA7\u54C1\u63CF\u8FF0",prop:"description"},{default:t(()=>[u(h,{type:"textarea",modelValue:e(d).description,"onUpdate:modelValue":l[10]||(l[10]=a=>e(d).description=a),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[B,e(n)]])]),_:1},8,["title","modelValue"])}}});export{be as _};
