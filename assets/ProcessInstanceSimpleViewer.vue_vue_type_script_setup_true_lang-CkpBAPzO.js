import{p as T}from"./index-C1TKk8vI.js";import{T as e}from"./index-DwSWB2Hs.js";import{a as i}from"./consts-D6_WKT2v.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{aj as v}from"./form-designer-BpYekVAY.js";import{_ as I}from"./simple-process-designer-DWOFOAFc.js";import{u as f}from"./node-Do_BcwVI.js";import{x as E,r as l,f as S,y as m,E as P,u as y,t as R,G as D,z as V,O as w}from"./form-create-7GAbgMwl.js";const C=E({name:"SimpleProcessViewer",__name:"SimpleProcessViewer",props:{flowNode:{type:Object,required:!0},tasks:{type:Array,default:()=>[]},processInstance:{type:Object,default:()=>{}}},setup(N){const c=N,r=l(c.tasks),p=l(c.processInstance),O=f(c);return S(()=>c.tasks,n=>{r.value=n}),S(()=>c.processInstance,n=>{p.value=n}),R("tasks",r),R("processInstance",p),(n,t)=>{const s=I;return m(),P(s,{"flow-node":y(O),readonly:!0},null,8,["flow-node"])}}}),k={class:"process-viewer-container"},L=E({name:"BpmProcessInstanceSimpleViewer",__name:"ProcessInstanceSimpleViewer",props:{loading:T.bool.def(!1),modelView:T.object,simpleJson:T.string},setup(N){const c=N,r=l({}),p=l([]),O=l();S(()=>c.modelView,async t=>{var s;if(t){p.value=t.tasks,O.value=t.processInstance;const o=t.rejectedTaskActivityIds,d=t.unfinishedTaskActivityIds,a=t.finishedTaskActivityIds,u=t.finishedSequenceFlowActivityIds;n(t.simpleModel,(s=t.processInstance)==null?void 0:s.status,o,d,a,u),r.value=t.simpleModel?t.simpleModel:{}}}),S(()=>c.simpleJson,async t=>{t&&(r.value=JSON.parse(t))});const n=(t,s,o,d,a,u)=>{var _;t&&(t.type!==i.END_EVENT_NODE?(t.type!==i.START_USER_NODE&&t.type!==i.USER_TASK_NODE&&t.type!==i.TRANSACTOR_NODE&&t.type!==i.CHILD_PROCESS_NODE||(t.activityStatus=e.NOT_START,o.includes(t.id)?t.activityStatus=e.REJECT:d.includes(t.id)?t.activityStatus=e.RUNNING:a.includes(t.id)&&(t.activityStatus=e.APPROVE)),t.type===i.COPY_TASK_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.DELAY_TIMER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.TRIGGER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.CONDITION_NODE&&(u.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type!==i.CONDITION_BRANCH_NODE&&t.type!==i.PARALLEL_BRANCH_NODE&&t.type!==i.INCLUSIVE_BRANCH_NODE&&t.type!==i.ROUTER_BRANCH_NODE||(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START,(_=t.conditionNodes)==null||_.forEach(A=>{n(A,s,o,d,a,u)})),n(t.childNode,s,o,d,a,u)):a.includes(t.id)?t.activityStatus=s:t.activityStatus=e.NOT_START)};return(t,s)=>{const o=v;return D((m(),V("div",k,[w(y(C),{"flow-node":y(r),tasks:y(p),"process-instance":y(O)},null,8,["flow-node","tasks","process-instance"])])),[[o,N.loading]])}}});export{L as _};
