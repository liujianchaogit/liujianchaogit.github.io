import{d as O,b as R,D as j,_ as z}from"./index-C1TKk8vI.js";import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as F}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{d as G}from"./formatTime-EbFUBcAO.js";import{L as v,_ as P,g as Q,d as D}from"./CustomerLimitConfigForm.vue_vue_type_script_setup_true_lang-gD3j5Els.js";import{f as Y,$ as q,_ as B,aj as J}from"./form-designer-BpYekVAY.js";import{x as K,r as d,X,j as $,aq as H,y as p,z as V,O as t,F as n,K as g,G as y,E as u,u as l,J as W,M as Z}from"./form-create-7GAbgMwl.js";const ee=K({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{}},setup(T){const w=O(),{t:I}=R(),_=d(!0),b=d(0),k=d([]),s=X({pageNo:1,pageSize:10,type:T.confType}),m=async()=>{_.value=!0;try{const o=await Q(s);k.value=o.list,b.value=o.total}finally{_.value=!1}},N=d(),S=(o,e)=>{N.value.open(o,T.confType,e)},L=()=>{s.pageNo=1,m()};return $(()=>{m()}),(o,e)=>{const h=z,f=Y,i=q,x=F,E=B,U=A,C=H("hasPermi"),M=J;return p(),V(Z,null,[t(f,{plain:"",onClick:L},{default:n(()=>[t(h,{icon:"ep:refresh",class:"mr-5px"}),e[3]||(e[3]=g(" \u5237\u65B0 "))]),_:1}),y((p(),u(f,{type:"primary",plain:"",onClick:e[0]||(e[0]=a=>S("create"))},{default:n(()=>[t(h,{icon:"ep:plus",class:"mr-5px"}),e[4]||(e[4]=g(" \u65B0\u589E "))]),_:1})),[[C,["crm:customer-limit-config:create"]]]),y((p(),u(E,{data:l(k),stripe:!0,"show-overflow-tooltip":!0,class:"mt-4"},{default:n(()=>[t(i,{label:"\u7F16\u53F7",align:"center",prop:"id"}),t(i,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",align:"center",formatter:a=>{var r;return(r=a.users)==null?void 0:r.map(c=>c.nickname).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",align:"center",formatter:a=>{var r;return(r=a.depts)==null?void 0:r.map(c=>c.name).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:o.confType===l(v).CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",align:"center",prop:"maxCount"},null,8,["label"]),o.confType===l(v).CUSTOMER_QUANTITY_LIMIT?(p(),u(i,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",align:"center",prop:"dealCountEnabled","min-width":"100"},{default:n(a=>[t(x,{type:l(j).INFRA_BOOLEAN_STRING,value:a.row.dealCountEnabled},null,8,["type","value"])]),_:1})):W("",!0),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:l(G),width:"180px"},null,8,["formatter"]),t(i,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:n(a=>[y((p(),u(f,{link:"",type:"primary",onClick:r=>S("update",a.row.id)},{default:n(()=>e[5]||(e[5]=[g(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:update"]]]),y((p(),u(f,{link:"",type:"danger",onClick:r=>(async c=>{try{await w.delConfirm(),await D(c),w.success(I("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:n(()=>e[6]||(e[6]=[g(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[M,l(_)]]),t(U,{total:l(b),page:l(s).pageNo,"onUpdate:page":e[1]||(e[1]=a=>l(s).pageNo=a),limit:l(s).pageSize,"onUpdate:limit":e[2]||(e[2]=a=>l(s).pageSize=a),onPagination:m},null,8,["total","page","limit"]),t(P,{ref_key:"formRef",ref:N,onSuccess:m},null,512)],64)}}});export{ee as _};
