import{d as D,u as E,e as F}from"./index-DiGvuAxb.js";import{_ as G,g as H}from"./index-CW_9iX_V.js";import{u as L}from"./tagsView-B3xQDSQ0.js";import{a as U}from"./index-5ADGgtek.js";import{_ as V}from"./ContactDetailsHeader.vue_vue_type_script_setup_true_lang-9lkWW5IT.js";import{_ as W}from"./ContactDetailsInfo.vue_vue_type_script_setup_true_lang-B5dOg9pZ.js";import{_ as $}from"./BusinessList.vue_vue_type_script_setup_true_lang-JLgF6oBm.js";import{_ as q}from"./PermissionList.vue_vue_type_script_setup_true_lang-DuRPTcsq.js";import{B as s}from"./index-BbXovwRQ.js";import{_ as P}from"./ContactForm.vue_vue_type_script_setup_true_lang-CyzVB0Fa.js";import{_ as Q}from"./TransferForm.vue_vue_type_script_setup_true_lang-BAOmVy5z.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-m0iBWoAP.js";import{aj as K,f as X,a0 as Y,$ as Z,j as tt}from"./form-designer-drfGvdgz.js";import{k as at,r as o,e as it,l as rt,m as u,A as et,H as a,u as t,y as c,z as i,C as O,E as g,G as ot}from"./form-create-D7wT855o.js";import"./formatTime-DeTj2b0K.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import"./index-CTd4bIoJ.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-Cjx3XcOv.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./index-ql53Efwg.js";import"./index-CwL9yoSU.js";import"./index-BEHCTgo8.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-DxqNVEr9.js";import"./index-BecHlYrv.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DjDqRBUp.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CDu_CIl5.js";import"./index-BXr639vD.js";import"./tree-COGD3qag.js";import"./index-lUjDMm-F.js";import"./index-D4xnjFDX.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DbaMdrhi.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-CRRE-olZ.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DnGaMf8w.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-B6rwY0dr.js";const lt=at({name:"CrmContactDetail",__name:"index",setup(mt){const A=D(),p=o(0),n=o(!0),r=o({}),f=o(),_=async()=>{n.value=!0;try{r.value=await U(p.value),await N(p.value)}finally{n.value=!1}},y=o(),b=o(),M=()=>{var l;(l=b.value)==null||l.open(r.value.id)},C=o([]),N=async l=>{if(!l)return;const e=await H({bizType:s.CRM_CONTACT,bizId:l});C.value=e.list},{delView:j}=L(),{currentRoute:x}=E(),d=()=>{j(t(x))},{params:z}=F();return it(async()=>{if(!z.id)return A.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u8054\u7CFB\u4EBA\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void d();p.value=z.id,await _()}),(l,e)=>{const v=X,m=Z,I=G,S=Y,h=tt,B=K;return u(),rt(ot,null,[et((u(),c(V,{contact:t(r)},{default:i(()=>{var T,R;return[(T=t(f))!=null&&T.validateWrite?(u(),c(v,{key:0,onClick:e[0]||(e[0]=st=>{return k="update",w=t(r).id,void y.value.open(k,w);var k,w})},{default:i(()=>e[1]||(e[1]=[g(" \u7F16\u8F91 ")])),_:1})):O("",!0),(R=t(f))!=null&&R.validateOwnerUser?(u(),c(v,{key:1,type:"primary",onClick:M},{default:i(()=>e[2]||(e[2]=[g(" \u8F6C\u79FB ")])),_:1})):O("",!0)]}),_:1},8,["contact"])),[[B,t(n)]]),a(h,null,{default:i(()=>[a(S,null,{default:i(()=>[a(m,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[a(J,{"biz-id":t(p),"biz-type":t(s).CRM_CONTACT},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:i(()=>[a(W,{contact:t(r)},null,8,["contact"])]),_:1}),a(m,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[a(I,{"log-list":t(C)},null,8,["log-list"])]),_:1}),a(m,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[a(q,{ref_key:"permissionListRef",ref:f,"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"show-action":!0,onQuitTeam:d},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u5546\u673A",lazy:""},{default:i(()=>[a($,{"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"contact-id":t(r).id,"customer-id":t(r).customerId},null,8,["biz-id","biz-type","contact-id","customer-id"])]),_:1})]),_:1})]),_:1}),a(P,{ref_key:"formRef",ref:y,onSuccess:_},null,512),a(Q,{ref_key:"transferFormRef",ref:b,"biz-type":t(s).CRM_CONTACT,onSuccess:d},null,8,["biz-type"])],64)}}});export{lt as default};
