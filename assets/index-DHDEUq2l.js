import{_ as A}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{e as N,D as z,b as L,d as j,h as w,u as K,_ as P}from"./index-C1TKk8vI.js";import{_ as W}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{C as X}from"./constants-IYPHa1Ih.js";import{g as G,c as H,u as J}from"./index-BwT0n6gf.js";import{R as Q,f as Y,k as Z,ai as $,u as ee,s as ae,h as se}from"./form-designer-BpYekVAY.js";import{s as oe,e as te,a as le}from"./formCreate-DNZv5C32.js";import{u as re}from"./tagsView-C2oS-OQq.js";import{u as ue}from"./useFormCreateDesigner-BBqqt19a.js";import{x as de,r as d,X as ie,j as me,y as h,z as b,O as s,F as o,C as ne,u as a,K as n,M as V,a4 as pe,E as fe,L as ce,l as he}from"./form-create-7GAbgMwl.js";import"./index-BCN8BzfC.js";import"./dict.type-C3NSXUg6.js";const ve={class:"h-[calc(100vh-var(--top-tool-height)-var(--tags-view-height)-var(--app-content-padding)-var(--app-content-padding)-2px)]"},ge=de({name:"BpmFormEditor",__name:"index",setup(ye){const{t:v}=L(),g=j(),C=w(),{push:k,currentRoute:x}=K(),{query:F}=w(),{delView:D}=re(),B=d({switchType:[],autoActive:!0,useTemplate:!1,formOptions:{form:{labelWidth:"100px"}},fieldReadonly:!1,hiddenDragMenu:!1,hiddenDragBtn:!1,hiddenMenu:[],hiddenItem:[],hiddenItemConfig:{},disabledItemConfig:{},showSaveBtn:!1,showConfig:!0,showBaseForm:!0,showControl:!0,showPropsForm:!0,showEventForm:!0,showValidateForm:!0,showFormConfig:!0,showInputData:!0,showDevice:!0,appendConfigData:[]}),i=d();ue(i);const u=d(!1),p=d(!1),l=d({name:"",status:X.ENABLE,remark:""}),E=ie({name:[{required:!0,message:"\u8868\u5355\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u5F00\u542F\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),f=d(),M=()=>{u.value=!0},S=async()=>{if(f&&await f.value.validate()){p.value=!0;try{const r=l.value;r.conf=te(i),r.fields=le(i),r.id?(await J(r),g.success(v("common.updateSuccess"))):(await H(r),g.success(v("common.createSuccess"))),u.value=!1,U()}finally{p.value=!1}}},U=()=>{D(a(x)),k("/bpm/manager/form")};return me(async()=>{const r=F.id;if(!r)return;const e=await G(r);if(l.value=e,oe(i,e.conf,e.fields),C.query.type!=="copy")return;const{id:y,...m}=e;l.value=m,l.value.name+="_copy"}),(r,e)=>{const y=P,m=Y,q=W,_=Z,c=$,I=ee,O=ae,R=se,T=A;return h(),b(V,null,[s(q,{"body-style":{padding:"0px"},class:"!mb-0"},{default:o(()=>[ne("div",ve,[s(a(Q),{class:"my-designer",ref_key:"designer",ref:i,config:a(B)},{handle:o(()=>[s(m,{size:"small",type:"success",plain:"",onClick:M},{default:o(()=>[s(y,{class:"mr-5px",icon:"ep:plus"}),e[5]||(e[5]=n(" \u4FDD\u5B58 "))]),_:1})]),_:1},8,["config"])])]),_:1}),s(T,{modelValue:a(u),"onUpdate:modelValue":e[4]||(e[4]=t=>he(u)?u.value=t:null),title:"\u4FDD\u5B58\u8868\u5355",width:"600"},{footer:o(()=>[s(m,{disabled:a(p),type:"primary",onClick:S},{default:o(()=>e[6]||(e[6]=[n("\u786E \u5B9A")])),_:1},8,["disabled"]),s(m,{onClick:e[3]||(e[3]=t=>u.value=!1)},{default:o(()=>e[7]||(e[7]=[n("\u53D6 \u6D88")])),_:1})]),default:o(()=>[s(R,{ref_key:"formRef",ref:f,model:a(l),rules:a(E),"label-width":"80px"},{default:o(()=>[s(c,{label:"\u8868\u5355\u540D",prop:"name"},{default:o(()=>[s(_,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).name=t),placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D"},null,8,["modelValue"])]),_:1}),s(c,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[s(O,{modelValue:a(l).status,"onUpdate:modelValue":e[1]||(e[1]=t=>a(l).status=t)},{default:o(()=>[(h(!0),b(V,null,pe(a(N)(a(z).COMMON_STATUS),t=>(h(),fe(I,{key:t.value,value:t.value},{default:o(()=>[n(ce(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(c,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[s(_,{modelValue:a(l).remark,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).remark=t),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}});export{ge as default};
