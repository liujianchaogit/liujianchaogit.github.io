import{aA as S,D as C,L as m,c as E}from"./index-DiGvuAxb.js";import{_ as P}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{e as b}from"./couponTemplate-BH0KUrpk.js";import{d as D}from"./formatter-hroZ_PAn.js";import{h as N}from"./constants-C3gLHYOK.js";import{_ as U}from"./CouponSelect.vue_vue_type_script_setup_true_lang-CXeuEhe0.js";import{f as j,k as M}from"./form-designer-drfGvdgz.js";import{k as A,r as x,e as G,n as L,l as r,m as c,G as y,H as u,z as g,E as p,$ as z,u as n,v as i,F as _}from"./form-create-D7wT855o.js";import"./color-BN7ZL7BD.js";import"./formatTime-DeTj2b0K.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";const F={class:"coupon-list-item-left flex items-center flex-wrap"},H={class:"mr-10px"},Y={class:"mr-10px"},$={class:"flex items-center"},q={class:"coupon-list-item-right"},B=E(A({name:"RewardRuleCouponSelect",__name:"RewardRuleCouponSelect",props:{modelValue:{}},emits:["update:modelValue"],setup(T,{expose:k,emit:O}){const a=S(T,"modelValue",O),l=x([]),v=x(),h=()=>{var o;(o=v.value)==null||o.open()},w=o=>{for(const e of o)l.value.some(t=>t.id===e.id)||l.value.push(e)};return k({setGiveCouponList:()=>{m(a.value)||m(l.value)||l.value.forEach(o=>{a.value.giveCouponTemplateCounts||(a.value.giveCouponTemplateCounts={}),a.value.giveCouponTemplateCounts[o.id]=o.giveCount})}}),G(async()=>{await L(),await(async()=>{if(m(a.value)||m(a.value.giveCouponTemplateCounts))return;const o=Object.keys(a.value.giveCouponTemplateCounts).map(t=>parseInt(t)),e=await b(o);e&&e.forEach(t=>{l.value.push({...t,giveCount:a.value.giveCouponTemplateCounts[t.id]})})})()}),(o,e)=>{const t=j,d=P,R=M;return c(),r(y,null,[u(t,{class:"ml-10px",type:"text",onClick:h},{default:g(()=>e[0]||(e[0]=[p("\u6DFB\u52A0\u4F18\u60E0\u52B5")])),_:1}),(c(!0),r(y,null,z(n(l),(s,V)=>(c(),r("div",{key:s.id,class:"coupon-list-item p-x-10px mb-10px flex justify-between"},[i("div",F,[i("div",H," \u4F18\u60E0\u5238\u540D\u79F0\uFF1A"+_(s.name),1),i("div",Y,[e[1]||(e[1]=p(" \u8303\u56F4\uFF1A ")),u(d,{type:n(C).PROMOTION_PRODUCT_SCOPE,value:s.productScope},null,8,["type","value"])]),i("div",$,[e[2]||(e[2]=p(" \u4F18\u60E0\uFF1A ")),u(d,{type:n(C).PROMOTION_DISCOUNT_TYPE,value:s.discountType},null,8,["type","value"]),p(" "+_(n(D)(s)),1)])]),i("div",q,[e[4]||(e[4]=p(" \u9001 ")),u(R,{modelValue:s.giveCount,"onUpdate:modelValue":f=>s.giveCount=f,class:"w-150px! p-x-20px!",placeholder:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"]),e[5]||(e[5]=p(" \u5F20 ")),u(t,{class:"ml-20px",link:"",type:"danger",onClick:f=>(I=>{l.value.splice(I,1)})(V)},{default:g(()=>e[3]||(e[3]=[p("\u5220\u9664")])),_:2},1032,["onClick"])])]))),128)),u(n(U),{ref_key:"couponSelectRef",ref:v,"take-type":n(N).ADMIN.type,onChange:w},null,8,["take-type"])],64)}}}),[["__scopeId","data-v-55987cd1"]]);export{B as default};
