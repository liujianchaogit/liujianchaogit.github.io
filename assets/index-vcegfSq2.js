import{b as T,d as q,c as D}from"./index-C1TKk8vI.js";import{_ as L}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as W}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{d as X,h as z}from"./tree-COGD3qag.js";import{g as A}from"./index-B0Mya_PA.js";import{g as B}from"./index-CZiMqbPE.js";import{y as H,j as J,T as M,i as P,f as Q,aj as Y}from"./form-designer-BpYekVAY.js";import{x as Z,r as u,c as $,y as g,E as x,F as o,O as r,u as d,K as V,G as ee,l as b}from"./form-create-7GAbgMwl.js";const ae=D(Z({name:"UserSelectForm",__name:"index",emits:["confirm"],setup(le,{expose:w,emit:C}){const I=C,{t:U}=T(),j=q(),p=u([]),v=u([]),i=u([]),f=u([]),l=u([]),n=u(!1),m=u(!1),_=u(),E=$(()=>[...i.value.filter(a=>l.value.includes(a.id)),...f.value.filter(a=>!l.value.includes(a.id))]),y=(a,e)=>{const t=[a];return e.filter(s=>s.parentId===a).forEach(s=>{t.push(...y(s.id,e))}),t},F=async()=>{try{j.success(U("common.updateSuccess")),n.value=!1;const a=i.value.filter(e=>l.value.includes(e.id));I("confirm",_.value,a)}finally{}},S=()=>{p.value=[],v.value=[],i.value=[],f.value=[],l.value=[]},G=a=>{(async e=>{m.value=!0;try{if(!e)return void(f.value=[...i.value]);const t=y(e,v.value);f.value=i.value.filter(s=>t.includes(s.deptId))}finally{m.value=!1}})(a.id)};return w({open:async(a,e)=>{_.value=a,S();const t=await A();v.value=t,p.value=z(t),i.value=await B(),f.value=[...i.value],l.value=(e==null?void 0:e.map(s=>s.id))||[],n.value=!0}}),(a,e)=>{const t=H,s=W,h=J,K=M,N=P,k=Q,O=L,R=Y;return g(),x(O,{modelValue:d(n),"onUpdate:modelValue":e[2]||(e[2]=c=>b(n)?n.value=c:null),title:"\u4EBA\u5458\u9009\u62E9",width:"800"},{footer:o(()=>{var c;return[r(k,{disabled:d(m)||!((c=d(l))!=null&&c.length),type:"primary",onClick:F},{default:o(()=>e[3]||(e[3]=[V(" \u786E \u5B9A ")])),_:1},8,["disabled"]),r(k,{onClick:e[1]||(e[1]=te=>n.value=!1)},{default:o(()=>e[4]||(e[4]=[V("\u53D6 \u6D88")])),_:1})]}),default:o(()=>[ee((g(),x(N,{class:"gap2"},{default:o(()=>[r(h,{span:6},{default:o(()=>[r(s,{class:"h-1/1"},{default:o(()=>[r(t,{ref:"treeRef",data:d(p),"expand-on-click-node":!1,props:d(X),"default-expand-all":"","highlight-current":"","node-key":"id",onNodeClick:G},null,8,["data","props"])]),_:1})]),_:1}),r(h,{span:17},{default:o(()=>[r(K,{modelValue:d(l),"onUpdate:modelValue":e[0]||(e[0]=c=>b(l)?l.value=c:null),titles:["\u672A\u9009","\u5DF2\u9009"],filterable:"","filter-placeholder":"\u641C\u7D22\u6210\u5458",data:d(E),props:{label:"nickname",key:"id"}},null,8,["modelValue","data"])]),_:1})]),_:1})),[[R,d(m)]])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-9c702428"]]);export{ae as _};
