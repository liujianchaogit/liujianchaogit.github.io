import{d as D,u as G,h as J}from"./index-C1TKk8vI.js";import{g as K,_ as L}from"./index-ArudIG2A.js";import{u as Q}from"./tagsView-C2oS-OQq.js";import{a as V}from"./index-DLPyhh9r.js";import{_ as q}from"./BusinessDetailsHeader.vue_vue_type_script_setup_true_lang-CHqob5DV.js";import{_ as A}from"./BusinessDetailsInfo.vue_vue_type_script_setup_true_lang-B0OW0Xrq.js";import{_ as H}from"./PermissionList.vue_vue_type_script_setup_true_lang-BPeTlrGi.js";import{B as m}from"./index-BuK0ap75.js";import{_ as P}from"./BusinessForm.vue_vue_type_script_setup_true_lang-C-tbO4kY.js";import{_ as X}from"./TransferForm.vue_vue_type_script_setup_true_lang-5gdfxDt4.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-Cc1LpVql.js";import{_ as Z}from"./ContactList.vue_vue_type_script_setup_true_lang-BvFFWZwX.js";import{_ as $}from"./BusinessUpdateStatusForm.vue_vue_type_script_setup_true_lang-DEShrMgV.js";import{_ as ii}from"./ContractList.vue_vue_type_script_setup_true_lang-JDWY1i8M.js";import{_ as ei}from"./BusinessProductList.vue_vue_type_script_setup_true_lang-CoKfF2Ny.js";import{f as ai,a0 as ri,a1 as si,j as ti,aj as oi}from"./form-designer-BpYekVAY.js";import{x as li,r as t,j as mi,y as u,z as ui,G as pi,u as i,E as d,F as r,K as c,J as z,O as e,M as ni}from"./form-create-7GAbgMwl.js";import"./formatTime-EbFUBcAO.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-C_qKaUAE.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-CZiMqbPE.js";import"./index-2SiQtehE.js";import"./index-Bdw660V1.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-w8Q4BfL1.js";import"./index-C69xrZfi.js";import"./index-uXIyVRuV.js";import"./index-C_v5t3_7.js";import"./index-DdKGlDdM.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-De4klYft.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DrAuCfpX.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-B-IANjnk.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-D8lenXv5.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-Cgo1EbLC.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-DNhdDOrK.js";import"./index-R1Ohxk4X.js";import"./tree-COGD3qag.js";import"./ContractForm.vue_vue_type_script_setup_true_lang-BL6ujW-4.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-BsCJVFcd.js";const di=li({name:"CrmBusinessDetail",__name:"index",setup(fi){const N=D(),p=t(0),f=t(!0),a=t({}),n=t(),b=async()=>{f.value=!0;try{a.value=await V(p.value),await g(p.value)}finally{f.value=!1}},S=t(),v=t(),C=t(),U=()=>{var l;(l=C.value)==null||l.open(a.value.id)},R=t([]),g=async l=>{if(!l)return;const s=await K({bizType:m.CRM_BUSINESS,bizId:l});R.value=s.list},{delView:x}=Q(),{currentRoute:j}=G(),_=()=>{x(i(j))},{params:k}=J();return mi(async()=>{if(!k.id)return N.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5546\u673A\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void _();p.value=k.id,await b()}),(l,s)=>{const y=ai,o=ri,F=L,h=si,O=ti,T=oi;return u(),ui(ni,null,[pi((u(),d(q,{business:i(a)},{default:r(()=>{var w,B,I;return[(w=i(n))!=null&&w.validateWrite?(u(),d(y,{key:0,onClick:s[0]||(s[0]=W=>{return E="update",M=i(a).id,void S.value.open(E,M);var E,M})},{default:r(()=>s[2]||(s[2]=[c(" \u7F16\u8F91 ")])),_:1})):z("",!0),(B=i(n))!=null&&B.validateWrite?(u(),d(y,{key:1,disabled:i(a).endStatus,type:"success",onClick:s[1]||(s[1]=W=>{v.value.open(a.value)})},{default:r(()=>s[3]||(s[3]=[c(" \u53D8\u66F4\u5546\u673A\u72B6\u6001 ")])),_:1},8,["disabled"])):z("",!0),(I=i(n))!=null&&I.validateOwnerUser?(u(),d(y,{key:2,type:"primary",onClick:U},{default:r(()=>s[4]||(s[4]=[c(" \u8F6C\u79FB ")])),_:1})):z("",!0)]}),_:1},8,["business"])),[[T,i(f)]]),e(O,null,{default:r(()=>[e(h,null,{default:r(()=>[e(o,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:r(()=>[e(Y,{"biz-id":i(p),"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:r(()=>[e(A,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u8054\u7CFB\u4EBA",lazy:""},{default:r(()=>[e(Z,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"business-id":i(a).id,"customer-id":i(a).customerId},null,8,["biz-id","biz-type","business-id","customer-id"])]),_:1}),e(o,{label:"\u4EA7\u54C1"},{default:r(()=>[e(ei,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u5408\u540C",lazy:""},{default:r(()=>[e(ii,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:r(()=>[e(F,{"log-list":i(R)},null,8,["log-list"])]),_:1}),e(o,{label:"\u56E2\u961F\u6210\u5458"},{default:r(()=>[e(H,{ref_key:"permissionListRef",ref:n,"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"show-action":!0,onQuitTeam:_},null,8,["biz-id","biz-type"])]),_:1})]),_:1})]),_:1}),e(P,{ref_key:"formRef",ref:S,onSuccess:b},null,512),e($,{ref_key:"statusFormRef",ref:v,onSuccess:b},null,512),e(X,{ref_key:"transferFormRef",ref:C,"biz-type":i(m).CRM_BUSINESS,onSuccess:_},null,8,["biz-type"])],64)}}});export{di as default};
