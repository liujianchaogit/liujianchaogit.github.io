import{V as L,_ as z}from"./index-C1TKk8vI.js";import{f as I}from"./formatTime-EbFUBcAO.js";import{Y as N,a4 as W,a2 as H,ad as U,af as G,al as K,a3 as X,a5 as $,a6 as q,ac as J,ay as P,ai as Q,w,az as D}from"./echarts-D5qUf7fo.js";import{W as Z,ad as ee,j as te,i as ae,t as se,s as le,F as ne}from"./form-designer-BpYekVAY.js";import{x as oe,r as d,X as re,j as ie,y as ce,z as de,O as a,F as s,C as t,L as m,u as c,l as A,K as _,M as ue}from"./form-create-7GAbgMwl.js";const fe=async()=>await L.get({url:"/iot/statistics/get-summary"}),me=async j=>await L.get({url:"/iot/statistics/get-log-summary",params:j}),xe={class:"flex flex-col"},pe={class:"flex justify-between items-center mb-1"},ye={class:"text-3xl font-bold text-gray-700"},ve={class:"flex justify-between items-center text-gray-400 text-sm"},ge={class:"text-green-500"},be={class:"flex flex-col"},he={class:"flex justify-between items-center mb-1"},Ce={class:"text-3xl font-bold text-gray-700"},we={class:"flex justify-between items-center text-gray-400 text-sm"},_e={class:"text-green-500"},je={class:"flex flex-col"},Oe={class:"flex justify-between items-center mb-1"},Te={class:"text-3xl font-bold text-gray-700"},Se={class:"flex justify-between items-center text-gray-400 text-sm"},ke={class:"text-green-500"},Ee={class:"flex flex-col"},Le={class:"flex justify-between items-center mb-1"},De={class:"text-3xl font-bold text-gray-700"},Ae={class:"flex justify-between items-center text-gray-400 text-sm"},Be={class:"text-green-500"},Fe={class:"flex items-center justify-between"},Me={class:"flex items-center space-x-2"},Ve=oe({name:"IoTHome",__name:"index",setup(j){N([W,H,U,G,K,X,$,q,J,P,Q]);const y=d("7d"),v=d(null),x=re({startTime:Date.now()-6048e5,endTime:Date.now()}),O=d(),T=d(),S=d(),k=d(),E=d(),o=d({productCategoryCount:0,productCount:0,deviceCount:0,deviceMessageCount:0,productCategoryTodayCount:0,productTodayCount:0,deviceTodayCount:0,deviceMessageTodayCount:0,deviceOnlineCount:0,deviceOfflineCount:0,deviceInactiveCount:0,productCategoryDeviceCounts:{}}),p=d({upstreamCounts:{},downstreamCounts:{}}),B=r=>{const e=Date.now();let i;switch(r){case"1h":i=e-36e5;break;case"24h":i=e-864e5;break;case"7d":i=e-6048e5;break;default:return}v.value=null,x.startTime=i,x.endTime=e,g()},F=r=>{r&&(y.value="",x.startTime=r[0].getTime(),x.endTime=r[1].getTime(),g())},g=async()=>{o.value=await fe(),p.value=await me(x),M()},M=()=>{w(O.value).setOption({tooltip:{trigger:"item"},legend:{top:"5%",right:"10%",align:"left",orient:"vertical",icon:"circle"},series:[{name:"Access From",type:"pie",radius:["50%","80%"],avoidLabelOverlap:!1,center:["30%","50%"],label:{show:!1,position:"outside"},emphasis:{label:{show:!0,fontSize:20,fontWeight:"bold"}},labelLine:{show:!1},data:Object.entries(o.value.productCategoryDeviceCounts).map(([r,e])=>({name:r,value:e}))}]}),b(T.value,o.value.deviceOnlineCount,"#0d9"),b(S.value,o.value.deviceOfflineCount,"#f50"),b(k.value,o.value.deviceInactiveCount,"#05b"),V()},b=(r,e,i)=>{w(r).setOption({series:[{type:"gauge",startAngle:360,endAngle:0,min:0,max:o.value.deviceCount||100,progress:{show:!0,width:12,itemStyle:{color:i}},axisLine:{lineStyle:{width:12,color:[[1,"#E5E7EB"]]}},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},pointer:{show:!1},anchor:{show:!1},title:{show:!1},detail:{valueAnimation:!0,fontSize:24,fontWeight:"bold",fontFamily:"Inter, sans-serif",color:i,offsetCenter:[0,"0"],formatter:u=>`${u} \u4E2A`},data:[{value:e}]}]})},V=()=>{const r=Array.from(new Set([...p.value.upstreamCounts.map(l=>Number(Object.keys(l)[0])),...p.value.downstreamCounts.map(l=>Number(Object.keys(l)[0]))])).sort((l,n)=>l-n),e=r.map(l=>I(l,"YYYY-MM-DD HH:mm")),i=r.map(l=>{const n=p.value.upstreamCounts.find(f=>Number(Object.keys(f)[0])===l);return n?Object.values(n)[0]:0}),u=r.map(l=>{const n=p.value.downstreamCounts.find(f=>Number(Object.keys(f)[0])===l);return n?Object.values(n)[0]:0});w(E.value).setOption({tooltip:{trigger:"axis",backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#E5E7EB",textStyle:{color:"#374151"}},legend:{data:["\u4E0A\u884C\u6D88\u606F\u91CF","\u4E0B\u884C\u6D88\u606F\u91CF"],textStyle:{color:"#374151",fontWeight:500}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e,axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"},splitLine:{lineStyle:{color:"#F3F4F6"}}},series:[{name:"\u4E0A\u884C\u6D88\u606F\u91CF",type:"line",smooth:!0,data:i,itemStyle:{color:"#3B82F6"},lineStyle:{width:2},areaStyle:{color:new D(0,0,0,1,[{offset:0,color:"rgba(59, 130, 246, 0.2)"},{offset:1,color:"rgba(59, 130, 246, 0)"}])}},{name:"\u4E0B\u884C\u6D88\u606F\u91CF",type:"line",smooth:!0,data:u,itemStyle:{color:"#10B981"},lineStyle:{width:2},areaStyle:{color:new D(0,0,0,1,[{offset:0,color:"rgba(16, 185, 129, 0.2)"},{offset:1,color:"rgba(16, 185, 129, 0)"}])}}]})};return ie(()=>{g()}),(r,e)=>{const i=z,u=Z,l=ee,n=te,f=ae,h=se,R=le,Y=ne;return ce(),de(ue,null,[a(f,{gutter:16,class:"mb-4"},{default:s(()=>[a(n,{span:6},{default:s(()=>[a(l,{class:"stat-card",shadow:"never"},{default:s(()=>[t("div",xe,[t("div",pe,[e[2]||(e[2]=t("span",{class:"text-gray-500 text-base font-medium"},"\u5206\u7C7B\u6570\u91CF",-1)),a(i,{icon:"ep:menu",class:"text-[32px] text-blue-400"})]),t("span",ye,m(c(o).productCategoryCount),1),a(u,{class:"my-2"}),t("div",ve,[e[3]||(e[3]=t("span",null,"\u4ECA\u65E5\u65B0\u589E",-1)),t("span",ge,"+"+m(c(o).productCategoryTodayCount),1)])])]),_:1})]),_:1}),a(n,{span:6},{default:s(()=>[a(l,{class:"stat-card",shadow:"never"},{default:s(()=>[t("div",be,[t("div",he,[e[4]||(e[4]=t("span",{class:"text-gray-500 text-base font-medium"},"\u4EA7\u54C1\u6570\u91CF",-1)),a(i,{icon:"ep:box",class:"text-[32px] text-orange-400"})]),t("span",Ce,m(c(o).productCount),1),a(u,{class:"my-2"}),t("div",we,[e[5]||(e[5]=t("span",null,"\u4ECA\u65E5\u65B0\u589E",-1)),t("span",_e,"+"+m(c(o).productTodayCount),1)])])]),_:1})]),_:1}),a(n,{span:6},{default:s(()=>[a(l,{class:"stat-card",shadow:"never"},{default:s(()=>[t("div",je,[t("div",Oe,[e[6]||(e[6]=t("span",{class:"text-gray-500 text-base font-medium"},"\u8BBE\u5907\u6570\u91CF",-1)),a(i,{icon:"ep:cpu",class:"text-[32px] text-purple-400"})]),t("span",Te,m(c(o).deviceCount),1),a(u,{class:"my-2"}),t("div",Se,[e[7]||(e[7]=t("span",null,"\u4ECA\u65E5\u65B0\u589E",-1)),t("span",ke,"+"+m(c(o).deviceTodayCount),1)])])]),_:1})]),_:1}),a(n,{span:6},{default:s(()=>[a(l,{class:"stat-card",shadow:"never"},{default:s(()=>[t("div",Ee,[t("div",Le,[e[8]||(e[8]=t("span",{class:"text-gray-500 text-base font-medium"},"\u8BBE\u5907\u6D88\u606F\u6570",-1)),a(i,{icon:"ep:message",class:"text-[32px] text-teal-400"})]),t("span",De,m(c(o).deviceMessageCount),1),a(u,{class:"my-2"}),t("div",Ae,[e[9]||(e[9]=t("span",null,"\u4ECA\u65E5\u65B0\u589E",-1)),t("span",Be,"+"+m(c(o).deviceMessageTodayCount),1)])])]),_:1})]),_:1})]),_:1}),a(f,{gutter:16,class:"mb-4"},{default:s(()=>[a(n,{span:12},{default:s(()=>[a(l,{class:"chart-card",shadow:"never"},{header:s(()=>e[10]||(e[10]=[t("div",{class:"flex items-center"},[t("span",{class:"text-base font-medium text-gray-600"},"\u8BBE\u5907\u6570\u91CF\u7EDF\u8BA1")],-1)])),default:s(()=>[t("div",{ref_key:"deviceCountChartRef",ref:O,class:"h-[240px]"},null,512)]),_:1})]),_:1}),a(n,{span:12},{default:s(()=>[a(l,{class:"chart-card",shadow:"never"},{header:s(()=>e[11]||(e[11]=[t("div",{class:"flex items-center"},[t("span",{class:"text-base font-medium text-gray-600"},"\u8BBE\u5907\u72B6\u6001\u7EDF\u8BA1")],-1)])),default:s(()=>[a(f,{class:"h-[240px]"},{default:s(()=>[a(n,{span:8,class:"flex flex-col items-center"},{default:s(()=>[t("div",{ref_key:"deviceOnlineCountChartRef",ref:T,class:"h-[160px] w-full"},null,512),e[12]||(e[12]=t("div",{class:"text-center mt-2"},[t("span",{class:"text-sm text-gray-600"},"\u5728\u7EBF\u8BBE\u5907")],-1))]),_:1}),a(n,{span:8,class:"flex flex-col items-center"},{default:s(()=>[t("div",{ref_key:"deviceOfflineChartRef",ref:S,class:"h-[160px] w-full"},null,512),e[13]||(e[13]=t("div",{class:"text-center mt-2"},[t("span",{class:"text-sm text-gray-600"},"\u79BB\u7EBF\u8BBE\u5907")],-1))]),_:1}),a(n,{span:8,class:"flex flex-col items-center"},{default:s(()=>[t("div",{ref_key:"deviceActiveChartRef",ref:k,class:"h-[160px] w-full"},null,512),e[14]||(e[14]=t("div",{class:"text-center mt-2"},[t("span",{class:"text-sm text-gray-600"},"\u5F85\u6FC0\u6D3B\u8BBE\u5907")],-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(f,null,{default:s(()=>[a(n,{span:24},{default:s(()=>[a(l,{class:"chart-card",shadow:"never"},{header:s(()=>[t("div",Fe,[e[18]||(e[18]=t("span",{class:"text-base font-medium text-gray-600"},"\u4E0A\u4E0B\u884C\u6D88\u606F\u91CF\u7EDF\u8BA1",-1)),t("div",Me,[a(R,{modelValue:c(y),"onUpdate:modelValue":e[0]||(e[0]=C=>A(y)?y.value=C:null),onChange:B},{default:s(()=>[a(h,{label:"1h"},{default:s(()=>e[15]||(e[15]=[_("\u6700\u8FD11\u5C0F\u65F6")])),_:1}),a(h,{label:"24h"},{default:s(()=>e[16]||(e[16]=[_("\u6700\u8FD124\u5C0F\u65F6")])),_:1}),a(h,{label:"7d"},{default:s(()=>e[17]||(e[17]=[_("\u8FD1\u4E00\u5468")])),_:1})]),_:1},8,["modelValue"]),a(Y,{modelValue:c(v),"onUpdate:modelValue":e[1]||(e[1]=C=>A(v)?v.value=C:null),type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)],onChange:F},null,8,["modelValue","default-time"])])])]),default:s(()=>[t("div",{ref_key:"deviceMessageCountChartRef",ref:E,class:"h-[300px]"},null,512)]),_:1})]),_:1})]),_:1})],64)}}});export{Ve as default};
