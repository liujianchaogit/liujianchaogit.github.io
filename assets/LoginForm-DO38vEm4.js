import{a as ne,d as oe,u as ie,o as re,_ as se,q as de,af as pe,z as k,v as ce,w as ue,x as me,r as fe,ag as ge,y as j,ah as he,c as we}from"./index-DiGvuAxb.js";import{_ as ye}from"./Verify-BKmoL0S4.js";import{_ as _e}from"./XButton-BXTtfQPD.js";import{k as xe,r as m,c as be,u as t,P as ve,b as ke,e as Fe,A as Ve,I as Ee,y as F,m as _,z as l,H as a,C as U,Z as Ne,E as p,F as V,v as O,l as Ce,G as Re,$ as Le}from"./form-create-D7wT855o.js";import{u as Pe,L as h,_ as Se,a as Ie}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-Bo4PwzaE.js";import{u as E}from"./useIcon-D9kiYfhb.js";import{r as N}from"./formRules-D4RhDYOS.js";import{i as Me,j as ze,ai as je,k as Ue,w as Oe,P as Te,V as Ae,h as Ge,d as $e}from"./form-designer-drfGvdgz.js";const qe={class:"w-[100%] flex justify-between"},De={class:"w-[100%] flex justify-between"},Qe=we(xe({name:"LoginForm",__name:"LoginForm",setup(Be){const{t:d}=ne(),C=oe(),T=E({icon:"ep:house"}),A=E({icon:"ep:avatar"}),G=E({icon:"ep:lock"}),R=m(),{validForm:$}=Ie(R),{setLoginState:w,getLoginState:q}=Pe(),{currentRoute:D,push:Q}=ie(),B=re(),c=m(""),f=m(!1),L=m(),H=m("blockPuzzle"),K=be(()=>t(q)===h.LOGIN),W={tenantName:[N],username:[N],password:[N]},n=ve({isShowPassword:!1,captchaEnable:"true",tenantEnable:"false",loginForm:{tenantName:"\u828B\u9053\u6E90\u7801",username:"admin",password:"admin123",captchaVerification:"",rememberMe:!0}}),Z=[{icon:"ant-design:wechat-filled",type:30},{icon:"ant-design:dingtalk-circle-filled",type:20},{icon:"ant-design:github-filled",type:0},{icon:"ant-design:alipay-circle-filled",type:0}],P=async()=>{n.captchaEnable==="false"?await M({}):L.value.show()},S=async()=>{if(n.tenantEnable==="true"){const o=await j(n.loginForm.tenantName);k(o)}},I=m(),M=async o=>{f.value=!0;try{if(await S(),!await $())return;const e={...n.loginForm};e.captchaVerification=o.captchaVerification;const s=await ce(e);if(!s)return;I.value=$e.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.rememberMe?ue(e):me(),fe(s),c.value||(c.value="/"),c.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):await Q({path:c.value||B.addRouters[0].path})}finally{f.value=!1,I.value.close()}};return ke(()=>D.value,o=>{var e;c.value=(e=o==null?void 0:o.query)==null?void 0:e.redirect},{immediate:!0}),Fe(()=>{(()=>{const o=de();o&&(n.loginForm={...n.loginForm,username:o.username?o.username:n.loginForm.username,password:o.password?o.password:n.loginForm.password,rememberMe:o.rememberMe,tenantName:o.tenantName?o.tenantName:n.loginForm.tenantName})})(),(async()=>{const o=location.host,e=await pe(o);e&&(n.loginForm.tenantName=e.name,k(e.id))})()}),(o,e)=>{const s=je,r=ze,x=Ue,J=Oe,g=Te,b=Me,y=_e,X=ye,z=Ae,Y=se,ee=Ge;return Ve((_(),F(ee,{ref_key:"formLogin",ref:R,model:t(n).loginForm,rules:W,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:l(()=>[a(b,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:l(()=>[a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(Se,{style:{width:"100%"}})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(n).tenantEnable==="true"?(_(),F(s,{key:0,prop:"tenantName"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.tenantName,"onUpdate:modelValue":e[0]||(e[0]=i=>t(n).loginForm.tenantName=i),placeholder:t(d)("login.tenantNamePlaceholder"),"prefix-icon":t(T),link:"",type:"primary"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):U("",!0)]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,{prop:"username"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.username,"onUpdate:modelValue":e[1]||(e[1]=i=>t(n).loginForm.username=i),placeholder:t(d)("login.usernamePlaceholder"),"prefix-icon":t(A)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,{prop:"password"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.password,"onUpdate:modelValue":e[2]||(e[2]=i=>t(n).loginForm.password=i),placeholder:t(d)("login.passwordPlaceholder"),"prefix-icon":t(G),"show-password":"",type:"password",onKeyup:e[3]||(e[3]=Ne(i=>P(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(b,{justify:"space-between",style:{width:"100%"}},{default:l(()=>[a(r,{span:6},{default:l(()=>[a(J,{modelValue:t(n).loginForm.rememberMe,"onUpdate:modelValue":e[4]||(e[4]=i=>t(n).loginForm.rememberMe=i)},{default:l(()=>[p(V(t(d)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(r,{offset:6,span:12},{default:l(()=>[a(g,{style:{float:"right"},type:"primary",onClick:e[5]||(e[5]=i=>t(w)(t(h).RESET_PASSWORD))},{default:l(()=>[p(V(t(d)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(y,{loading:t(f),title:t(d)("login.login"),class:"w-[100%]",type:"primary",onClick:e[6]||(e[6]=i=>P())},null,8,["loading","title"])]),_:1})]),_:1}),t(n).captchaEnable==="true"?(_(),F(X,{key:0,ref_key:"verify",ref:L,captchaType:t(H),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:M},null,8,["captchaType"])):U("",!0),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(b,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:l(()=>[a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnMobile"),class:"w-[100%]",onClick:e[7]||(e[7]=i=>t(w)(t(h).MOBILE))},null,8,["title"])]),_:1}),a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnQRCode"),class:"w-[100%]",onClick:e[8]||(e[8]=i=>t(w)(t(h).QR_CODE))},null,8,["title"])]),_:1}),a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnRegister"),class:"w-[100%]",onClick:e[9]||(e[9]=i=>t(w)(t(h).REGISTER))},null,8,["title"])]),_:1})]),_:1})]),_:1})]),_:1}),a(z,{"content-position":"center"},{default:l(()=>[p(V(t(d)("login.otherLogin")),1)]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[O("div",qe,[(_(),Ce(Re,null,Le(Z,(i,ae)=>a(Y,{key:ae,icon:i.icon,size:30,class:"anticon cursor-pointer",color:"#999",onClick:He=>(async v=>{if(v===0)C.error("\u6B64\u65B9\u5F0F\u672A\u914D\u7F6E");else{if(f.value=!0,n.tenantEnable==="true"&&(await S(),!ge()))try{const u=await C.prompt("\u8BF7\u8F93\u5165\u79DF\u6237\u540D\u79F0",d("common.reminder"));if((u==null?void 0:u.action)!=="confirm")throw"cancel";const le=await j(u.value);k(le)}catch(u){if(u==="cancel")return}finally{f.value=!1}const te=location.origin+"/social-login?"+encodeURIComponent(`type=${v}&redirect=${c.value||"/"}`);window.location.href=await he(v,encodeURIComponent(te))}})(i.type)},null,8,["icon","onClick"])),64))])]),_:1})]),_:1}),a(z,{"content-position":"center"},{default:l(()=>e[10]||(e[10]=[p("\u840C\u65B0\u5FC5\u8BFB")])),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[O("div",De,[a(g,{href:"https://doc.iocoder.cn/",target:"_blank"},{default:l(()=>e[11]||(e[11]=[p("\u{1F4DA}\u5F00\u53D1\u6307\u5357")])),_:1}),a(g,{href:"https://doc.iocoder.cn/video/",target:"_blank"},{default:l(()=>e[12]||(e[12]=[p("\u{1F525}\u89C6\u9891\u6559\u7A0B")])),_:1}),a(g,{href:"https://www.iocoder.cn/Interview/good-collection/",target:"_blank"},{default:l(()=>e[13]||(e[13]=[p(" \u26A1\u9762\u8BD5\u624B\u518C ")])),_:1}),a(g,{href:"http://static.yudao.iocoder.cn/mp/Aix9975.jpeg",target:"_blank"},{default:l(()=>e[14]||(e[14]=[p(" \u{1F91D}\u5916\u5305\u54A8\u8BE2 ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[Ee,t(K)]])}}}),[["__scopeId","data-v-c72b61ad"]]);export{Qe as default};
