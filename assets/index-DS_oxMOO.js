import{a as q,d as B,c as D}from"./index-DiGvuAxb.js";import{_ as G}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{_ as K}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{d as W,h as J}from"./tree-COGD3qag.js";import{g as L}from"./index-eU2zJvzd.js";import{g as M}from"./index-BEHCTgo8.js";import{aj as O,i as P,j as Q,y as T,S as X,f as Y}from"./form-designer-drfGvdgz.js";import{k as Z,r as u,c as $,y as g,m as V,u as o,h as x,z as d,A as ee,H as r,E as b}from"./form-create-D7wT855o.js";const ae=D(Z({name:"UserSelectForm",__name:"index",emits:["confirm"],setup(le,{expose:w,emit:C}){const I=C,{t:S}=q(),U=B(),p=u([]),v=u([]),i=u([]),m=u([]),l=u([]),n=u(!1),f=u(!1),_=u(),j=$(()=>[...i.value.filter(a=>l.value.includes(a.id)),...m.value.filter(a=>!l.value.includes(a.id))]),y=(a,e)=>{const t=[a];return e.filter(s=>s.parentId===a).forEach(s=>{t.push(...y(s.id,e))}),t},E=async()=>{try{U.success(S("common.updateSuccess")),n.value=!1;const a=i.value.filter(e=>l.value.includes(e.id));I("confirm",_.value,a)}finally{}},z=()=>{p.value=[],v.value=[],i.value=[],m.value=[],l.value=[]},A=a=>{(async e=>{f.value=!0;try{if(!e)return void(m.value=[...i.value]);const t=y(e,v.value);m.value=i.value.filter(s=>t.includes(s.deptId))}finally{f.value=!1}})(a.id)};return w({open:async(a,e)=>{_.value=a,z();const t=await L();v.value=t,p.value=J(t),i.value=await M(),m.value=[...i.value],l.value=(e==null?void 0:e.map(s=>s.id))||[],n.value=!0}}),(a,e)=>{const t=T,s=K,h=Q,F=X,H=P,k=Y,N=G,R=O;return V(),g(N,{modelValue:o(n),"onUpdate:modelValue":e[2]||(e[2]=c=>x(n)?n.value=c:null),title:"\u4EBA\u5458\u9009\u62E9",width:"800"},{footer:d(()=>{var c;return[r(k,{disabled:o(f)||!((c=o(l))!=null&&c.length),type:"primary",onClick:E},{default:d(()=>e[3]||(e[3]=[b(" \u786E \u5B9A ")])),_:1},8,["disabled"]),r(k,{onClick:e[1]||(e[1]=te=>n.value=!1)},{default:d(()=>e[4]||(e[4]=[b("\u53D6 \u6D88")])),_:1})]}),default:d(()=>[ee((V(),g(H,{class:"gap2"},{default:d(()=>[r(h,{span:6},{default:d(()=>[r(s,{class:"h-1/1"},{default:d(()=>[r(t,{ref:"treeRef",data:o(p),"expand-on-click-node":!1,props:o(W),"default-expand-all":"","highlight-current":"","node-key":"id",onNodeClick:A},null,8,["data","props"])]),_:1})]),_:1}),r(h,{span:17},{default:d(()=>[r(F,{modelValue:o(l),"onUpdate:modelValue":e[0]||(e[0]=c=>x(l)?l.value=c:null),titles:["\u672A\u9009","\u5DF2\u9009"],filterable:"","filter-placeholder":"\u641C\u7D22\u6210\u5458",data:o(j),props:{label:"nickname",key:"id"}},null,8,["modelValue","data"])]),_:1})]),_:1})),[[R,o(f)]])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-9c702428"]]);export{ae as _};
