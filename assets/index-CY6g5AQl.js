import{u as H,d as J,_ as Q,c as T}from"./index-C1TKk8vI.js";import{_ as Z}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as $}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{x as ee,r,X as ae,Y as le,ae as oe,aq as te,y as d,z as V,O as a,F as l,C as g,u as o,E as h,U as se,a5 as re,G as M,K as u,l as U,M as me}from"./form-create-7GAbgMwl.js";import{V as ne}from"./vuedraggable.umd-DP3omUoG.js";import{C as z}from"./index-C3kvgmux.js";import{a as ie}from"./index-j0g2sdlj.js";import{_ as de}from"./CategoryForm.vue_vue_type_script_setup_true_lang-g47XANYZ.js";import ue from"./CategoryDraggableModel-BkOZ4YX1.js";import{K as B,k as pe,ai as ce,f as fe,a4 as ye,a3 as _e,a2 as xe,h as ve,W as ge,aj as he}from"./form-designer-BpYekVAY.js";import"./constants-IYPHa1Ih.js";import"./el-collapse-transition-l0sNRNKZ.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./formatTime-EbFUBcAO.js";import"./index-BwT0n6gf.js";import"./formCreate-DNZv5C32.js";import"./permission-0vfiopec.js";const Ce={class:"flex justify-between pl-20px items-center"},be={key:1,class:"mr-20px"},ke={class:"px-15px"},we=T(ee({name:"BpmModel",__name:"index",setup(Se){const{push:F}=H(),G=J(),y=r(!0),n=r(!1),p=ae({name:void 0}),I=r(),m=r([]),C=r([]),K=()=>{i()},_=r(!1),b=r({rule:[],option:{}}),k=r(),j=()=>{k.value.open("create")},q=()=>{C.value=B(m.value),n.value=!0},A=()=>{m.value=B(C.value),n.value=!1},L=async()=>{const c=m.value.map(e=>e.id);await z.updateCategorySortBatch(c),n.value=!1,G.success("\u6392\u5E8F\u5206\u7C7B\u6210\u529F"),await i()},i=async()=>{y.value=!0;try{const c=await ie(p.name),e=await z.getCategorySimpleList();m.value=e.map(s=>({...s,modelList:c.filter(x=>x.categoryName==s.name)}))}finally{y.value=!1}};return le(()=>{i()}),(c,e)=>{const s=Q,x=pe,v=ce,f=fe,w=ye,R=_e,Y=xe,E=ve,N=ge,S=$,O=oe("form-create"),P=Z,W=te("hasPermi"),X=he;return d(),V(me,null,[a(S,null,{default:l(()=>[g("div",Ce,[e[11]||(e[11]=g("h3",{class:"font-extrabold"},"\u6D41\u7A0B\u6A21\u578B",-1)),o(n)?(d(),V("div",be,[a(f,{onClick:A},{default:l(()=>e[9]||(e[9]=[u(" \u53D6 \u6D88 ")])),_:1}),a(f,{type:"primary",onClick:L},{default:l(()=>e[10]||(e[10]=[u(" \u4FDD\u5B58\u6392\u5E8F ")])),_:1})])):(d(),h(E,{key:0,class:"-mb-15px flex mr-10px",model:o(p),ref_key:"queryFormRef",ref:I,inline:!0,"label-width":"68px",onSubmit:e[3]||(e[3]=se(()=>{},["prevent"]))},{default:l(()=>[a(v,{prop:"name",class:"ml-auto"},{default:l(()=>[a(x,{modelValue:o(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>o(p).name=t),placeholder:"\u641C\u7D22\u6D41\u7A0B",clearable:"",onKeyup:re(K,["enter"]),class:"!w-240px"},{prefix:l(()=>[a(s,{icon:"ep:search",class:"mx-10px"})]),_:1},8,["modelValue"])]),_:1}),a(v,null,{default:l(()=>[M((d(),h(f,{type:"primary",onClick:e[1]||(e[1]=t=>{F({name:"BpmModelCreate"})})},{default:l(()=>[a(s,{icon:"ep:plus",class:"mr-5px"}),e[6]||(e[6]=u(" \u65B0\u5EFA\u6A21\u578B "))]),_:1})),[[W,["bpm:model:create"]]])]),_:1}),a(v,null,{default:l(()=>[a(Y,{onCommand:e[2]||(e[2]=t=>(D=>{switch(D){case"handleCategoryAdd":j();break;case"handleCategorySort":q()}})(t)),placement:"bottom-end"},{dropdown:l(()=>[a(R,null,{default:l(()=>[a(w,{command:"handleCategoryAdd"},{default:l(()=>[a(s,{icon:"ep:circle-plus",size:13,class:"mr-5px"}),e[7]||(e[7]=u(" \u65B0\u5EFA\u5206\u7C7B "))]),_:1}),a(w,{command:"handleCategorySort"},{default:l(()=>[a(s,{icon:"fa:sort-amount-desc",size:13,class:"mr-5px"}),e[8]||(e[8]=u(" \u5206\u7C7B\u6392\u5E8F "))]),_:1})]),_:1})]),default:l(()=>[a(f,{class:"w-30px",plain:""},{default:l(()=>[a(s,{icon:"ep:setting"})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))]),a(N),g("div",ke,[a(o(ne),{disabled:!o(n),modelValue:o(m),"onUpdate:modelValue":e[4]||(e[4]=t=>U(m)?m.value=t:null),"item-key":"id",animation:400},{item:l(({element:t})=>[M((d(),h(S,{class:"rounded-lg transition-all duration-300 ease-in-out hover:shadow-xl","body-style":{padding:0},key:t.id},{default:l(()=>[a(ue,{isCategorySorting:o(n),categoryInfo:t,onSuccess:i},null,8,["isCategorySorting","categoryInfo"])]),_:2},1024)),[[X,o(y)]])]),_:1},8,["disabled","modelValue"])])]),_:1}),a(de,{ref_key:"categoryFormRef",ref:k,onSuccess:i},null,512),a(P,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:o(_),"onUpdate:modelValue":e[5]||(e[5]=t=>U(_)?_.value=t:null),width:"800"},{default:l(()=>[a(O,{rule:o(b).rule,option:o(b).option},null,8,["rule","option"])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-d65242ea"]]);export{we as default};
