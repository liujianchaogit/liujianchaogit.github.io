import{d as D,u as F,e as G}from"./index-DiGvuAxb.js";import{_ as H,g as I}from"./index-CW_9iX_V.js";import{u as P}from"./tagsView-B3xQDSQ0.js";import{g as Q,t as V}from"./index-lUjDMm-F.js";import{_ as W}from"./ClueForm.vue_vue_type_script_setup_true_lang-zQVaQMOZ.js";import{_ as j}from"./ClueDetailsHeader.vue_vue_type_script_setup_true_lang-CvDtcngN.js";import{_ as q}from"./ClueDetailsInfo.vue_vue_type_script_setup_true_lang-ZM8HC8Zw.js";import{_ as J}from"./PermissionList.vue_vue_type_script_setup_true_lang-DuRPTcsq.js";import{_ as K}from"./TransferForm.vue_vue_type_script_setup_true_lang-BAOmVy5z.js";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang-m0iBWoAP.js";import{B as f}from"./index-BbXovwRQ.js";import{f as X,a0 as Y,$ as Z,j as aa}from"./form-designer-drfGvdgz.js";import{k as ea,r as s,e as ia,af as ra,l as ta,m,H as e,z as i,A as la,C as U,y as d,u as a,E as c,G as oa}from"./form-create-D7wT855o.js";import"./formatTime-DeTj2b0K.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./index-BXr639vD.js";import"./tree-COGD3qag.js";import"./index-BEHCTgo8.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-CDu_CIl5.js";import"./index-CTd4bIoJ.js";import"./index-5ADGgtek.js";import"./index-CwL9yoSU.js";import"./index-D4xnjFDX.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DbaMdrhi.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-CRRE-olZ.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-DnGaMf8w.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-DjDqRBUp.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-Cjx3XcOv.js";import"./index-ql53Efwg.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-DxqNVEr9.js";import"./index-BecHlYrv.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-B6rwY0dr.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CyzVB0Fa.js";const sa=ea({name:"CrmClueDetail",__name:"index",setup(ma){const l=s(0),_=s(!0),y=D(),{delView:L}=P(),{currentRoute:M}=F(),u=s(),o=s({}),v=async()=>{_.value=!0;try{o.value=await Q(l.value),await x()}finally{_.value=!1}},C=s(),S=()=>{var r;(r=C.value)==null||r.open("update",l.value)},z=s(),$=()=>{var r;(r=z.value)==null||r.open(l.value)},h=async()=>{await y.confirm(`\u786E\u5B9A\u5C06\u3010${o.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await V(l.value),y.success(`\u8F6C\u5316\u5BA2\u6237\u3010${o.value.name}\u3011\u6210\u529F`),await v()},k=s([]),x=async()=>{const r=await I({bizType:f.CRM_CLUE,bizId:l.value});k.value=r.list},b=()=>{L(a(M))},{params:w}=G();return ia(()=>{if(!w.id)return y.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void b();l.value=w.id,v()}),(r,t)=>{const p=X,n=Z,O=H,T=Y,A=aa,B=ra("hasPermi");return m(),ta(oa,null,[e(j,{clue:a(o),loading:a(_)},{default:i(()=>{var g,R,E;return[(g=a(u))!=null&&g.validateWrite?la((m(),d(p,{key:0,type:"primary",onClick:S},{default:i(()=>t[0]||(t[0]=[c(" \u7F16\u8F91 ")])),_:1})),[[B,["crm:clue:update"]]]):U("",!0),(R=a(u))!=null&&R.validateOwnerUser?(m(),d(p,{key:1,type:"primary",onClick:$},{default:i(()=>t[1]||(t[1]=[c(" \u8F6C\u79FB ")])),_:1})):U("",!0),(E=a(u))!=null&&E.validateOwnerUser&&!a(o).transformStatus?(m(),d(p,{key:2,type:"success",onClick:h},{default:i(()=>t[2]||(t[2]=[c(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")])),_:1})):(m(),d(p,{key:3,disabled:"",type:"success"},{default:i(()=>t[3]||(t[3]=[c("\u5DF2\u8F6C\u5316\u5BA2\u6237")])),_:1}))]}),_:1},8,["clue","loading"]),e(A,null,{default:i(()=>[e(T,null,{default:i(()=>[e(n,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[e(N,{"biz-id":a(l),"biz-type":a(f).CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u57FA\u672C\u4FE1\u606F"},{default:i(()=>[e(q,{clue:a(o)},null,8,["clue"])]),_:1}),e(n,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[e(J,{ref_key:"permissionListRef",ref:u,"biz-id":a(o).id,"biz-type":a(f).CRM_CLUE,"show-action":!0,onQuitTeam:b},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[e(O,{"log-list":a(k)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(W,{ref_key:"formRef",ref:C,onSuccess:v},null,512),e(K,{ref_key:"transferFormRef",ref:z,"biz-type":a(f).CRM_CLUE,onSuccess:b},null,8,["biz-type"])],64)}}});export{sa as default};
