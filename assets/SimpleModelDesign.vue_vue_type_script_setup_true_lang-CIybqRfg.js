import{_ as P}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{d as j}from"./index-C1TKk8vI.js";import{_ as F}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as G}from"./simple-process-designer-DWOFOAFc.js";import{g as z,a as L,N as R}from"./consts-D6_WKT2v.js";import{g as B}from"./index-j0g2sdlj.js";import{g as J}from"./index-BwT0n6gf.js";import{h as C}from"./tree-COGD3qag.js";import{g as H}from"./index-BtHQyrBm.js";import{g as Q}from"./index-B0Mya_PA.js";import{g as W}from"./index-CYJDvQdV.js";import{g as X}from"./index-CZiMqbPE.js";import{g as Y}from"./index-DbP8QQV-.js";import{B as Z}from"./constants-IYPHa1Ih.js";import{f as $,aj as ee}from"./form-designer-BpYekVAY.js";import{x as h,r as a,t,j as se,G as ae,u as l,y as i,z as I,E as O,J as te,O as D,F as f,K as re,C as oe,M as le,a4 as me,L as b,l as de,i as ie}from"./form-create-7GAbgMwl.js";const pe={class:"overflow-auto"},ue=h({name:"SimpleProcessDesigner",__name:"SimpleProcessDesigner",props:{modelId:{type:String,required:!1},modelKey:{type:String,required:!1},modelName:{type:String,required:!1},startUserIds:{type:Array,required:!1},startDeptIds:{type:Array,required:!1}},emits:["success"],setup(N,{expose:c,emit:y}){const v=y,m=N,e=ie("processData"),p=a(!1),u=a([]),_=a(20),S=a([]),E=a([]),w=a([]),g=a([]),T=a(),k=a([]);t("formFields",u),t("formType",_),t("roleList",S),t("postList",E),t("userList",w),t("deptList",g),t("userGroupList",k),t("deptTree",T),t("startUserIds",m.startUserIds),t("startDeptIds",m.startDeptIds),t("tasks",[]),t("processInstance",{}),j();const o=a();t("processNodeTree",o);const n=a(!1);let q=[];const U=async r=>{if(r)try{e.value=r,v("success",r)}catch{}};se(async()=>{try{if(p.value=!0,m.modelId){const r=await B(m.modelId);if(r&&(_.value=r.formType,_.value===Z.NORMAL&&r.formId)){const s=await J(r.formId);u.value=s==null?void 0:s.fields}}S.value=await H(),E.value=await W(),w.value=await X(),g.value=await Q(),T.value=C(g.value,"id"),k.value=await Y(),e.value?o.value=e==null?void 0:e.value:o.value||(o.value={name:"\u53D1\u8D77\u4EBA",type:L.START_USER_NODE,id:R.START_USER_NODE_ID,childNode:{id:R.END_EVENT_NODE_ID,name:"\u7ED3\u675F",type:L.END_EVENT_NODE}},U(o.value))}finally{p.value=!1}});const x=a();return c({}),(r,s)=>{const A=$,K=F,M=ee;return ae((i(),I("div",pe,[l(o)?(i(),O(G,{key:0,ref_key:"simpleProcessModelRef",ref:x,"flow-node":l(o),readonly:!1,onSave:U},null,8,["flow-node"])):te("",!0),D(K,{modelValue:l(n),"onUpdate:modelValue":s[1]||(s[1]=d=>de(n)?n.value=d:null),title:"\u4FDD\u5B58\u5931\u8D25",width:"400",fullscreen:!1},{footer:f(()=>[D(A,{type:"primary",onClick:s[0]||(s[0]=d=>n.value=!1)},{default:f(()=>s[2]||(s[2]=[re("\u77E5\u9053\u4E86")])),_:1})]),default:f(()=>[s[3]||(s[3]=oe("div",{class:"mb-2"},"\u4EE5\u4E0B\u8282\u70B9\u5185\u5BB9\u4E0D\u5B8C\u5584\uFF0C\u8BF7\u4FEE\u6539\u540E\u4FDD\u5B58",-1)),(i(!0),I(le,null,me(l(q),(d,V)=>(i(),I("div",{class:"mb-3 b-rounded-1 bg-gray-100 p-2 line-height-normal",key:V},b(d.name)+" : "+b(l(z).get(d.type)),1))),128))]),_:1},8,["modelValue"])])),[[M,l(p)]])}}}),ne=h({name:"SimpleModelDesign",__name:"SimpleModelDesign",props:{modelId:{},modelKey:{},modelName:{},startUserIds:{},startDeptIds:{}},emits:["success"],setup(N,{emit:c}){const y=c,v=a(),m=e=>{e&&y("success",e)};return(e,p)=>{const u=P;return i(),O(u,{bodyStyle:{padding:"20px 16px"}},{default:f(()=>[D(l(ue),{"model-id":e.modelId,"model-key":e.modelKey,"model-name":e.modelName,onSuccess:m,"start-user-ids":e.startUserIds,"start-dept-ids":e.startDeptIds,ref_key:"designerRef",ref:v},null,8,["model-id","model-key","model-name","start-user-ids","start-dept-ids"])]),_:1})}}});export{ne as _};
