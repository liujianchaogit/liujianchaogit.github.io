import{b as L,d as R,_ as S}from"./index-C1TKk8vI.js";import{_ as T}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{u as X,a as D}from"./index-DRr-K6jk.js";import{f as z}from"./formatTime-EbFUBcAO.js";import{f as A,k as H,ai as M,h as N,af as P,al as Q,a6 as W,am as Y,aj as Z}from"./form-designer-BpYekVAY.js";import{x as $,r as f,X as ee,y as t,E as n,F as e,O as s,u as l,K as m,G as I,L as g,J as ae,l as le}from"./form-create-7GAbgMwl.js";const re=$({name:"BrokerageUserUpdateForm",__name:"BrokerageUserUpdateForm",emits:["success"],setup(se,{expose:w,emit:V}){const{t:h}=L(),c=R(),i=f(!1),u=f(!1),r=f(),v=f(),x=ee({bindUserId:[{required:!0,message:"\u63A8\u5E7F\u5458\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});w({open:async o=>{B(),r.value.id=o.id,r.value.bindUserId=o.bindUserId,o.bindUserId&&await U(),i.value=!0}});const C=V,F=async()=>{if(!u.value&&v&&await v.value.validate())if(d.value){u.value=!0;try{await X(r.value),c.success(h("common.updateSuccess")),i.value=!1,C("success",!0)}finally{u.value=!1}}else c.error("\u8BF7\u5148\u67E5\u8BE2\u5E76\u786E\u8BA4\u63A8\u5E7F\u4EBA")},B=()=>{var o;r.value={id:void 0,bindUserId:void 0},(o=v.value)==null||o.resetFields(),d.value=void 0},d=f(),U=async()=>{r.value.bindUserId!=r.value.id?(u.value=!0,d.value=await D(r.value.bindUserId),d.value||c.warning("\u63A8\u5E7F\u5458\u4E0D\u5B58\u5728"),u.value=!1):c.error("\u4E0D\u80FD\u7ED1\u5B9A\u81EA\u5DF1\u4E3A\u63A8\u5E7F\u4EBA")};return(o,a)=>{const E=S,_=A,K=H,O=M,j=N,q=P,b=Q,k=W,G=Y,J=T,y=Z;return t(),n(J,{modelValue:l(i),"onUpdate:modelValue":a[2]||(a[2]=p=>le(i)?i.value=p:null),title:"\u4FEE\u6539\u4E0A\u7EA7\u63A8\u5E7F\u4EBA",width:"500"},{footer:e(()=>[s(_,{disabled:l(u),type:"primary",onClick:F},{default:e(()=>a[5]||(a[5]=[m("\u786E \u5B9A")])),_:1},8,["disabled"]),s(_,{onClick:a[1]||(a[1]=p=>i.value=!1)},{default:e(()=>a[6]||(a[6]=[m("\u53D6 \u6D88")])),_:1})]),default:e(()=>[I((t(),n(j,{ref_key:"formRef",ref:v,model:l(r),rules:l(x),"label-width":"80px"},{default:e(()=>[s(O,{label:"\u63A8\u5E7F\u4EBA",prop:"bindUserId"},{default:e(()=>[I((t(),n(K,{modelValue:l(r).bindUserId,"onUpdate:modelValue":a[0]||(a[0]=p=>l(r).bindUserId=p),placeholder:"\u8BF7\u8F93\u5165\u63A8\u5E7F\u5458\u7F16\u53F7"},{append:e(()=>[s(_,{onClick:U},{default:e(()=>[s(E,{icon:"ep:search",class:"mr-5px"})]),_:1})]),_:1},8,["modelValue"])),[[y,l(u)]])]),_:1})]),_:1},8,["model","rules"])),[[y,l(u)]]),l(d)?(t(),n(G,{key:0,column:1,border:""},{default:e(()=>[s(b,{label:"\u5934\u50CF"},{default:e(()=>[s(q,{src:l(d).avatar},null,8,["src"])]),_:1}),s(b,{label:"\u6635\u79F0"},{default:e(()=>[m(g(l(d).nickname),1)]),_:1}),s(b,{label:"\u63A8\u5E7F\u8D44\u683C"},{default:e(()=>[l(d).brokerageEnabled?(t(),n(k,{key:0},{default:e(()=>a[3]||(a[3]=[m("\u6709")])),_:1})):(t(),n(k,{key:1,type:"info"},{default:e(()=>a[4]||(a[4]=[m("\u65E0")])),_:1}))]),_:1}),s(b,{label:"\u6210\u4E3A\u63A8\u5E7F\u5458\u7684\u65F6\u95F4"},{default:e(()=>[m(g(l(z)(l(d).brokerageTime)),1)]),_:1})]),_:1})):ae("",!0)]),_:1},8,["modelValue"])}}});export{re as _};
