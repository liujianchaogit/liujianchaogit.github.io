import{_ as z}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{u as D,h as H,d as I,_ as T,c as U}from"./index-C1TKk8vI.js";import{u as W}from"./tagsView-C2oS-OQq.js";import{C as B}from"./constants-IYPHa1Ih.js";import{g as F,u as K,c as $}from"./index-BG3NVYKd.js";import{_ as q}from"./BasicInfo.vue_vue_type_script_setup_true_lang-CcwR-8GQ.js";import G from"./WorkflowDesign-DLbYyqC4.js";import{M as P}from"./index-BojwE7iS.js";import{A as Q}from"./constants-DawjRUyr.js";import{f as X}from"./form-designer-BpYekVAY.js";import{x as Y,r as o,j as Z,y as u,E as V,F as j,C as r,O as v,u as s,L as y,z as A,a4 as ee,H as E,M as ae,K as te,l as R,J,t as re}from"./form-create-7GAbgMwl.js";const se={class:"mx-auto"},le={class:"absolute top-0 left-0 right-0 h-50px bg-white border-bottom z-10 flex items-center px-20px"},oe={class:"w-200px flex items-center overflow-hidden"},ie=["title"],ne={class:"flex-1 flex items-center justify-center h-full"},ce={class:"w-400px flex items-center justify-between h-full"},ue=["onClick"],pe={class:"text-16px font-bold whitespace-nowrap"},de={class:"w-200px flex items-center justify-end gap-2"},fe={class:"mt-50px"},me={key:0,class:"mx-auto w-560px"},we=Y({__name:"index",setup(ve){const c=D(),{delView:h}=W(),b=H(),p=I(),g=o(),k=o(),d=async()=>{var a;await((a=g.value)==null?void 0:a.validate())},f=async()=>{var a;await((a=k.value)==null?void 0:a.validate())},l=o(-1),L=[{title:"\u57FA\u672C\u4FE1\u606F",validator:d},{title:"\u5DE5\u4F5C\u6D41\u8BBE\u8BA1",validator:f}],t=o({id:void 0,name:"",code:"",remark:"",graph:"",status:B.ENABLE}),_=o([]),m=o({});re("workflowData",m);const C=b.params.type,M=async()=>{try{await(async()=>{try{try{await d()}catch{throw l.value=0,new Error("\u8BF7\u5B8C\u5584\u57FA\u672C\u4FE1\u606F")}try{await f()}catch{throw l.value=1,new Error("\u8BF7\u5B8C\u5584\u5DE5\u4F5C\u6D41\u4FE1\u606F")}return!0}catch(e){throw e}})();const a={...t.value,graph:JSON.stringify(m.value)};C==="update"?await K(a):await $(a),p.success("\u4FDD\u5B58\u6210\u529F"),h(s(c.currentRoute)),await c.push({name:"AiWorkflow"})}catch(a){p.warning(a.message||"\u8BF7\u5B8C\u5584\u6240\u6709\u6B65\u9AA4\u7684\u5FC5\u586B\u4FE1\u606F")}},N=()=>{h(s(c.currentRoute)),c.push({name:"AiWorkflow"})};return Z(async()=>{await(async()=>{if(C==="update"){const e=b.params.id;t.value=await F(e),m.value=JSON.parse(t.value.graph)}const a=await P.getModelSimpleList(Q.CHAT);_.value={llm:()=>a.map(({id:e,name:w})=>({value:e,label:w})),knowledge:()=>[],internal:()=>[]},l.value=0})()}),(a,e)=>{const w=T,O=X,S=z;return u(),V(S,null,{default:j(()=>[r("div",se,[r("div",le,[r("div",oe,[v(w,{icon:"ep:arrow-left",class:"cursor-pointer flex-shrink-0",onClick:N}),r("span",{class:"ml-10px text-16px truncate",title:s(t).name||"\u521B\u5EFA\u6D41\u7A0B"},y(s(t).name||"\u521B\u5EFA\u6D41\u7A0B"),9,ie)]),r("div",ne,[r("div",ce,[(u(),A(ae,null,ee(L,(i,n)=>r("div",{key:n,class:E(["flex items-center cursor-pointer mx-15px relative h-full",[s(l)===n?"text-[#3473ff] border-[#3473ff] border-b-2 border-b-solid":"text-gray-500"]]),onClick:ye=>(async x=>{try{x!==0&&await d(),x!==1&&await f(),l.value=x}catch{p.warning("\u8BF7\u5148\u5B8C\u5584\u5F53\u524D\u6B65\u9AA4\u5FC5\u586B\u4FE1\u606F")}})(n)},[r("div",{class:E(["w-28px h-28px rounded-full flex items-center justify-center mr-8px border-2 border-solid text-15px",[s(l)===n?"bg-[#3473ff] text-white border-[#3473ff]":"border-gray-300 bg-white text-gray-500"]])},y(n+1),3),r("span",pe,y(i.title),1)],10,ue)),64))])]),r("div",de,[v(O,{type:"primary",onClick:M},{default:j(()=>e[2]||(e[2]=[te(" \u4FDD \u5B58 ")])),_:1})])]),r("div",fe,[s(l)===0?(u(),A("div",me,[v(q,{modelValue:s(t),"onUpdate:modelValue":e[0]||(e[0]=i=>R(t)?t.value=i:null),ref_key:"basicInfoRef",ref:g},null,8,["modelValue"])])):J("",!0),s(l)===1?(u(),V(G,{key:1,modelValue:s(t),"onUpdate:modelValue":e[1]||(e[1]=i=>R(t)?t.value=i:null),provider:s(_),ref_key:"workflowDesignRef",ref:k},null,8,["modelValue","provider"])):J("",!0)])])]),_:1})}}}),xe=U(we,[["__scopeId","data-v-e38ea3e7"]]);export{xe as default};
