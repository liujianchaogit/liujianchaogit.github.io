import{d as $,_ as A}from"./index-C1TKk8vI.js";import{_ as B}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as D}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as H}from"./index-BhsNgP9o.js";import{x as J,r as u,X as Q,j as W,aq as Y,y as i,z as w,O as a,F as l,u as o,a5 as K,K as p,G as I,E as m,M as j,a4 as Z,L as aa}from"./form-create-7GAbgMwl.js";import{d as ea}from"./formatTime-EbFUBcAO.js";import{a as la,s as ta}from"./index-DtRh1LY9.js";import{b as oa}from"./index-DSxIKWpQ.js";import{_ as ra}from"./main.vue_vue_type_script_setup_true_lang-CtGuAjr5.js";import{_ as sa}from"./UserForm.vue_vue_type_script_setup_true_lang-DGjb2_31.js";import{ai as ia,k as pa,f as na,h as ua,$ as ca,a6 as da,_ as ma,aj as fa}from"./form-designer-BpYekVAY.js";import"./index-KUcy92Cr.js";import"./tagsView-C2oS-OQq.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";const _a=J({name:"MpUser",__name:"index",setup(ga){const v=$(),y=u(!0),x=u(0),C=u([]),t=Q({pageNo:1,pageSize:10,accountId:-1,openid:"",nickname:""}),S=u(null),V=u([]),q=n=>{t.accountId=n,t.pageNo=1,c()},c=async()=>{try{y.value=!0;const n=await la(t);C.value=n.list,x.value=n.total}finally{y.value=!1}},f=()=>{t.pageNo=1,c()},M=()=>{var e;const n=t.accountId;(e=S.value)==null||e.resetFields(),t.accountId=n,f()},N=u(null),R=async()=>{try{await v.confirm("\u662F\u5426\u786E\u8BA4\u540C\u6B65\u7C89\u4E1D\uFF1F"),await ta(t.accountId),v.success("\u5F00\u59CB\u4ECE\u5FAE\u4FE1\u516C\u4F17\u53F7\u540C\u6B65\u7C89\u4E1D\u4FE1\u606F\uFF0C\u540C\u6B65\u9700\u8981\u4E00\u6BB5\u65F6\u95F4\uFF0C\u5EFA\u8BAE\u7A0D\u540E\u518D\u67E5\u8BE2"),await c()}catch{}};return W(async()=>{V.value=await oa()}),(n,e)=>{const E=H,_=ia,U=pa,k=A,g=na,G=ua,z=D,s=ca,h=da,L=ma,O=B,P=Y("hasPermi"),T=fa;return i(),w(j,null,[a(E,{title:"\u516C\u4F17\u53F7\u7C89\u4E1D",url:"https://doc.iocoder.cn/mp/user/"}),a(z,null,{default:l(()=>[a(G,{class:"-mb-15px",model:o(t),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"68px"},{default:l(()=>[a(_,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:l(()=>[a(o(ra),{onChange:q})]),_:1}),a(_,{label:"\u7528\u6237\u6807\u8BC6",prop:"openid"},{default:l(()=>[a(U,{modelValue:o(t).openid,"onUpdate:modelValue":e[0]||(e[0]=r=>o(t).openid=r),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6807\u8BC6",clearable:"",onKeyup:K(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(_,{label:"\u6635\u79F0",prop:"nickname"},{default:l(()=>[a(U,{modelValue:o(t).nickname,"onUpdate:modelValue":e[1]||(e[1]=r=>o(t).nickname=r),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",clearable:"",onKeyup:K(f,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(_,null,{default:l(()=>[a(g,{onClick:f},{default:l(()=>[a(k,{icon:"ep:search"}),e[4]||(e[4]=p("\u641C\u7D22 "))]),_:1}),a(g,{onClick:M},{default:l(()=>[a(k,{icon:"ep:refresh"}),e[5]||(e[5]=p("\u91CD\u7F6E "))]),_:1}),I((i(),m(g,{type:"success",plain:"",onClick:R,disabled:o(t).accountId===0},{default:l(()=>[a(k,{icon:"ep:refresh",class:"mr-5px"}),e[6]||(e[6]=p(" \u540C\u6B65 "))]),_:1},8,["disabled"])),[[P,["mp:user:sync"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(z,null,{default:l(()=>[I((i(),m(L,{data:o(C)},{default:l(()=>[a(s,{label:"\u7F16\u53F7",align:"center",prop:"id"}),a(s,{label:"\u7528\u6237\u6807\u8BC6",align:"center",prop:"openid",width:"260"}),a(s,{label:"\u6635\u79F0",align:"center",prop:"nickname"}),a(s,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),a(s,{label:"\u6807\u7B7E",align:"center",prop:"tagIds",width:"200"},{default:l(r=>[(i(!0),w(j,null,Z(r.row.tagIds,(F,b)=>(i(),w("span",{key:b},[a(h,null,{default:l(()=>{var d;return[p(aa((d=o(V).find(X=>X.tagId===F))==null?void 0:d.name),1)]}),_:2},1024),e[7]||(e[7]=p("\xA0 "))]))),128))]),_:1}),a(s,{label:"\u8BA2\u9605\u72B6\u6001",align:"center",prop:"subscribeStatus"},{default:l(r=>[r.row.subscribeStatus===0?(i(),m(h,{key:0,type:"success"},{default:l(()=>e[8]||(e[8]=[p("\u5DF2\u8BA2\u9605")])),_:1})):(i(),m(h,{key:1,type:"danger"},{default:l(()=>e[9]||(e[9]=[p("\u672A\u8BA2\u9605")])),_:1}))]),_:1}),a(s,{label:"\u8BA2\u9605\u65F6\u95F4",align:"center",prop:"subscribeTime",width:"180",formatter:o(ea)},null,8,["formatter"]),a(s,{label:"\u64CD\u4F5C",align:"center"},{default:l(r=>[I((i(),m(g,{type:"primary",link:"",onClick:F=>{var d;return b=r.row.id,void((d=N.value)==null?void 0:d.open(b));var b}},{default:l(()=>e[10]||(e[10]=[p(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[P,["mp:user:update"]]])]),_:1})]),_:1},8,["data"])),[[T,o(y)]]),a(O,{total:o(x),page:o(t).pageNo,"onUpdate:page":e[2]||(e[2]=r=>o(t).pageNo=r),limit:o(t).pageSize,"onUpdate:limit":e[3]||(e[3]=r=>o(t).pageSize=r),onPagination:c},null,8,["total","page","limit"])]),_:1}),a(sa,{ref_key:"formRef",ref:N,onSuccess:c},null,512)],64)}}});export{_a as default};
