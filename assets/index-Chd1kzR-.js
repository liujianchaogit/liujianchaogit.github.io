import{d as B,u as D,h as E}from"./index-C1TKk8vI.js";import{g as G,_ as J}from"./index-ArudIG2A.js";import{u as K}from"./tagsView-C2oS-OQq.js";import{a as L}from"./index-C_v5t3_7.js";import{_ as U}from"./ContactDetailsHeader.vue_vue_type_script_setup_true_lang-Cp9RCUL8.js";import{_ as V}from"./ContactDetailsInfo.vue_vue_type_script_setup_true_lang-Df9pUxK7.js";import{_ as W}from"./BusinessList.vue_vue_type_script_setup_true_lang-BCkwyL0t.js";import{_ as H}from"./PermissionList.vue_vue_type_script_setup_true_lang-BPeTlrGi.js";import{B as s}from"./index-BuK0ap75.js";import{_ as P}from"./ContactForm.vue_vue_type_script_setup_true_lang-DNhdDOrK.js";import{_ as Q}from"./TransferForm.vue_vue_type_script_setup_true_lang-5gdfxDt4.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-Cc1LpVql.js";import{f as X,a0 as Y,a1 as Z,j as $,aj as tt}from"./form-designer-BpYekVAY.js";import{x as at,r as e,j as it,y as u,z as rt,G as ot,u as t,E as c,F as i,K as O,J as g,O as a,M as et}from"./form-create-7GAbgMwl.js";import"./formatTime-EbFUBcAO.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import"./index-DLPyhh9r.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-C-tbO4kY.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-2SiQtehE.js";import"./index-Bdw660V1.js";import"./index-CZiMqbPE.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-w8Q4BfL1.js";import"./index-C69xrZfi.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-D8lenXv5.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-C_qKaUAE.js";import"./index-R1Ohxk4X.js";import"./tree-COGD3qag.js";import"./index-uXIyVRuV.js";import"./index-DdKGlDdM.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-De4klYft.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DrAuCfpX.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-B-IANjnk.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-Cgo1EbLC.js";const lt=at({name:"CrmContactDetail",__name:"index",setup(mt){const M=B(),p=e(0),n=e(!0),r=e({}),f=e(),_=async()=>{n.value=!0;try{r.value=await L(p.value),await A(p.value)}finally{n.value=!1}},y=e(),b=e(),N=()=>{var l;(l=b.value)==null||l.open(r.value.id)},C=e([]),A=async l=>{if(!l)return;const o=await G({bizType:s.CRM_CONTACT,bizId:l});C.value=o.list},{delView:x}=K(),{currentRoute:h}=D(),d=()=>{x(t(h))},{params:z}=E();return it(async()=>{if(!z.id)return M.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u8054\u7CFB\u4EBA\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void d();p.value=z.id,await _()}),(l,o)=>{const v=X,m=Y,j=J,F=Z,I=$,S=tt;return u(),rt(et,null,[ot((u(),c(U,{contact:t(r)},{default:i(()=>{var T,R;return[(T=t(f))!=null&&T.validateWrite?(u(),c(v,{key:0,onClick:o[0]||(o[0]=st=>{return w="update",k=t(r).id,void y.value.open(w,k);var w,k})},{default:i(()=>o[1]||(o[1]=[O(" \u7F16\u8F91 ")])),_:1})):g("",!0),(R=t(f))!=null&&R.validateOwnerUser?(u(),c(v,{key:1,type:"primary",onClick:N},{default:i(()=>o[2]||(o[2]=[O(" \u8F6C\u79FB ")])),_:1})):g("",!0)]}),_:1},8,["contact"])),[[S,t(n)]]),a(I,null,{default:i(()=>[a(F,null,{default:i(()=>[a(m,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[a(q,{"biz-id":t(p),"biz-type":t(s).CRM_CONTACT},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:i(()=>[a(V,{contact:t(r)},null,8,["contact"])]),_:1}),a(m,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[a(j,{"log-list":t(C)},null,8,["log-list"])]),_:1}),a(m,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[a(H,{ref_key:"permissionListRef",ref:f,"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"show-action":!0,onQuitTeam:d},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u5546\u673A",lazy:""},{default:i(()=>[a(W,{"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"contact-id":t(r).id,"customer-id":t(r).customerId},null,8,["biz-id","biz-type","contact-id","customer-id"])]),_:1})]),_:1})]),_:1}),a(P,{ref_key:"formRef",ref:y,onSuccess:_},null,512),a(Q,{ref_key:"transferFormRef",ref:b,"biz-type":t(s).CRM_CONTACT,onSuccess:d},null,8,["biz-type"])],64)}}});export{lt as default};
