import{a as Q,d as $,h as T,D as f,Y as w,az as X}from"./index-DiGvuAxb.js";import{_ as Z}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{V as D,a as S,D as K,P as O}from"./index-y2Iw13c9.js";import{P as ee}from"./index-BXHzVmip.js";import{h as le,ai as ae,k as de,f as oe,x as te,Q as ue,s as re,u as ie,aa as pe,ab as se,aj as ce}from"./form-designer-drfGvdgz.js";import{k as me,r as m,P as ne,y as i,m as u,z as o,A as ve,u as e,H as t,C as Y,E as v,l as y,G as b,$ as _,F as A,h as ye}from"./form-create-D7wT855o.js";const be=me({name:"IoTProductForm",__name:"ProductForm",emits:["success"],setup(_e,{expose:W,emit:G}){const{t:g}=Q(),F=$(),c=m(!1),x=m(""),n=m(!1),p=m(""),d=m({id:void 0,name:void 0,productKey:"",categoryId:void 0,icon:void 0,picUrl:void 0,description:void 0,deviceType:void 0,netType:void 0,protocolType:void 0,protocolId:void 0,dataFormat:S.JSON,validateType:D.WEAK}),R=ne({productKey:[{required:!0,message:"ProductKey \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deviceType:[{required:!0,message:"\u8BBE\u5907\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],netType:[{required:!0,message:"\u8054\u7F51\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],protocolType:[{required:!0,message:"\u63A5\u5165\u7F51\u5173\u534F\u8BAE\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],dataFormat:[{required:!0,message:"\u6570\u636E\u683C\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],validateType:[{required:!0,message:"\u6570\u636E\u6821\u9A8C\u7EA7\u522B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),V=m(),C=m([]);W({open:async(s,a)=>{if(c.value=!0,x.value=g("action."+s),p.value=s,z(),a){n.value=!0;try{d.value=await O.getProduct(a)}finally{n.value=!1}}else q();C.value=await ee.getSimpleProductCategoryList()},close:()=>c.value=!1});const L=G,N=async()=>{await V.value.validate(),n.value=!0;try{const s=d.value;p.value==="create"?(await O.createProduct(s),F.success(g("common.createSuccess"))):(await O.updateProduct(s),F.success(g("common.updateSuccess"))),c.value=!1,L("success")}finally{n.value=!1}},z=()=>{var s;d.value={id:void 0,name:void 0,productKey:"",categoryId:void 0,icon:void 0,picUrl:void 0,description:void 0,deviceType:void 0,netType:void 0,protocolType:void 0,protocolId:void 0,dataFormat:S.JSON,validateType:D.WEAK},(s=V.value)==null||s.resetFields()},q=()=>{d.value.productKey=X(16)};return(s,a)=>{const h=oe,U=de,r=ae,P=ue,I=te,E=ie,k=re,J=se,j=pe,B=le,H=Z,M=ce;return u(),i(H,{title:e(x),modelValue:e(c),"onUpdate:modelValue":a[12]||(a[12]=l=>ye(c)?c.value=l:null)},{footer:o(()=>[t(h,{onClick:N,type:"primary",disabled:e(n)},{default:o(()=>a[14]||(a[14]=[v("\u786E \u5B9A")])),_:1},8,["disabled"]),t(h,{onClick:a[11]||(a[11]=l=>c.value=!1)},{default:o(()=>a[15]||(a[15]=[v("\u53D6 \u6D88")])),_:1})]),default:o(()=>[ve((u(),i(B,{ref_key:"formRef",ref:V,model:e(d),rules:e(R),"label-width":"110px"},{default:o(()=>[t(r,{label:"ProductKey",prop:"productKey"},{default:o(()=>[t(U,{modelValue:e(d).productKey,"onUpdate:modelValue":a[0]||(a[0]=l=>e(d).productKey=l),placeholder:"\u8BF7\u8F93\u5165 ProductKey",readonly:e(p)==="update"},{append:o(()=>[t(h,{onClick:q,disabled:e(p)==="update"},{default:o(()=>a[13]||(a[13]=[v(" \u91CD\u65B0\u751F\u6210 ")])),_:1},8,["disabled"])]),_:1},8,["modelValue","readonly"])]),_:1}),t(r,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:o(()=>[t(U,{modelValue:e(d).name,"onUpdate:modelValue":a[1]||(a[1]=l=>e(d).name=l),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u4EA7\u54C1\u5206\u7C7B",prop:"categoryId"},{default:o(()=>[t(I,{modelValue:e(d).categoryId,"onUpdate:modelValue":a[2]||(a[2]=l=>e(d).categoryId=l),placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u5206\u7C7B",clearable:""},{default:o(()=>[(u(!0),y(b,null,_(e(C),l=>(u(),i(P,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"\u8BBE\u5907\u7C7B\u578B",prop:"deviceType"},{default:o(()=>[t(k,{modelValue:e(d).deviceType,"onUpdate:modelValue":a[3]||(a[3]=l=>e(d).deviceType=l),disabled:e(p)==="update"},{default:o(()=>[(u(!0),y(b,null,_(e(T)(e(f).IOT_PRODUCT_DEVICE_TYPE),l=>(u(),i(E,{key:l.value,label:l.value},{default:o(()=>[v(A(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),[e(K).DEVICE,e(K).GATEWAY].includes(e(d).deviceType)?(u(),i(r,{key:0,label:"\u8054\u7F51\u65B9\u5F0F",prop:"netType"},{default:o(()=>[t(I,{modelValue:e(d).netType,"onUpdate:modelValue":a[4]||(a[4]=l=>e(d).netType=l),placeholder:"\u8BF7\u9009\u62E9\u8054\u7F51\u65B9\u5F0F",disabled:e(p)==="update"},{default:o(()=>[(u(!0),y(b,null,_(e(T)(e(f).IOT_NET_TYPE),l=>(u(),i(P,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):Y("",!0),e(d).deviceType===e(K).GATEWAY_SUB?(u(),i(r,{key:1,label:"\u63A5\u5165\u7F51\u5173\u534F\u8BAE",prop:"protocolType"},{default:o(()=>[t(I,{modelValue:e(d).protocolType,"onUpdate:modelValue":a[5]||(a[5]=l=>e(d).protocolType=l),placeholder:"\u8BF7\u9009\u62E9\u63A5\u5165\u7F51\u5173\u534F\u8BAE",disabled:e(p)==="update"},{default:o(()=>[(u(!0),y(b,null,_(e(T)(e(f).IOT_PROTOCOL_TYPE),l=>(u(),i(P,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):Y("",!0),t(r,{label:"\u6570\u636E\u683C\u5F0F",prop:"dataFormat"},{default:o(()=>[t(k,{modelValue:e(d).dataFormat,"onUpdate:modelValue":a[6]||(a[6]=l=>e(d).dataFormat=l),disabled:e(p)==="update"},{default:o(()=>[(u(!0),y(b,null,_(e(T)(e(f).IOT_DATA_FORMAT),l=>(u(),i(E,{key:l.value,label:l.value},{default:o(()=>[v(A(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(r,{label:"\u6570\u636E\u6821\u9A8C\u7EA7\u522B",prop:"validateType"},{default:o(()=>[t(k,{modelValue:e(d).validateType,"onUpdate:modelValue":a[7]||(a[7]=l=>e(d).validateType=l),disabled:e(p)==="update"},{default:o(()=>[(u(!0),y(b,null,_(e(T)(e(f).IOT_VALIDATE_TYPE),l=>(u(),i(E,{key:l.value,label:l.value},{default:o(()=>[v(A(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(j,null,{default:o(()=>[t(J,{title:"\u66F4\u591A\u914D\u7F6E"},{default:o(()=>[t(r,{label:"\u4EA7\u54C1\u56FE\u6807",prop:"icon"},{default:o(()=>[t(e(w),{modelValue:e(d).icon,"onUpdate:modelValue":a[8]||(a[8]=l=>e(d).icon=l),height:"80px",width:"80px"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u4EA7\u54C1\u56FE\u7247",prop:"picUrl"},{default:o(()=>[t(e(w),{modelValue:e(d).picUrl,"onUpdate:modelValue":a[9]||(a[9]=l=>e(d).picUrl=l),height:"120px",width:"120px"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u4EA7\u54C1\u63CF\u8FF0",prop:"description"},{default:o(()=>[t(U,{type:"textarea",modelValue:e(d).description,"onUpdate:modelValue":a[10]||(a[10]=l=>e(d).description=l),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[M,e(n)]])]),_:1},8,["title","modelValue"])}}});export{be as _};
