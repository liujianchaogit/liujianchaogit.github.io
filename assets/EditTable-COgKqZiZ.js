import{b as x,d as T,u as q,h as F}from"./index-C1TKk8vI.js";import{_ as G}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{u as K}from"./tagsView-C2oS-OQq.js";import{_ as O}from"./BasicInfoForm.vue_vue_type_script_setup_true_lang-TJPsOdIy.js";import{_ as S}from"./ColumInfoForm.vue_vue_type_script_setup_true_lang-Burx5KZm.js";import{_ as U}from"./GenerateInfoForm.vue_vue_type_script_setup_true_lang-Gcm8EdNy.js";import{g as z,u as A}from"./index-D33AzDfi.js";import{a0 as B,a1 as W,f as D,ai as H,h as J,aj as L}from"./form-designer-BpYekVAY.js";import{x as M,r as u,j as N,G as P,u as a,y as Q,E as X,F as t,O as e,l as Y,K as p}from"./form-create-7GAbgMwl.js";import"./formRules-NkbEJCk0.js";import"./dict.type-C3NSXUg6.js";import"./tree-COGD3qag.js";import"./index-DvrIs0Uy.js";const Z=M({name:"InfraCodegenEditTable",__name:"EditTable",setup($){const{t:_}=x(),b=T(),{push:y,currentRoute:g}=q(),{query:v}=F(),{delView:I}=K(),r=u(!1),n=u("colum"),f=u(),h=u(),i=u(),o=u({table:{},columns:[]}),k=async()=>{var s,l;if(a(o)){await((s=a(f))==null?void 0:s.validate()),await((l=a(i))==null?void 0:l.validate());try{await A(o.value),b.success(_("common.updateSuccess")),c()}catch{}}},c=()=>{I(a(g)),y("/infra/codegen")};return N(()=>{(async()=>{const s=v.id;if(s){r.value=!0;try{o.value=await z(s)}finally{r.value=!1}}})()}),(s,l)=>{const m=B,w=W,d=D,V=H,R=J,j=G,C=L;return P((Q(),X(j,null,{default:t(()=>[e(w,{modelValue:a(n),"onUpdate:modelValue":l[0]||(l[0]=E=>Y(n)?n.value=E:null)},{default:t(()=>[e(m,{label:"\u57FA\u672C\u4FE1\u606F",name:"basicInfo"},{default:t(()=>[e(a(O),{ref_key:"basicInfoRef",ref:f,table:a(o).table},null,8,["table"])]),_:1}),e(m,{label:"\u5B57\u6BB5\u4FE1\u606F",name:"colum"},{default:t(()=>[e(a(S),{ref_key:"columInfoRef",ref:h,columns:a(o).columns},null,8,["columns"])]),_:1}),e(m,{label:"\u751F\u6210\u4FE1\u606F",name:"generateInfo"},{default:t(()=>[e(a(U),{ref_key:"generateInfoRef",ref:i,table:a(o).table,columns:a(o).columns},null,8,["table","columns"])]),_:1})]),_:1},8,["modelValue"]),e(R,null,{default:t(()=>[e(V,{style:{float:"right"}},{default:t(()=>[e(d,{loading:a(r),type:"primary",onClick:k},{default:t(()=>l[1]||(l[1]=[p("\u4FDD\u5B58")])),_:1},8,["loading"]),e(d,{onClick:c},{default:t(()=>l[2]||(l[2]=[p("\u8FD4\u56DE")])),_:1})]),_:1})]),_:1})]),_:1})),[[C,a(r)]])}}});export{Z as default};
