import{D as F}from"./index-C1TKk8vI.js";import{_ as T}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as W}from"./Echart.vue_vue_type_script_setup_true_lang-Bp4Tc-Mi.js";import{S as h}from"./funnel-DdUSY1jF.js";import{f as j,ap as q,ag as D,j as k,i as A,ad as I,$ as M,_ as N,aj as O}from"./form-designer-BpYekVAY.js";import{x as U,r as m,X as G,j as K,y as v,z as L,O as a,F as t,K as g,u as l,G as R,E as V,M as X}from"./form-create-7GAbgMwl.js";const Y=U({name:"FunnelBusiness",__name:"FunnelBusiness",props:{queryParams:{}},setup(S,{expose:w}){const d=S,p=m(!0),u=m(!1),f=m([]),n=G({title:{text:"\u9500\u552E\u6F0F\u6597"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}"},toolbox:{feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},legend:{data:["\u5BA2\u6237","\u5546\u673A","\u8D62\u5355"]},series:[{name:"\u9500\u552E\u6F0F\u6597",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",min:0,max:100,minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:[{value:60,name:"\u5BA2\u6237-0\u4E2A"},{value:40,name:"\u5546\u673A-0\u4E2A"},{value:20,name:"\u8D62\u5355-0\u4E2A"}]}]}),b=async s=>{p.value=s,await o()},o=async()=>{u.value=!0;const s=await h.getFunnelSummary(d.queryParams);if(s&&n.series&&n.series[0]&&n.series[0].data){const e=[];p.value?(e.push({value:60,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:40,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:20,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})):(e.push({value:s.customerCount||0,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:s.businessCount||0,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:s.businessWinCount||0,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})),n.series[0].data=e}f.value=await h.getBusinessSummaryByEndStatus(d.queryParams),u.value=!1};return w({loadData:o}),K(()=>{o()}),(s,e)=>{const c=j,C=q,_=W,x=D,$=k,B=A,y=I,i=M,E=T,P=N,z=O;return v(),L(X,null,[a(y,{shadow:"never"},{default:t(()=>[a(B,null,{default:t(()=>[a($,{span:24},{default:t(()=>[a(C,{class:"mb-10px"},{default:t(()=>[a(c,{type:"primary",onClick:e[0]||(e[0]=r=>b(!0))},{default:t(()=>e[2]||(e[2]=[g("\u5BA2\u6237\u89C6\u89D2")])),_:1}),a(c,{type:"primary",onClick:e[1]||(e[1]=r=>b(!1))},{default:t(()=>e[3]||(e[3]=[g("\u52A8\u6001\u89C6\u89D2")])),_:1})]),_:1}),a(x,{loading:l(u),animated:""},{default:t(()=>[a(_,{height:500,options:l(n)},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(y,{class:"mt-16px",shadow:"never"},{default:t(()=>[R((v(),V(P,{data:l(f)},{default:t(()=>[a(i,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),a(i,{align:"center",label:"\u9636\u6BB5",prop:"endStatus",width:"200"},{default:t(r=>[a(E,{type:l(F).CRM_BUSINESS_END_STATUS_TYPE,value:r.row.endStatus},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5546\u673A\u6570","min-width":"200",prop:"businessCount"}),a(i,{align:"center",label:"\u5546\u673A\u603B\u91D1\u989D(\u5143)","min-width":"200",prop:"totalPrice"})]),_:1},8,["data"])),[[z,l(u)]])]),_:1})],64)}}});export{Y as _};
