import{d as le,b as te,u as re,au as F,D as K,_ as oe}from"./index-C1TKk8vI.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as ne}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as ce}from"./index-BhsNgP9o.js";import{x as se,r as m,X as de,j as me,aq as ue,y as c,z as M,O as e,F as t,u as r,a5 as j,M as B,a4 as fe,E as u,K as p,G as f,l as we,L as S}from"./form-create-7GAbgMwl.js";import{b as ye,d as L}from"./formatTime-EbFUBcAO.js";import{d as _e}from"./download-oWiM5xVU.js";import{b as be,d as ve,s as ge,f as he}from"./index-pmRUIUos.js";import{_ as ke}from"./ReceivableForm.vue_vue_type_script_setup_true_lang-CpUQxp4U.js";import{a as Ce}from"./index-Bdw660V1.js";import{k as xe,ai as Te,Q as Ne,x as Ie,f as Se,h as Ue,a0 as Ve,a1 as Re,P as De,$ as Ee,_ as Pe,aj as ze}from"./form-designer-BpYekVAY.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-DZT3uREC.js";import"./index-CZiMqbPE.js";import"./index-DdKGlDdM.js";const qe=se({name:"Receivable",__name:"index",setup(Ae){const b=le(),{t:X}=te(),k=m(!0),U=m(0),V=m([]),n=de({pageNo:1,pageSize:10,sceneType:"1",no:void 0,customerId:void 0}),R=m(),C=m(!1),x=m("1"),D=m([]),$=s=>{n.sceneType=s.paneName,v()},w=async()=>{k.value=!0;try{const s=await be(n);V.value=s.list,U.value=s.total}finally{k.value=!1}},v=()=>{n.pageNo=1,w()},G=()=>{R.value.resetFields(),v()},E=m(),P=(s,l)=>{E.value.open(s,l)},{push:g}=re(),O=async()=>{try{await b.exportConfirm(),C.value=!0;const s=await he(n);_e.excel(s,"\u56DE\u6B3E.xls")}catch{}finally{C.value=!1}};return me(async()=>{await w(),D.value=await Ce()}),(s,l)=>{const z=ce,Q=xe,T=Te,Y=Ne,H=Ie,h=oe,d=Se,J=Ue,q=pe,N=Ve,W=Re,I=De,i=Ee,A=ne,Z=Pe,ee=ie,y=ue("hasPermi"),ae=ze;return c(),M(B,null,[e(z,{title:"\u3010\u56DE\u6B3E\u3011\u56DE\u6B3E\u7BA1\u7406\u3001\u56DE\u6B3E\u8BA1\u5212",url:"https://doc.iocoder.cn/crm/receivable/"}),e(z,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(q,null,{default:t(()=>[e(J,{ref_key:"queryFormRef",ref:R,inline:!0,model:r(n),class:"-mb-15px","label-width":"68px"},{default:t(()=>[e(T,{label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no"},{default:t(()=>[e(Q,{modelValue:r(n).no,"onUpdate:modelValue":l[0]||(l[0]=a=>r(n).no=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u56DE\u6B3E\u7F16\u53F7",onKeyup:j(v,["enter"])},null,8,["modelValue"])]),_:1}),e(T,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:t(()=>[e(H,{modelValue:r(n).customerId,"onUpdate:modelValue":l[1]||(l[1]=a=>r(n).customerId=a),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onKeyup:j(v,["enter"])},{default:t(()=>[(c(!0),M(B,null,fe(r(D),a=>(c(),u(Y,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(T,null,{default:t(()=>[e(d,{onClick:v},{default:t(()=>[e(h,{class:"mr-5px",icon:"ep:search"}),l[6]||(l[6]=p(" \u641C\u7D22 "))]),_:1}),e(d,{onClick:G},{default:t(()=>[e(h,{class:"mr-5px",icon:"ep:refresh"}),l[7]||(l[7]=p(" \u91CD\u7F6E "))]),_:1}),f((c(),u(d,{plain:"",type:"primary",onClick:l[2]||(l[2]=a=>P("create"))},{default:t(()=>[e(h,{class:"mr-5px",icon:"ep:plus"}),l[8]||(l[8]=p(" \u65B0\u589E "))]),_:1})),[[y,["crm:receivable:create"]]]),f((c(),u(d,{loading:r(C),plain:"",type:"success",onClick:O},{default:t(()=>[e(h,{class:"mr-5px",icon:"ep:download"}),l[9]||(l[9]=p(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[y,["crm:receivable:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(q,null,{default:t(()=>[e(W,{modelValue:r(x),"onUpdate:modelValue":l[3]||(l[3]=a=>we(x)?x.value=a:null),onTabClick:$},{default:t(()=>[e(N,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(N,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(N,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),f((c(),u(Z,{data:r(V),"show-overflow-tooltip":!0,stripe:!0},{default:t(()=>[e(i,{align:"center",fixed:"left",label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no",width:"180"},{default:t(a=>[e(I,{underline:!1,type:"primary",onClick:_=>{return o=a.row.id,void g({name:"CrmReceivableDetail",params:{id:o}});var o}},{default:t(()=>[p(S(a.row.no),1)]),_:2},1032,["onClick"])]),_:1}),e(i,{align:"center",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"120"},{default:t(a=>[e(I,{underline:!1,type:"primary",onClick:_=>{return o=a.row.customerId,void g({name:"CrmCustomerDetail",params:{id:o}});var o}},{default:t(()=>[p(S(a.row.customerName),1)]),_:2},1032,["onClick"])]),_:1}),e(i,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"180"},{default:t(a=>[e(I,{underline:!1,type:"primary",onClick:_=>{return o=a.row.contractId,void g({name:"CrmContractDetail",params:{id:o}});var o}},{default:t(()=>[p(S(a.row.contract.no),1)]),_:2},1032,["onClick"])]),_:1}),e(i,{formatter:r(ye),align:"center",label:"\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"150px"},null,8,["formatter"]),e(i,{align:"center",label:"\u56DE\u6B3E\u91D1\u989D(\u5143)",prop:"price",width:"140",formatter:r(F)},null,8,["formatter"]),e(i,{align:"center",label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType",width:"130px"},{default:t(a=>[e(A,{type:r(K).CRM_RECEIVABLE_RETURN_TYPE,value:a.row.returnType},null,8,["type","value"])]),_:1}),e(i,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(i,{align:"center",label:"\u5408\u540C\u91D1\u989D\uFF08\u5143\uFF09",prop:"contract.totalPrice",width:"140",formatter:r(F)},null,8,["formatter"]),e(i,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),e(i,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100px"}),e(i,{formatter:r(L),align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(i,{formatter:r(L),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(i,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"120"}),e(i,{align:"center",fixed:"right",label:"\u56DE\u6B3E\u72B6\u6001",prop:"auditStatus",width:"120"},{default:t(a=>[e(A,{type:r(K).CRM_AUDIT_STATUS,value:a.row.auditStatus},null,8,["type","value"])]),_:1}),e(i,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"180px"},{default:t(a=>[f((c(),u(d,{link:"",type:"primary",onClick:_=>P("update",a.row.id)},{default:t(()=>l[10]||(l[10]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[y,["crm:receivable:update"]]]),a.row.auditStatus===0?f((c(),u(d,{key:0,link:"",type:"primary",onClick:_=>(async o=>{await b.confirm(`\u60A8\u786E\u5B9A\u63D0\u4EA4\u7F16\u53F7\u4E3A\u3010${o.no}\u3011\u7684\u56DE\u6B3E\u5BA1\u6838\u5417\uFF1F`),await ge(o.id),b.success("\u63D0\u4EA4\u5BA1\u6838\u6210\u529F\uFF01"),await w()})(a.row)},{default:t(()=>l[11]||(l[11]=[p(" \u63D0\u4EA4\u5BA1\u6838 ")])),_:2},1032,["onClick"])),[[y,["crm:receivable:update"]]]):f((c(),u(d,{key:1,link:"",type:"primary",onClick:_=>{return o=a.row,void g({name:"BpmProcessInstanceDetail",query:{id:o.processInstanceId}});var o}},{default:t(()=>l[12]||(l[12]=[p(" \u67E5\u770B\u5BA1\u6279 ")])),_:2},1032,["onClick"])),[[y,["crm:receivable:update"]]]),f((c(),u(d,{link:"",type:"danger",onClick:_=>(async o=>{try{await b.delConfirm(),await ve(o),b.success(X("common.delSuccess")),await w()}catch{}})(a.row.id)},{default:t(()=>l[13]||(l[13]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[y,["crm:receivable:delete"]]])]),_:1})]),_:1},8,["data"])),[[ae,r(k)]]),e(ee,{limit:r(n).pageSize,"onUpdate:limit":l[4]||(l[4]=a=>r(n).pageSize=a),page:r(n).pageNo,"onUpdate:page":l[5]||(l[5]=a=>r(n).pageNo=a),total:r(U),onPagination:w},null,8,["limit","page","total"])]),_:1}),e(ke,{ref_key:"formRef",ref:E,onSuccess:w},null,512)],64)}}});export{qe as default};
