import{d as L,aD as S,b as F,c as J}from"./index-DiGvuAxb.js";import{f as B}from"./formatTime-DeTj2b0K.js";import{M as K}from"./index-CY7R6inO.js";import{H as P}from"./index-brTT8YwK.js";import{k as R,r as b,c as z,e as $,l as v,m as d,u as n,a3 as Q,v as s,C as u,G as q,$ as X,H as a,z as o,E as I,F as T,y as O,n as Z}from"./form-create-D7wT855o.js";import{_ as s2}from"./MessageKnowledge.vue_vue_type_script_setup_true_lang-BorCE8gD.js";import{ag as e2,a6 as a2,f as t2,b as c2,aR as l2,aS as i2,aT as n2}from"./form-designer-drfGvdgz.js";import{C as o2}from"./index-D7arh0zA.js";import{a as r2}from"./avatar-BG6NdH5s.js";import{r as d2}from"./gpt-WhTktY3S.js";import"./fetch-D5K_4anA.js";const j="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715352878351'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1499'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M624.5%20786.3c92.9%200%20168.2-75.3%20168.2-168.2V309c0-92.4-75.3-168.2-168.2-168.2H303.6c-92.4%200-168.2%2075.3-168.2%20168.2v309.1c0%2092.4%2075.3%20168.2%20168.2%20168.2h320.9zM178.2%20618.1V309c0-69.4%2056.1-125.5%20125.5-125.5h320.9c69.4%200%20125.5%2056.1%20125.5%20125.5v309.1c0%2069.4-56.1%20125.5-125.5%20125.5h-321c-69.4%200-125.4-56.1-125.4-125.5z'%20p-id='1500'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M849.8%20295.1v361.5c0%20102.7-83.6%20186.3-186.3%20186.3H279.1v42.7h384.4c126.3%200%20229.1-102.8%20229.1-229.1V295.1h-42.8zM307.9%20361.8h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4zM307.9%20484.6h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4z'%20p-id='1501'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M620.2%20607.4c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.8%209.6%2021.4%2021.4%2021.4h312.3z'%20p-id='1502'%20fill='%238a8a8a'%3e%3c/path%3e%3c/svg%3e",A="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715354120346'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3256'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M907.1%20263.7H118.9c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4H907c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3257'%3e%3c/path%3e%3cpath%20d='M772.5%20928.3H257.4c-27.7%200-50.2-22.5-50.2-50.2V247.2c0-9.1%207.3-16.4%2016.4-16.4H801c12.1%200%2021.9%209.8%2021.9%2021.9v625.2c0%2027.8-22.6%2050.4-50.4%2050.4zM240%20263.7v614.4c0%209.6%207.8%2017.4%2017.4%2017.4h515.2c9.7%200%2017.5-7.9%2017.5-17.5V263.7H240zM657.4%20131.1H368.6c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4h288.7c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3258'%3e%3c/path%3e%3cpath%20d='M416%20754.5c-9.1%200-16.4-7.3-16.4-16.4V517.8c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0.1%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20p-id='3259'%3e%3c/path%3e%3cpath%20d='M416%20465.2c-9.1%200-16.4-7.3-16.4-16.4v-59.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v59.4c0.1%209.1-7.3%2016.4-16.4%2016.4zM604.9%20754.5c-9.1%200-16.4-7.3-16.4-16.4v-67.2c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20opacity='.4'%20p-id='3260'%3e%3c/path%3e%3cpath%20d='M604.9%20619.1c-9.1%200-16.4-7.3-16.4-16.4V389.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v213.3c0%209.1-7.3%2016.4-16.4%2016.4z'%20fill='%238a8a8a'%20p-id='3261'%3e%3c/path%3e%3c/svg%3e",p2=["innerHTML"],v2=R({__name:"index",props:{content:{type:String,required:!0}},setup(y){const x=y,C=L(),{copy:g}=S(),f=b(),H=new K({highlight:function(l,r){if(r&&P.getLanguage(r))try{return`<pre style="position: relative;">${`<div id="copy" data-copy='${l}' style="position: absolute; right: 10px; top: 5px; color: #fff;cursor: pointer;">\u590D\u5236</div>`}<code class="hljs">${P.highlight(r,l,!0).value}</code></pre>`}catch{}return""}}),c=z(()=>H.render(x.content));return $(async()=>{f.value.addEventListener("click",l=>{var r,h;l.target.id==="copy"&&(g((h=(r=l.target)==null?void 0:r.dataset)==null?void 0:h.copy),C.success("\u590D\u5236\u6210\u529F!"))})}),(l,r)=>(d(),v("div",{ref_key:"contentRef",ref:f,class:"markdown-view",innerHTML:n(c)},null,8,p2))}}),h2={key:0,class:"left-message message-item"},m2={class:"avatar"},u2={class:"message"},g2={class:"left-btns"},f2={key:1,class:"right-message message-item"},w2={class:"avatar"},k2={class:"message"},y2={class:"right-text-container"},x2={class:"right-text"},C2={class:"right-btns"},H2=J(R({__name:"MessageList",props:{conversation:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["onDeleteSuccess","onRefresh","onEdit"],setup(y,{expose:x,emit:C}){const g=L(),{copy:f}=S(),H=F(),c=b(null),l=b(!1),r=z(()=>H.user.avatar||r2),h=z(()=>V.conversation.roleAvatar??d2),V=y,{list:N}=Q(V),_=C;function U(){const t=c.value,i=t.scrollTop,w=t.scrollHeight,k=t.offsetHeight;l.value=i+k<w-100}const W=async()=>{const t=c.value;t.scrollTop=t.scrollHeight};x({scrollToBottom:async t=>{await Z(),!t&&l.value||(c.value.scrollTop=c.value.scrollHeight-c.value.offsetHeight)},handlerGoTop:async()=>{c.value.scrollTop=0}});const D=async t=>{await f(t),g.success("\u590D\u5236\u6210\u529F\uFF01")},E=async t=>{await o2.deleteChatMessage(t),g.success("\u5220\u9664\u6210\u529F\uFF01"),_("onDeleteSuccess")};return $(async()=>{c.value.addEventListener("scroll",U)}),(t,i)=>{const w=e2,k=a2,p=t2,G=c2;return d(),v(q,null,[s("div",{ref_key:"messageContainer",ref:c,class:"h-100% overflow-y-auto relative"},[(d(!0),v(q,null,X(n(N),(e,Y)=>(d(),v("div",{class:"chat-list",key:Y},[e.type!=="user"?(d(),v("div",h2,[s("div",m2,[a(w,{src:n(h)},null,8,["src"])]),s("div",u2,[s("div",null,[a(k,{class:"time"},{default:o(()=>[I(T(n(B)(e.createTime)),1)]),_:2},1024)]),s("div",{class:"left-text-container",ref_for:!0,ref:"markdownViewRef"},[a(v2,{class:"left-text",content:e.content},null,8,["content"]),e.segments?(d(),O(s2,{key:0,segments:e.segments},null,8,["segments"])):u("",!0)],512),s("div",g2,[a(p,{class:"btn-cus",link:"",onClick:m=>D(e.content)},{default:o(()=>i[0]||(i[0]=[s("img",{class:"btn-image",src:j},null,-1)])),_:2},1032,["onClick"]),e.id>0?(d(),O(p,{key:0,class:"btn-cus",link:"",onClick:m=>E(e.id)},{default:o(()=>i[1]||(i[1]=[s("img",{class:"btn-image h-17px",src:A},null,-1)])),_:2},1032,["onClick"])):u("",!0)])])])):u("",!0),e.type==="user"?(d(),v("div",f2,[s("div",w2,[a(w,{src:n(r)},null,8,["src"])]),s("div",k2,[s("div",null,[a(k,{class:"time"},{default:o(()=>[I(T(n(B)(e.createTime)),1)]),_:2},1024)]),s("div",y2,[s("div",x2,T(e.content),1)]),s("div",C2,[a(p,{class:"btn-cus",link:"",onClick:m=>D(e.content)},{default:o(()=>i[2]||(i[2]=[s("img",{class:"btn-image",src:j},null,-1)])),_:2},1032,["onClick"]),a(p,{class:"btn-cus",link:"",onClick:m=>E(e.id)},{default:o(()=>i[3]||(i[3]=[s("img",{class:"btn-image h-17px mr-12px",src:A},null,-1)])),_:2},1032,["onClick"]),a(p,{class:"btn-cus",link:"",onClick:m=>(async M=>{_("onRefresh",M)})(e)},{default:o(()=>[a(G,{size:"17"},{default:o(()=>[a(n(l2))]),_:1})]),_:2},1032,["onClick"]),a(p,{class:"btn-cus",link:"",onClick:m=>(async M=>{_("onEdit",M)})(e)},{default:o(()=>[a(G,{size:"17"},{default:o(()=>[a(n(i2))]),_:1})]),_:2},1032,["onClick"])])])])):u("",!0)]))),128))],512),n(l)?(d(),v("div",{key:0,class:"to-bottom",onClick:W},[a(p,{icon:n(n2),circle:""},null,8,["icon"])])):u("",!0)],64)}}}),[["__scopeId","data-v-8e92d594"]]);export{H2 as default};
