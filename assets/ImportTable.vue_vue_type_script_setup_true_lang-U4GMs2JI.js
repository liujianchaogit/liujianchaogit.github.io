import{d as N,_ as O}from"./index-C1TKk8vI.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{x as X,r as d,X as $,y as v,E as y,F as o,O as a,u as l,K as _,z as A,M as B,a4 as D,a5 as V,G as H,l as L}from"./form-create-7GAbgMwl.js";import{b as P,c as W}from"./index-D33AzDfi.js";import{g as Y}from"./index-D_bvs3YU.js";import{_ as Z,Q as ee,x as ae,ai as le,k as oe,f as te,h as se,$ as de,i as ne,aj as ue}from"./form-designer-BpYekVAY.js";const re=X({name:"InfraCodegenImportTable",__name:"ImportTable",emits:["success"],setup(me,{expose:I,emit:S}){const k=N(),u=d(!1),n=d(!0),b=d([]),t=$({name:void 0,comment:void 0,dataSourceConfigId:0}),K=d(),m=d([]),r=async()=>{n.value=!0;try{b.value=await P(t)}finally{n.value=!1}},R=async()=>{t.name=void 0,t.comment=void 0,t.dataSourceConfigId=m.value[0].id,await r()};I({open:async()=>{m.value=await Y(),t.dataSourceConfigId=m.value[0].id,u.value=!0,await r()}});const g=()=>{u.value=!1,i.value=[]},h=d(),i=d([]),U=c=>{var e;(e=l(h))==null||e.toggleRowSelection(c)},F=c=>{i.value=c.map(e=>e.name)},T=async()=>{n.value=!0;try{await W({dataSourceConfigId:t.dataSourceConfigId,tableNames:i.value}),k.success("\u5BFC\u5165\u6210\u529F"),j("success"),g()}finally{n.value=!1}},j=S;return(c,e)=>{const q=ee,z=ae,p=le,C=oe,x=O,f=te,E=se,w=de,G=ne,J=Q,M=ue;return v(),y(J,{modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=s=>L(u)?u.value=s:null),title:"\u5BFC\u5165\u8868",width:"800px"},{footer:o(()=>[a(f,{disabled:l(i).length===0||l(n),type:"primary",onClick:T},{default:o(()=>e[6]||(e[6]=[_(" \u5BFC\u5165 ")])),_:1},8,["disabled"]),a(f,{onClick:g},{default:o(()=>e[7]||(e[7]=[_("\u5173\u95ED")])),_:1})]),default:o(()=>[a(E,{ref_key:"queryFormRef",ref:K,inline:!0,model:l(t),"label-width":"68px"},{default:o(()=>[a(p,{label:"\u6570\u636E\u6E90",prop:"dataSourceConfigId"},{default:o(()=>[a(z,{modelValue:l(t).dataSourceConfigId,"onUpdate:modelValue":e[0]||(e[0]=s=>l(t).dataSourceConfigId=s),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"},{default:o(()=>[(v(!0),A(B,null,D(l(m),s=>(v(),y(q,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u540D\u79F0",prop:"name"},{default:o(()=>[a(C,{modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=s=>l(t).name=s),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",onKeyup:V(r,["enter"])},null,8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u63CF\u8FF0",prop:"comment"},{default:o(()=>[a(C,{modelValue:l(t).comment,"onUpdate:modelValue":e[2]||(e[2]=s=>l(t).comment=s),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",onKeyup:V(r,["enter"])},null,8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(f,{onClick:r},{default:o(()=>[a(x,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=_(" \u641C\u7D22 "))]),_:1}),a(f,{onClick:R},{default:o(()=>[a(x,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=_(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"]),a(G,null,{default:o(()=>[H((v(),y(l(Z),{ref_key:"tableRef",ref:h,data:l(b),height:"260px",onRowClick:U,onSelectionChange:F},{default:o(()=>[a(w,{type:"selection",width:"55"}),a(w,{"show-overflow-tooltip":!0,label:"\u8868\u540D\u79F0",prop:"name"}),a(w,{"show-overflow-tooltip":!0,label:"\u8868\u63CF\u8FF0",prop:"comment"})]),_:1},8,["data"])),[[M,l(n)]])]),_:1})]),_:1},8,["modelValue"])}}});export{re as _};
