import{d as G,a as H,u as W,_ as Y,D as Z}from"./index-DiGvuAxb.js";import{_ as q}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as K}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{d as I}from"./formatTime-DeTj2b0K.js";import{_ as Q,F as U}from"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DbaMdrhi.js";import{B as M}from"./index-BbXovwRQ.js";import{i as V,f as X,aj as ee,_ as ae,P as te,Z as le}from"./form-designer-drfGvdgz.js";import{k as ie,r as f,P as oe,b as re,l as g,m as n,G as z,H as e,z as l,E as y,A as se,u as a,y as c,C as S,$ as F,F as P}from"./form-create-D7wT855o.js";const ne=ie({name:"FollowUpRecord",__name:"index",props:{bizType:{},bizId:{}},setup(h){const m=h,C=G(),{t:E}=H(),_=f(!0),k=f([]),w=f(0),p=oe({pageNo:1,pageSize:10,bizType:0,bizId:0}),u=async()=>{_.value=!0;try{const i=await U.getFollowUpRecordPage(p);k.value=i.list,w.value=i.total}finally{_.value=!1}},v=f(),N=()=>{var i;(i=v.value)==null||i.open(m.bizType,m.bizId)},{push:T}=W();return re(()=>m.bizId,()=>{p.bizType=m.bizType,p.bizId=m.bizId,u()}),(i,o)=>{const O=Y,x=X,D=V,r=ae,$=K,R=te,j=le,B=J,L=q,A=ee;return n(),g(z,null,[e(D,{class:"mb-10px",justify:"end"},{default:l(()=>[e(x,{onClick:N},{default:l(()=>[e(O,{class:"mr-5px",icon:"ep:edit"}),o[2]||(o[2]=y(" \u5199\u8DDF\u8FDB "))]),_:1})]),_:1}),e(L,null,{default:l(()=>[se((n(),c(j,{data:a(k),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(r,{formatter:a(I),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"\u8DDF\u8FDB\u4EBA",prop:"creatorName"}),e(r,{align:"center",label:"\u8DDF\u8FDB\u7C7B\u578B",prop:"type"},{default:l(t=>[e($,{type:a(Z).CRM_FOLLOW_UP_TYPE,value:t.row.type},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u8DDF\u8FDB\u5185\u5BB9",prop:"content"}),e(r,{formatter:a(I),align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"nextTime",width:"180px"},null,8,["formatter"]),i.bizType===a(M).CRM_CUSTOMER?(n(),c(r,{key:0,align:"center",label:"\u5173\u8054\u8054\u7CFB\u4EBA",prop:"contactIds"},{default:l(t=>[(n(!0),g(z,null,F(t.row.contacts,s=>(n(),c(R,{key:`key-${s.id}`,underline:!1,type:"primary",onClick:b=>{return d=s.id,void T({name:"CrmContactDetail",params:{id:d}});var d},class:"ml-5px"},{default:l(()=>[y(P(s.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})):S("",!0),i.bizType===a(M).CRM_CUSTOMER?(n(),c(r,{key:1,align:"center",label:"\u5173\u8054\u5546\u673A",prop:"businessIds"},{default:l(t=>[(n(!0),g(z,null,F(t.row.businesses,s=>(n(),c(R,{key:`key-${s.id}`,underline:!1,type:"primary",onClick:b=>{return d=s.id,void T({name:"CrmBusinessDetail",params:{id:d}});var d},class:"ml-5px"},{default:l(()=>[y(P(s.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})):S("",!0),e(r,{align:"center",label:"\u64CD\u4F5C"},{default:l(t=>[e(x,{link:"",type:"danger",onClick:s=>(async b=>{try{await C.delConfirm(),await U.deleteFollowUpRecord(b),C.success(E("common.delSuccess")),await u()}catch{}})(t.row.id)},{default:l(()=>o[3]||(o[3]=[y(" \u5220\u9664 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,a(_)]]),e(B,{limit:a(p).pageSize,"onUpdate:limit":o[0]||(o[0]=t=>a(p).pageSize=t),page:a(p).pageNo,"onUpdate:page":o[1]||(o[1]=t=>a(p).pageNo=t),total:a(w),onPagination:u},null,8,["limit","page","total"])]),_:1}),e(Q,{ref_key:"formRef",ref:v,onSuccess:u},null,512)],64)}}});export{ne as _};
