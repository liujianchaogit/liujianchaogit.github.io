import{d as G}from"./index-C1TKk8vI.js";import{_ as J}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{T as M}from"./index-BGHavkVr.js";import{a as y,D as L}from"./index-DR2HTwYi.js";import{_ as S}from"./DeviceDetailsLog.vue_vue_type_script_setup_true_lang-DZ-4wprx.js";import{g as X}from"./config-6hyG0uwh.js";import{_ as q}from"./DataDefinition.vue_vue_type_script_setup_true_lang-BTvsCRFS.js";import{$ as z,k as A,_ as W,f as B,a0 as H,a1 as P,j as Q,i as R,aj as Y}from"./form-designer-BpYekVAY.js";import{x as Z,r as _,X as ee,c as ae,f as le,j as te,y as v,E as b,F as l,O as e,u as d,l as D,G as re,K as V,L as de,C as x,J as O}from"./form-create-7GAbgMwl.js";const ue={class:"mt-10px"},oe={class:"flex gap-4"},se=Z({__name:"DeviceDetailsSimulator",props:{product:{},device:{}},setup(U){const w=U,m=G(),i=_("up"),o=_("property"),g=_(!1),p=ee({type:void 0,productId:-1}),k=_([]),$=ae(()=>t=>X(t)),N=async()=>{var t;g.value=!0;try{p.productId=((t=w.product)==null?void 0:t.id)||-1;const a=await M.getThingModelList(p);k.value=a.map(s=>({...s,simulateValue:""}))}finally{g.value=!1}};le([i,o],([t,a])=>{if(t==="up")switch(a){case"property":p.type=1;break;case"event":p.type=3}else if(t==="down")switch(a){case"propertyDebug":p.type=1;break;case"service":p.type=2}N()},{immediate:!0});const C=async()=>{const t={};k.value.forEach(a=>{a.simulateValue!==void 0&&a.simulateValue!==""&&(t[a.identifier]=a.simulateValue)});try{await L.upstreamDevice({id:w.device.id,type:"property",identifier:"report",data:t}),m.success("\u5C5E\u6027\u4E0A\u62A5\u6210\u529F")}catch{m.error("\u5C5E\u6027\u4E0A\u62A5\u5931\u8D25")}},E=async t=>{try{await L.upstreamDevice({id:w.device.id,type:"state",identifier:"report",data:t}),m.success(`\u8BBE\u5907${t===y.ONLINE?"\u4E0A\u7EBF":"\u4E0B\u7EBF"}\u6210\u529F`)}catch{m.error(`\u8BBE\u5907${t===y.ONLINE?"\u4E0A\u7EBF":"\u4E0B\u7EBF"}\u5931\u8D25`)}};return te(()=>{N()}),(t,a)=>{const s=z,j=A,F=W,h=B,n=J,u=H,c=P,I=Q,K=R,T=Y;return v(),b(n,null,{default:l(()=>[e(K,{gutter:20},{default:l(()=>[e(I,{span:12},{default:l(()=>[e(c,{modelValue:d(i),"onUpdate:modelValue":a[4]||(a[4]=r=>D(i)?i.value=r:null),type:"border-card"},{default:l(()=>[e(u,{label:"\u4E0A\u884C\u6307\u4EE4\u8C03\u8BD5",name:"up"},{default:l(()=>[d(i)==="up"?(v(),b(c,{key:0,modelValue:d(o),"onUpdate:modelValue":a[2]||(a[2]=r=>D(o)?o.value=r:null)},{default:l(()=>[e(u,{label:"\u5C5E\u6027\u4E0A\u62A5",name:"property"},{default:l(()=>[e(n,null,{default:l(()=>[re((v(),b(F,{data:d(k),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(s,{align:"center",label:"\u529F\u80FD\u540D\u79F0",prop:"name"}),e(s,{align:"center",label:"\u6807\u8BC6\u7B26",prop:"identifier"}),e(s,{align:"center",label:"\u6570\u636E\u7C7B\u578B",prop:"identifier"},{default:l(({row:r})=>{var f;return[V(de(d($)((f=r.property)==null?void 0:f.dataType)??"-"),1)]}),_:1}),e(s,{align:"left",label:"\u6570\u636E\u5B9A\u4E49",prop:"identifier"},{default:l(({row:r})=>[e(d(q),{data:r},null,8,["data"])]),_:1}),e(s,{align:"center",label:"\u503C",width:"80"},{default:l(r=>[e(j,{modelValue:r.row.simulateValue,"onUpdate:modelValue":f=>r.row.simulateValue=f,class:"!w-60px"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])),[[T,d(g)]]),x("div",ue,[e(h,{type:"primary",onClick:C},{default:l(()=>a[5]||(a[5]=[V(" \u53D1\u9001")])),_:1})])]),_:1})]),_:1}),e(u,{label:"\u4E8B\u4EF6\u4E0A\u62A5",name:"event"},{default:l(()=>[e(n)]),_:1}),e(u,{label:"\u72B6\u6001\u53D8\u66F4",name:"status"},{default:l(()=>[e(n,null,{default:l(()=>[x("div",oe,[e(h,{type:"primary",onClick:a[0]||(a[0]=r=>E(d(y).ONLINE))},{default:l(()=>a[6]||(a[6]=[V(" \u8BBE\u5907\u4E0A\u7EBF ")])),_:1}),e(h,{type:"danger",onClick:a[1]||(a[1]=r=>E(d(y).OFFLINE))},{default:l(()=>a[7]||(a[7]=[V(" \u8BBE\u5907\u4E0B\u7EBF ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])):O("",!0)]),_:1}),e(u,{label:"\u4E0B\u884C\u6307\u4EE4\u8C03\u8BD5",name:"down"},{default:l(()=>[d(i)==="down"?(v(),b(c,{key:0,modelValue:d(o),"onUpdate:modelValue":a[3]||(a[3]=r=>D(o)?o.value=r:null)},{default:l(()=>[e(u,{label:"\u5C5E\u6027\u8C03\u8BD5",name:"propertyDebug"},{default:l(()=>[e(n)]),_:1}),e(u,{label:"\u670D\u52A1\u8C03\u7528",name:"service"},{default:l(()=>[e(n)]),_:1})]),_:1},8,["modelValue"])):O("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(I,{span:12},{default:l(()=>[e(c,{type:"border-card"},{default:l(()=>[e(u,{label:"\u8BBE\u5907\u65E5\u5FD7"},{default:l(()=>[e(S,{"device-key":t.device.deviceKey},null,8,["device-key"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{se as _};
