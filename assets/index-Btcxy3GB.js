import{d as ne,a as de,h as ue,D as me,_ as pe}from"./index-DiGvuAxb.js";import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as fe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as ye}from"./index-BrNbcFk-.js";import{k as _e,r as f,P as we,e as he,af as be,l as Y,m as i,H as e,z as l,u as t,Z as H,G as I,$ as ge,y as d,A as w,E as u,v as ve,C as R}from"./form-create-D7wT855o.js";import{c as x}from"./permission-DHNmNb_V.js";import{d as ke}from"./formatTime-DeTj2b0K.js";import{d as xe}from"./download-oWiM5xVU.js";import{C}from"./constants-C3gLHYOK.js";import{a as Ce,d as Ve,e as Ne,f as Se,r as Ee}from"./index-BEHCTgo8.js";import{_ as Ue}from"./UserForm.vue_vue_type_script_setup_true_lang-DOzx4lXk.js";import{_ as Re}from"./UserImportForm.vue_vue_type_script_setup_true_lang-Bk3XGkvG.js";import{_ as De}from"./UserAssignRoleForm.vue_vue_type_script_setup_true_lang-BR_0Ee99.js";import{_ as Te}from"./DeptTree.vue_vue_type_script_setup_true_lang-D4EqeuN8.js";import{j as Ae,h as Fe,ai as Pe,k as je,x as ze,Q as Be,F as Le,f as Me,Z as Ye,_ as He,D as Ie,a1 as Ke,a2 as Oe,a3 as Ze,aj as qe,i as Ge}from"./form-designer-drfGvdgz.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./tree-COGD3qag.js";import"./index-CNUeQNrn.js";import"./index-eU2zJvzd.js";import"./index-C96DMNgm.js";import"./index-CLkdJnRM.js";const Qe={class:"flex items-center justify-center"},$e=_e({name:"SystemUser",__name:"index",setup(Je){const _=ne(),{t:D}=de(),V=f(!0),T=f(0),A=f([]),r=we({pageNo:1,pageSize:10,username:void 0,mobile:void 0,status:void 0,deptId:void 0,createTime:[]}),F=f(),m=async()=>{V.value=!0;try{const o=await Ce(r);A.value=o.list,T.value=o.total}finally{V.value=!1}},k=()=>{r.pageNo=1,m()},K=()=>{var o;(o=F.value)==null||o.resetFields(),k()},O=async o=>{r.deptId=o.id,await m()},P=f(),j=(o,a)=>{P.value.open(o,a)},z=f(),Z=()=>{z.value.open()},N=f(!1),q=async()=>{try{await _.exportConfirm(),N.value=!0;const o=await Ne(r);xe.excel(o,"\u7528\u6237\u6570\u636E.xls")}catch{}finally{N.value=!1}},G=async o=>{try{await _.delConfirm(),await Se(o),_.success(D("common.delSuccess")),await m()}catch{}},Q=async o=>{try{const a=(await _.prompt('\u8BF7\u8F93\u5165"'+o.username+'"\u7684\u65B0\u5BC6\u7801',D("common.reminder"))).value;await Ee(o.id,a),_.success("\u4FEE\u6539\u6210\u529F\uFF0C\u65B0\u5BC6\u7801\u662F\uFF1A"+a)}catch{}},B=f(),$=o=>{B.value.open(o)};return he(()=>{m()}),(o,a)=>{const S=ye,E=fe,L=Ae,M=je,h=Pe,J=Be,W=ze,X=Le,n=pe,y=Me,ee=Fe,p=He,ae=Ie,U=Ze,le=Oe,te=Ke,se=Ye,oe=ce,re=Ge,b=be("hasPermi"),ie=qe;return i(),Y(I,null,[e(S,{title:"\u7528\u6237\u4F53\u7CFB",url:"https://doc.iocoder.cn/user-center/"}),e(S,{title:"\u4E09\u65B9\u767B\u9646",url:"https://doc.iocoder.cn/social-user/"}),e(S,{title:"Excel \u5BFC\u5165\u5BFC\u51FA",url:"https://doc.iocoder.cn/excel-import-and-export/"}),e(re,{gutter:20},{default:l(()=>[e(L,{span:4,xs:24},{default:l(()=>[e(E,{class:"h-1/1"},{default:l(()=>[e(Te,{onNodeClick:O})]),_:1})]),_:1}),e(L,{span:20,xs:24},{default:l(()=>[e(E,null,{default:l(()=>[e(ee,{class:"-mb-15px",model:t(r),ref_key:"queryFormRef",ref:F,inline:!0,"label-width":"68px"},{default:l(()=>[e(h,{label:"\u7528\u6237\u540D\u79F0",prop:"username"},{default:l(()=>[e(M,{modelValue:t(r).username,"onUpdate:modelValue":a[0]||(a[0]=s=>t(r).username=s),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",clearable:"",onKeyup:H(k,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,{label:"\u624B\u673A\u53F7\u7801",prop:"mobile"},{default:l(()=>[e(M,{modelValue:t(r).mobile,"onUpdate:modelValue":a[1]||(a[1]=s=>t(r).mobile=s),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",clearable:"",onKeyup:H(k,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,{label:"\u72B6\u6001",prop:"status"},{default:l(()=>[e(W,{modelValue:t(r).status,"onUpdate:modelValue":a[2]||(a[2]=s=>t(r).status=s),placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u72B6\u6001",clearable:"",class:"!w-240px"},{default:l(()=>[(i(!0),Y(I,null,ge(t(ue)(t(me).COMMON_STATUS),s=>(i(),d(J,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:l(()=>[e(X,{modelValue:t(r).createTime,"onUpdate:modelValue":a[3]||(a[3]=s=>t(r).createTime=s),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,null,{default:l(()=>[e(y,{onClick:k},{default:l(()=>[e(n,{icon:"ep:search"}),a[7]||(a[7]=u("\u641C\u7D22"))]),_:1}),e(y,{onClick:K},{default:l(()=>[e(n,{icon:"ep:refresh"}),a[8]||(a[8]=u("\u91CD\u7F6E"))]),_:1}),w((i(),d(y,{type:"primary",plain:"",onClick:a[4]||(a[4]=s=>j("create"))},{default:l(()=>[e(n,{icon:"ep:plus"}),a[9]||(a[9]=u(" \u65B0\u589E "))]),_:1})),[[b,["system:user:create"]]]),w((i(),d(y,{type:"warning",plain:"",onClick:Z},{default:l(()=>[e(n,{icon:"ep:upload"}),a[10]||(a[10]=u(" \u5BFC\u5165 "))]),_:1})),[[b,["system:user:import"]]]),w((i(),d(y,{type:"success",plain:"",onClick:q,loading:t(N)},{default:l(()=>[e(n,{icon:"ep:download"}),a[11]||(a[11]=u("\u5BFC\u51FA "))]),_:1},8,["loading"])),[[b,["system:user:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(E,null,{default:l(()=>[w((i(),d(se,{data:t(A)},{default:l(()=>[e(p,{label:"\u7528\u6237\u7F16\u53F7",align:"center",key:"id",prop:"id"}),e(p,{label:"\u7528\u6237\u540D\u79F0",align:"center",prop:"username","show-overflow-tooltip":!0}),e(p,{label:"\u7528\u6237\u6635\u79F0",align:"center",prop:"nickname","show-overflow-tooltip":!0}),e(p,{label:"\u90E8\u95E8",align:"center",key:"deptName",prop:"deptName","show-overflow-tooltip":!0}),e(p,{label:"\u624B\u673A\u53F7\u7801",align:"center",prop:"mobile",width:"120"}),e(p,{label:"\u72B6\u6001",key:"status"},{default:l(s=>[e(ae,{modelValue:s.row.status,"onUpdate:modelValue":g=>s.row.status=g,"active-value":0,"inactive-value":1,onChange:g=>(async c=>{try{const v=c.status===C.ENABLE?"\u542F\u7528":"\u505C\u7528";await _.confirm('\u786E\u8BA4\u8981"'+v+'""'+c.username+'"\u7528\u6237\u5417?'),await Ve(c.id,c.status),await m()}catch{c.status=c.status===C.ENABLE?C.DISABLE:C.ENABLE}})(s.row),disabled:!t(x)(["system:user:update"])},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:1}),e(p,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:t(ke),width:"180"},null,8,["formatter"]),e(p,{label:"\u64CD\u4F5C",align:"center",width:"160"},{default:l(s=>[ve("div",Qe,[w((i(),d(y,{type:"primary",link:"",onClick:g=>j("update",s.row.id)},{default:l(()=>[e(n,{icon:"ep:edit"}),a[12]||(a[12]=u("\u4FEE\u6539 "))]),_:2},1032,["onClick"])),[[b,["system:user:update"]]]),w((i(),d(te,{onCommand:g=>((c,v)=>{switch(c){case"handleDelete":G(v.id);break;case"handleResetPwd":Q(v);break;case"handleRole":$(v)}})(g,s.row)},{dropdown:l(()=>[e(le,null,{default:l(()=>[t(x)(["system:user:delete"])?(i(),d(U,{key:0,command:"handleDelete"},{default:l(()=>[e(n,{icon:"ep:delete"}),a[14]||(a[14]=u("\u5220\u9664 "))]),_:1})):R("",!0),t(x)(["system:user:update-password"])?(i(),d(U,{key:1,command:"handleResetPwd"},{default:l(()=>[e(n,{icon:"ep:key"}),a[15]||(a[15]=u("\u91CD\u7F6E\u5BC6\u7801 "))]),_:1})):R("",!0),t(x)(["system:permission:assign-user-role"])?(i(),d(U,{key:2,command:"handleRole"},{default:l(()=>[e(n,{icon:"ep:circle-check"}),a[16]||(a[16]=u("\u5206\u914D\u89D2\u8272 "))]),_:1})):R("",!0)]),_:1})]),default:l(()=>[e(y,{type:"primary",link:""},{default:l(()=>[e(n,{icon:"ep:d-arrow-right"}),a[13]||(a[13]=u(" \u66F4\u591A"))]),_:1})]),_:2},1032,["onCommand"])),[[b,["system:user:delete","system:user:update-password","system:permission:assign-user-role"]]])])]),_:1})]),_:1},8,["data"])),[[ie,t(V)]]),e(oe,{total:t(T),page:t(r).pageNo,"onUpdate:page":a[5]||(a[5]=s=>t(r).pageNo=s),limit:t(r).pageSize,"onUpdate:limit":a[6]||(a[6]=s=>t(r).pageSize=s),onPagination:m},null,8,["total","page","limit"])]),_:1})]),_:1})]),_:1}),e(Ue,{ref_key:"formRef",ref:P,onSuccess:m},null,512),e(Re,{ref_key:"importFormRef",ref:z,onSuccess:m},null,512),e(De,{ref_key:"assignRoleFormRef",ref:B,onSuccess:m},null,512)],64)}}});export{$e as default};
