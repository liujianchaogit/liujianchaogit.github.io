import{V as r,b as $,d as A,Z as B}from"./index-C1TKk8vI.js";import{_ as D}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as W}from"./StockInItemForm.vue_vue_type_script_setup_true_lang-BU3cGdvM.js";import{S as Y}from"./index-BndeW3RW.js";import{k as ee,ai as ae,j as le,F as te,Q as se,x as oe,i as ue,h as ie,a0 as de,a1 as re,f as me,aj as pe}from"./form-designer-BpYekVAY.js";import{x as ne,r as d,X as ce,c as fe,y as f,E as v,F as t,u as a,K as T,J as ve,O as l,G as ke,z as _e,M as Ve,a4 as ye,l as j}from"./form-create-7GAbgMwl.js";const k={getStockInPage:async u=>await r.get({url:"/erp/stock-in/page",params:u}),getStockIn:async u=>await r.get({url:"/erp/stock-in/get?id="+u}),createStockIn:async u=>await r.post({url:"/erp/stock-in/create",data:u}),updateStockIn:async u=>await r.put({url:"/erp/stock-in/update",data:u}),updateStockInStatus:async(u,_)=>await r.put({url:"/erp/stock-in/update-status",params:{id:u,status:_}}),deleteStockIn:async u=>await r.delete({url:"/erp/stock-in/delete",params:{ids:u.join(",")}}),exportStockIn:async u=>await r.download({url:"/erp/stock-in/export-excel",params:u})},be=ne({name:"StockInForm",__name:"StockInForm",emits:["success"],setup(u,{expose:_,emit:C}){const{t:V}=$(),I=A(),m=d(!1),g=d(""),p=d(!1),y=d(""),o=d({id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:"",items:[]}),E=ce({inTime:[{required:!0,message:"\u5165\u5E93\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),b=fe(()=>y.value==="detail"),w=d(),x=d([]),S=d("item"),U=d();_({open:async(i,e)=>{if(m.value=!0,g.value=V("action."+i),y.value=i,K(),e){p.value=!0;try{o.value=await k.getStockIn(e)}finally{p.value=!1}}x.value=await Y.getSupplierSimpleList()}});const G=C,J=async()=>{await w.value.validate(),await U.value.validate(),p.value=!0;try{const i=o.value;y.value==="create"?(await k.createStockIn(i),I.success(V("common.createSuccess"))):(await k.updateStockIn(i),I.success(V("common.updateSuccess"))),m.value=!1,G("success")}finally{p.value=!1}},K=()=>{var i;o.value={id:void 0,supplierId:void 0,inTime:void 0,remark:void 0,fileUrl:void 0,items:[]},(i=w.value)==null||i.resetFields()};return(i,e)=>{const h=ee,n=ae,c=le,P=te,R=se,q=oe,z=B,L=ue,M=ie,N=de,O=re,Q=H,F=me,X=D,Z=pe;return f(),v(X,{title:a(g),modelValue:a(m),"onUpdate:modelValue":e[7]||(e[7]=s=>j(m)?m.value=s:null),width:"1080"},{footer:t(()=>[a(b)?ve("",!0):(f(),v(F,{key:0,onClick:J,type:"primary",disabled:a(p)},{default:t(()=>e[8]||(e[8]=[T(" \u786E \u5B9A ")])),_:1},8,["disabled"])),l(F,{onClick:e[6]||(e[6]=s=>m.value=!1)},{default:t(()=>e[9]||(e[9]=[T("\u53D6 \u6D88")])),_:1})]),default:t(()=>[ke((f(),v(M,{ref_key:"formRef",ref:w,model:a(o),rules:a(E),"label-width":"100px",disabled:a(b)},{default:t(()=>[l(L,{gutter:20},{default:t(()=>[l(c,{span:8},{default:t(()=>[l(n,{label:"\u5165\u5E93\u5355\u53F7",prop:"no"},{default:t(()=>[l(h,{disabled:"",modelValue:a(o).no,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).no=s),placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u5165\u5E93\u65F6\u95F4",prop:"inTime"},{default:t(()=>[l(P,{modelValue:a(o).inTime,"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).inTime=s),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u5165\u5E93\u65F6\u95F4",class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u4F9B\u5E94\u5546",prop:"supplierId"},{default:t(()=>[l(q,{modelValue:a(o).supplierId,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).supplierId=s),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546",class:"!w-1/1"},{default:t(()=>[(f(!0),_e(Ve,null,ye(a(x),s=>(f(),v(R,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:16},{default:t(()=>[l(n,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[l(h,{type:"textarea",modelValue:a(o).remark,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).remark=s),rows:1,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(n,{label:"\u9644\u4EF6",prop:"fileUrl"},{default:t(()=>[l(z,{"is-show-tip":!1,modelValue:a(o).fileUrl,"onUpdate:modelValue":e[4]||(e[4]=s=>a(o).fileUrl=s),limit:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","disabled"])),[[Z,a(p)]]),l(Q,null,{default:t(()=>[l(O,{modelValue:a(S),"onUpdate:modelValue":e[5]||(e[5]=s=>j(S)?S.value=s:null),class:"-mt-15px -mb-10px"},{default:t(()=>[l(N,{label:"\u5165\u5E93\u4EA7\u54C1\u6E05\u5355",name:"item"},{default:t(()=>[l(W,{ref_key:"itemFormRef",ref:U,items:a(o).items,disabled:a(b)},null,8,["items","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","modelValue"])}}});export{k as S,be as _};
