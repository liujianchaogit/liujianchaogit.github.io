import{d as X,b as $,u as H,D as I,_ as J}from"./index-C1TKk8vI.js";import{_ as L}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as W}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as Z}from"./index-BhsNgP9o.js";import{x as ee,r as m,X as ae,f as le,j as te,ae as oe,aq as re,y as n,z as ie,O as a,F as l,u as t,a5 as ne,K as p,G as u,E as d,l as pe,M as se}from"./form-create-7GAbgMwl.js";import{d as me}from"./formatTime-EbFUBcAO.js";import{b as ue,d as de,g as ce}from"./index-BwT0n6gf.js";import{b as fe}from"./formCreate-DNZv5C32.js";import{k as _e,ai as ye,f as be,h as ge,$ as ke,_ as we,aj as Ce}from"./form-designer-BpYekVAY.js";import"./color-BN7ZL7BD.js";const he=ee({name:"BpmForm",__name:"index",setup(ve){const q=X(),{t:M}=$(),{currentRoute:O,push:P}=H(),g=m(!0),S=m(0),V=m([]),r=ae({pageNo:1,pageSize:10,name:null}),F=m(),c=async()=>{g.value=!0;try{const f=await ue(r);V.value=f.list,S.value=f.total}finally{g.value=!1}},k=()=>{r.pageNo=1,c()},T=()=>{F.value.resetFields(),k()},w=(f,e)=>{const b={name:"BpmFormEditor",query:{type:f}};typeof e!="number"&&typeof e!="string"||(b.query.id=e),P(b)},y=m(!1),C=m({rule:[],option:{}});return le(()=>O.value,()=>{c()},{immediate:!0}),te(()=>{c()}),(f,e)=>{const b=Z,j=_e,N=ye,h=J,i=be,A=ge,U=Y,s=ke,B=W,E=we,G=Q,K=oe("form-create"),R=L,_=re("hasPermi"),D=Ce;return n(),ie(se,null,[a(b,{title:"\u5BA1\u6279\u63A5\u5165\uFF08\u6D41\u7A0B\u8868\u5355\uFF09",url:"https://doc.iocoder.cn/bpm/use-bpm-form/"}),a(U,null,{default:l(()=>[a(A,{ref_key:"queryFormRef",ref:F,inline:!0,model:t(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[a(N,{label:"\u8868\u5355\u540D",prop:"name"},{default:l(()=>[a(j,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(r).name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D",onKeyup:ne(k,["enter"])},null,8,["modelValue"])]),_:1}),a(N,null,{default:l(()=>[a(i,{onClick:k},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=p(" \u641C\u7D22 "))]),_:1}),a(i,{onClick:T},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=p(" \u91CD\u7F6E "))]),_:1}),u((n(),d(i,{plain:"",type:"primary",onClick:w},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=p(" \u65B0\u589E "))]),_:1})),[[_,["bpm:form:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(U,null,{default:l(()=>[u((n(),d(E,{data:t(V)},{default:l(()=>[a(s,{align:"center",label:"\u7F16\u53F7",prop:"id"}),a(s,{align:"center",label:"\u8868\u5355\u540D",prop:"name"}),a(s,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:l(o=>[a(B,{type:t(I).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),a(s,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(s,{formatter:t(me),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},null,8,["formatter"]),a(s,{align:"center",label:"\u64CD\u4F5C"},{default:l(o=>[u((n(),d(i,{link:"",type:"primary",onClick:v=>w("copy",o.row.id)},{default:l(()=>e[7]||(e[7]=[p(" \u590D\u5236 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((n(),d(i,{link:"",type:"primary",onClick:v=>w("update",o.row.id)},{default:l(()=>e[8]||(e[8]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((n(),d(i,{link:"",onClick:v=>(async x=>{const z=await ce(x);fe(C,z.conf,z.fields),y.value=!0})(o.row.id)},{default:l(()=>e[9]||(e[9]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:query"]]]),u((n(),d(i,{link:"",type:"danger",onClick:v=>(async x=>{try{await q.delConfirm(),await de(x),q.success(M("common.delSuccess")),await c()}catch{}})(o.row.id)},{default:l(()=>e[10]||(e[10]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:delete"]]])]),_:1})]),_:1},8,["data"])),[[D,t(g)]]),a(G,{limit:t(r).pageSize,"onUpdate:limit":e[1]||(e[1]=o=>t(r).pageSize=o),page:t(r).pageNo,"onUpdate:page":e[2]||(e[2]=o=>t(r).pageNo=o),total:t(S),onPagination:c},null,8,["limit","page","total"])]),_:1}),a(R,{modelValue:t(y),"onUpdate:modelValue":e[3]||(e[3]=o=>pe(y)?y.value=o:null),title:"\u8868\u5355\u8BE6\u60C5",width:"800"},{default:l(()=>[a(K,{option:t(C).option,rule:t(C).rule},null,8,["option","rule"])]),_:1},8,["modelValue"])],64)}}});export{he as default};
