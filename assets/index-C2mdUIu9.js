import{V as y,d as S,_ as W}from"./index-C1TKk8vI.js";import{_ as X}from"./index-BhsNgP9o.js";import{_ as B}from"./ReplyForm.vue_vue_type_script_setup_true_lang-NMRaEQqT.js";import{R as F}from"./TabNews-DPESzVct.js";import"./main-DVXlvIgg.js";import"./useUpload-B78SiPB2.js";import"./TabImage-DIcNZJHU.js";import"./main-C07Ho4xi.js";import"./TabVoice-DYksc7dm.js";import"./main.vue_vue_type_script_setup_true_lang-3w2LCMBi.js";import"./TabVideo-wcr8o65A.js";import"./main-B4oJ8nf7.js";import"./main-CCmna8Q9.js";import{_ as L}from"./main.vue_vue_type_script_setup_true_lang-CtGuAjr5.js";import{_ as K}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as Y}from"./ReplyTable.vue_vue_type_script_setup_true_lang-C0Pcgg7d.js";import{M as c}from"./types-CAO1T7C7.js";import{ai as Z,h as $,f as ee,j as ae,i as le,a0 as te,a1 as se,v as oe}from"./form-designer-BpYekVAY.js";import{x as re,r as p,X as ue,aq as pe,y as k,z as ie,O as l,F as s,u as t,l as h,G as ne,E as de,K as v,J as me,M as ce}from"./form-create-7GAbgMwl.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import"./index-CyoqorTW.js";import"./index-CLYonXYH.js";import"./formatTime-EbFUBcAO.js";import"./TabText.vue_vue_type_script_setup_true_lang-DhizLkhS.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-D3VJTT20.js";import"./index-KUcy92Cr.js";import"./tagsView-C2oS-OQq.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./main-BdkUPZ3m.js";const ve=re({name:"MpAutoReply",__name:"index",setup(ye){const f=S(),C=p(-1),u=p(c.Keyword),U=p(!0),A=p(0),I=p([]),w=p(null),i=ue({pageNo:1,pageSize:10,accountId:C}),b=p(!1),n=p(!1),r=p({}),o=p({type:F.Text,accountId:-1}),D=a=>{C.value=a,o.value.accountId=a,i.pageNo=1,M()},M=async()=>{U.value=!0;try{const e=await(a={...i,type:u.value},y.get({url:"/mp/auto-reply/page",params:a}));I.value=e.list,A.value=e.total}finally{U.value=!1}var a},N=a=>{u.value=a,i.pageNo=1,M()},O=()=>{T(),o.value={type:F.Text,accountId:i.accountId},b.value=!0,n.value=!0},R=async a=>{T();const e=await(m=>y.get({url:"/mp/auto-reply/get?id="+m}))(a);r.value={...e},delete r.value.responseMessageType,delete r.value.responseContent,delete r.value.responseMediaId,delete r.value.responseMediaUrl,delete r.value.responseDescription,delete r.value.responseArticles,o.value={type:e.responseMessageType,accountId:i.accountId,content:e.responseContent,mediaId:e.responseMediaId,url:e.responseMediaUrl,title:e.responseTitle,description:e.responseDescription,thumbMediaId:e.responseThumbMediaId,thumbMediaUrl:e.responseThumbMediaUrl,articles:e.responseArticles,musicUrl:e.responseMusicUrl,hqMusicUrl:e.responseHqMusicUrl},b.value=!1,n.value=!0},j=async a=>{await f.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(e=>y.delete({url:"/mp/auto-reply/delete?id="+e}))(a),await M(),f.success("\u5220\u9664\u6210\u529F")},z=async()=>{var m;await((m=w.value)==null?void 0:m.validate());const a={...r.value};var e;a.responseMessageType=o.value.type,a.responseContent=o.value.content,a.responseMediaId=o.value.mediaId,a.responseMediaUrl=o.value.url,a.responseTitle=o.value.title,a.responseDescription=o.value.description,a.responseThumbMediaId=o.value.thumbMediaId,a.responseThumbMediaUrl=o.value.thumbMediaUrl,a.responseArticles=o.value.articles,a.responseMusicUrl=o.value.musicUrl,a.responseHqMusicUrl=o.value.hqMusicUrl,r.value.id!==void 0?(await(e=a,y.put({url:"/mp/auto-reply/update",data:e})),f.success("\u4FEE\u6539\u6210\u529F")):(await(x=>y.post({url:"/mp/auto-reply/create",data:x}))(a),f.success("\u65B0\u589E\u6210\u529F")),n.value=!1,await M()},T=()=>{var a;r.value={id:void 0,accountId:i.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===c.Keyword?1:void 0,requestMessageType:void 0},(a=w.value)==null||a.resetFields()},H=()=>{n.value=!1,T()};return(a,e)=>{const m=X,x=Z,E=$,g=W,V=ee,G=ae,_=le,q=te,J=se,P=oe,Q=pe("hasPermi");return k(),ie(ce,null,[l(m,{title:"\u81EA\u52A8\u56DE\u590D",url:"https://doc.iocoder.cn/mp/auto-reply/"}),l(t(K),null,{default:s(()=>[l(E,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[l(x,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:s(()=>[l(t(L),{onChange:D})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(K),null,{default:s(()=>[l(J,{modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=d=>h(u)?u.value=d:null),onTabChange:N},{default:s(()=>[l(_,{gutter:10,class:"mb8"},{default:s(()=>[l(G,{span:1.5},{default:s(()=>[t(u)!==t(c).Follow||t(I).length<=0?ne((k(),de(V,{key:0,type:"primary",plain:"",onClick:O},{default:s(()=>[l(g,{icon:"ep:plus"}),e[4]||(e[4]=v("\u65B0\u589E "))]),_:1})),[[Q,["mp:auto-reply:create"]]]):me("",!0)]),_:1})]),_:1}),l(q,{name:t(c).Follow},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:star",class:"mr-2px"}),e[5]||(e[5]=v(" \u5173\u6CE8\u65F6\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(q,{name:t(c).Message},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:chat-line-round",class:"mr-2px"}),e[6]||(e[6]=v(" \u6D88\u606F\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(q,{name:t(c).Keyword},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"fa:newspaper-o",class:"mr-2px"}),e[7]||(e[7]=v(" \u5173\u952E\u8BCD\u56DE\u590D"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(Y,{loading:t(U),list:t(I),"msg-type":t(u),onOnUpdate:R,onOnDelete:j},null,8,["loading","list","msg-type"]),l(P,{title:t(b)?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:t(n),"onUpdate:modelValue":e[3]||(e[3]=d=>h(n)?n.value=d:null),width:"800px","destroy-on-close":""},{footer:s(()=>[l(V,{onClick:H},{default:s(()=>e[8]||(e[8]=[v("\u53D6 \u6D88")])),_:1}),l(V,{type:"primary",onClick:z},{default:s(()=>e[9]||(e[9]=[v("\u786E \u5B9A")])),_:1})]),default:s(()=>[l(B,{modelValue:t(r),"onUpdate:modelValue":e[1]||(e[1]=d=>h(r)?r.value=d:null),reply:t(o),"onUpdate:reply":e[2]||(e[2]=d=>h(o)?o.value=d:null),"msg-type":t(u),ref_key:"formRef",ref:w},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}});export{ve as default};
