import{o as ne,b as oe,d as ie,u as re,q as se,af as de,z as k,v as pe,w as ce,x as ue,r as me,ag as fe,y as z,ah as ge,_ as he,c as we}from"./index-C1TKk8vI.js";import{_ as ye}from"./Verify-DcxWYafk.js";import{_ as _e}from"./XButton-we2I6miX.js";import{x as xe,r as m,c as be,X as ve,f as ke,j as Fe,G as Ve,P as Ee,u as t,y as _,E as F,F as l,O as a,J as O,a5 as Ne,K as p,L as V,C as U,z as Ce,a4 as Re,M as Le}from"./form-create-7GAbgMwl.js";import{u as Me,_ as Pe,L as h,a as Se}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-K7ujEvmE.js";import{u as E}from"./useIcon-g0enAe49.js";import{r as N}from"./formRules-NkbEJCk0.js";import{d as je,ai as Ie,j as ze,k as Oe,w as Ue,P as Te,i as Ge,W as qe,h as Ae}from"./form-designer-BpYekVAY.js";const De={class:"w-[100%] flex justify-between"},Ke={class:"w-[100%] flex justify-between"},Qe=we(xe({name:"LoginForm",__name:"LoginForm",setup(We){const{t:d}=oe(),C=ie(),T=E({icon:"ep:house"}),G=E({icon:"ep:avatar"}),q=E({icon:"ep:lock"}),R=m(),{validForm:A}=Se(R),{setLoginState:w,getLoginState:D}=Me(),{currentRoute:K,push:Q}=re(),W=ne(),c=m(""),f=m(!1),L=m(),$=m("blockPuzzle"),B=be(()=>t(D)===h.LOGIN),J={tenantName:[N],username:[N],password:[N]},n=ve({isShowPassword:!1,captchaEnable:"false",tenantEnable:"false",loginForm:{tenantName:"\u828B\u9053\u6E90\u7801",username:"admin",password:"admin123",captchaVerification:"",rememberMe:!0}}),X=[{icon:"ant-design:wechat-filled",type:30},{icon:"ant-design:dingtalk-circle-filled",type:20},{icon:"ant-design:github-filled",type:0},{icon:"ant-design:alipay-circle-filled",type:0}],M=async()=>{n.captchaEnable==="false"?await j({}):L.value.show()},P=async()=>{if(n.tenantEnable==="true"){const o=await z(n.loginForm.tenantName);k(o)}},S=m(),j=async o=>{f.value=!0;try{if(await P(),!await A())return;const e={...n.loginForm};e.captchaVerification=o.captchaVerification;const s=await pe(e);if(!s)return;S.value=je.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.rememberMe?ce(e):ue(),me(s),c.value||(c.value="/"),c.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):await Q({path:c.value||W.addRouters[0].path})}finally{f.value=!1,S.value.close()}};return ke(()=>K.value,o=>{var e;c.value=(e=o==null?void 0:o.query)==null?void 0:e.redirect},{immediate:!0}),Fe(()=>{(()=>{const o=se();o&&(n.loginForm={...n.loginForm,username:o.username?o.username:n.loginForm.username,password:o.password?o.password:n.loginForm.password,rememberMe:o.rememberMe,tenantName:o.tenantName?o.tenantName:n.loginForm.tenantName})})(),(async()=>{const o=location.host,e=await de(o);e&&(n.loginForm.tenantName=e.name,k(e.id))})()}),(o,e)=>{const s=Ie,r=ze,x=Oe,H=Ue,g=Te,b=Ge,y=_e,Y=ye,I=qe,Z=he,ee=Ae;return Ve((_(),F(ee,{ref_key:"formLogin",ref:R,model:t(n).loginForm,rules:J,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:l(()=>[a(b,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:l(()=>[a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(Pe,{style:{width:"100%"}})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(n).tenantEnable==="true"?(_(),F(s,{key:0,prop:"tenantName"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.tenantName,"onUpdate:modelValue":e[0]||(e[0]=i=>t(n).loginForm.tenantName=i),placeholder:t(d)("login.tenantNamePlaceholder"),"prefix-icon":t(T),link:"",type:"primary"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):O("",!0)]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,{prop:"username"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.username,"onUpdate:modelValue":e[1]||(e[1]=i=>t(n).loginForm.username=i),placeholder:t(d)("login.usernamePlaceholder"),"prefix-icon":t(G)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,{prop:"password"},{default:l(()=>[a(x,{modelValue:t(n).loginForm.password,"onUpdate:modelValue":e[2]||(e[2]=i=>t(n).loginForm.password=i),placeholder:t(d)("login.passwordPlaceholder"),"prefix-icon":t(q),"show-password":"",type:"password",onKeyup:e[3]||(e[3]=Ne(i=>M(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(b,{justify:"space-between",style:{width:"100%"}},{default:l(()=>[a(r,{span:6},{default:l(()=>[a(H,{modelValue:t(n).loginForm.rememberMe,"onUpdate:modelValue":e[4]||(e[4]=i=>t(n).loginForm.rememberMe=i)},{default:l(()=>[p(V(t(d)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(r,{offset:6,span:12},{default:l(()=>[a(g,{style:{float:"right"},type:"primary",onClick:e[5]||(e[5]=i=>t(w)(t(h).RESET_PASSWORD))},{default:l(()=>[p(V(t(d)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(y,{loading:t(f),title:t(d)("login.login"),class:"w-[100%]",type:"primary",onClick:e[6]||(e[6]=i=>M())},null,8,["loading","title"])]),_:1})]),_:1}),t(n).captchaEnable==="true"?(_(),F(Y,{key:0,ref_key:"verify",ref:L,captchaType:t($),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:j},null,8,["captchaType"])):O("",!0),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[a(b,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:l(()=>[a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnMobile"),class:"w-[100%]",onClick:e[7]||(e[7]=i=>t(w)(t(h).MOBILE))},null,8,["title"])]),_:1}),a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnQRCode"),class:"w-[100%]",onClick:e[8]||(e[8]=i=>t(w)(t(h).QR_CODE))},null,8,["title"])]),_:1}),a(r,{span:8},{default:l(()=>[a(y,{title:t(d)("login.btnRegister"),class:"w-[100%]",onClick:e[9]||(e[9]=i=>t(w)(t(h).REGISTER))},null,8,["title"])]),_:1})]),_:1})]),_:1})]),_:1}),a(I,{"content-position":"center"},{default:l(()=>[p(V(t(d)("login.otherLogin")),1)]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[U("div",De,[(_(),Ce(Le,null,Re(X,(i,ae)=>a(Z,{key:ae,icon:i.icon,size:30,class:"anticon cursor-pointer",color:"#999",onClick:$e=>(async v=>{if(v===0)C.error("\u6B64\u65B9\u5F0F\u672A\u914D\u7F6E");else{if(f.value=!0,n.tenantEnable==="true"&&(await P(),!fe()))try{const u=await C.prompt("\u8BF7\u8F93\u5165\u79DF\u6237\u540D\u79F0",d("common.reminder"));if((u==null?void 0:u.action)!=="confirm")throw"cancel";const le=await z(u.value);k(le)}catch(u){if(u==="cancel")return}finally{f.value=!1}const te=location.origin+"/social-login?"+encodeURIComponent(`type=${v}&redirect=${c.value||"/"}`);window.location.href=await ge(v,encodeURIComponent(te))}})(i.type)},null,8,["icon","onClick"])),64))])]),_:1})]),_:1}),a(I,{"content-position":"center"},{default:l(()=>e[10]||(e[10]=[p("\u840C\u65B0\u5FC5\u8BFB")])),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(s,null,{default:l(()=>[U("div",Ke,[a(g,{href:"https://doc.iocoder.cn/",target:"_blank"},{default:l(()=>e[11]||(e[11]=[p("\u{1F4DA}\u5F00\u53D1\u6307\u5357")])),_:1}),a(g,{href:"https://doc.iocoder.cn/video/",target:"_blank"},{default:l(()=>e[12]||(e[12]=[p("\u{1F525}\u89C6\u9891\u6559\u7A0B")])),_:1}),a(g,{href:"https://www.iocoder.cn/Interview/good-collection/",target:"_blank"},{default:l(()=>e[13]||(e[13]=[p(" \u26A1\u9762\u8BD5\u624B\u518C ")])),_:1}),a(g,{href:"http://static.yudao.iocoder.cn/mp/Aix9975.jpeg",target:"_blank"},{default:l(()=>e[14]||(e[14]=[p(" \u{1F91D}\u5916\u5305\u54A8\u8BE2 ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[Ee,t(B)]])}}}),[["__scopeId","data-v-c72b61ad"]]);export{Qe as default};
