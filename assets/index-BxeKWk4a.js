import{G as b}from"./index-C1TKk8vI.js";import{b as C}from"./spu-75LBH-4N.js";import{P}from"./index-xw5B9PK9.js";import{ak as S}from"./form-designer-BpYekVAY.js";import{x as B,r as d,f as I,y as r,z as p,M as R,a4 as $,V as s,O as g,J as c,C as y,H as u,L as a,u as m,E as L}from"./form-create-7GAbgMwl.js";const A={key:0,class:"absolute left-0 top-0 z-1 items-center justify-center"},E={class:"text-12px"},U={class:"absolute bottom-8px right-8px"},_=B({name:"PromotionPoint",__name:"index",props:{property:{}},setup(h){const i=h,n=d([]),x=d([]),f=d([]);I(()=>i.property.activityIds,async()=>{try{const e=i.property.activityIds;Array.isArray(e)&&e.length>0&&(f.value=await P.getPointActivityListByIds(e),n.value=[],x.value=f.value.map(o=>o.spuId),x.value.length>0&&(n.value=await C(x.value)),f.value.forEach(o=>{const l=n.value.find(t=>t.id===o.spuId);l&&(l.pointStock=o.stock,l.pointTotalStock=o.totalStock,l.point=o.point,l.pointPrice=o.price)}))}catch{}},{immediate:!0,deep:!0});const k=e=>{const o=i.property.layoutType==="twoCol"?2:1;return{marginLeft:e%o==0?"0":i.property.space+"px",marginTop:e<o?"0":i.property.space+"px"}},v=d(),T=()=>{let e="100%";return i.property.layoutType==="twoCol"&&(e=(v.value.offsetWidth-i.property.space)/2+"px"),{width:e}};return(e,o)=>{const l=S;return r(),p("div",{ref_key:"containerRef",ref:v,class:u("box-content min-h-30px w-full flex flex-row flex-wrap")},[(r(!0),p(R,null,$(m(n),(t,w)=>(r(),p("div",{key:w,style:s({...k(w),...T(),borderTopLeftRadius:`${e.property.borderRadiusTop}px`,borderTopRightRadius:`${e.property.borderRadiusTop}px`,borderBottomLeftRadius:`${e.property.borderRadiusBottom}px`,borderBottomRightRadius:`${e.property.borderRadiusBottom}px`}),class:"relative box-content flex flex-row flex-wrap overflow-hidden bg-white"},[e.property.badge.show?(r(),p("div",A,[g(l,{src:e.property.badge.imgUrl,class:"h-26px w-38px",fit:"cover"},null,8,["src"])])):c("",!0),y("div",{class:u(["h-140px",{"w-full":e.property.layoutType!=="oneColSmallImg","w-140px":e.property.layoutType==="oneColSmallImg"}])},[g(l,{src:t.picUrl,class:"h-full w-full",fit:"cover"},null,8,["src"])],2),y("div",{class:u([" flex flex-col gap-8px p-8px box-border",{"w-full":e.property.layoutType!=="oneColSmallImg","w-[calc(100%-140px-16px)]":e.property.layoutType==="oneColSmallImg"}])},[e.property.fields.name.show?(r(),p("div",{key:0,class:u(["text-14px ",{truncate:e.property.layoutType!=="oneColSmallImg","overflow-ellipsis line-clamp-2":e.property.layoutType==="oneColSmallImg"}]),style:s({color:e.property.fields.name.color})},a(t.name),7)):c("",!0),e.property.fields.introduction.show?(r(),p("div",{key:1,style:s({color:e.property.fields.introduction.color}),class:"truncate text-12px"},a(t.introduction),5)):c("",!0),y("div",null,[e.property.fields.price.show?(r(),p("span",{key:0,style:s({color:e.property.fields.price.color}),class:"text-16px"},a(t.point)+"\u79EF\u5206 "+a(t.pointPrice&&t.pointPrice!==0?`+${m(b)(t.pointPrice)}\u5143`:""),5)):c("",!0),e.property.fields.marketPrice.show&&t.marketPrice?(r(),p("span",{key:1,style:s({color:e.property.fields.marketPrice.color}),class:"ml-4px text-10px line-through"}," \uFFE5"+a(m(b)(t.marketPrice)),5)):c("",!0)]),y("div",E,[e.property.fields.salesCount.show?(r(),p("span",{key:0,style:s({color:e.property.fields.salesCount.color})}," \u5DF2\u5151"+a((t.pointTotalStock||0)-(t.pointStock||0))+"\u4EF6 ",5)):c("",!0),e.property.fields.stock.show?(r(),p("span",{key:1,style:s({color:e.property.fields.stock.color})}," \u5E93\u5B58"+a(t.pointTotalStock||0),5)):c("",!0)])],2),y("div",U,[e.property.btnBuy.type==="text"?(r(),p("span",{key:0,style:s({background:`linear-gradient(to right, ${e.property.btnBuy.bgBeginColor}, ${e.property.btnBuy.bgEndColor}`}),class:"rounded-full p-x-12px p-y-4px text-12px text-white"},a(e.property.btnBuy.text),5)):(r(),L(l,{key:1,src:e.property.btnBuy.imgUrl,class:"h-28px w-28px rounded-full",fit:"cover"},null,8,["src"]))])],4))),128))],512)}}});export{_ as default};
