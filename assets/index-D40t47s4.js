import{d as pe,b as re,u as ce,e as de,D as N,_ as ue}from"./index-C1TKk8vI.js";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as ge}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{x as xe,r as g,X as ye,j as ve,aq as _e,y as n,z as U,O as l,F as t,u as s,a5 as be,M as V,a4 as Y,E as r,K as u,G as x,J as F,C as i,L as k,H as ke}from"./form-create-7GAbgMwl.js";import{d as we}from"./formatTime-EbFUBcAO.js";import{P as I}from"./index-DPbQY1s1.js";import{_ as he}from"./PluginConfigForm.vue_vue_type_script_setup_true_lang-BBQ8dzRL.js";import{k as Ce,ai as Pe,Q as Te,x as Ne,f as Ue,ap as Ve,h as Ie,$ as Se,D as Le,_ as Oe,ak as je,a7 as De,W as Ee,ad as ze,j as Ge,i as Ke,aj as Ye}from"./form-designer-BpYekVAY.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";const Fe={class:"p-4 relative"},qe={class:"flex items-center mb-3"},Re={class:"mr-2.5 flex items-center"},Ae={class:"text-[16px] font-600 flex-1"},He={class:"inline-flex items-center"},Je={class:"flex items-center text-[14px]"},Me={class:"flex-1"},Qe={class:"mb-2.5 last:mb-0"},Xe={class:"text-[#0b1d30] whitespace-normal break-all"},$e={class:"mb-2.5 last:mb-0"},Be={class:"text-[#0b1d30]"},We={class:"mb-2.5 last:mb-0"},Ze={class:"text-[#0b1d30]"},el={class:"mb-2.5 last:mb-0"},ll={class:"flex items-center px-0"},al=xe({name:"IoTPlugin",__name:"index",setup(tl){const b=pe(),{t:q}=re(),C=g(!0),P=g([]),S=g(0),o=ye({pageNo:1,pageSize:10,name:void 0,status:void 0}),L=g(),R=g("/src/assets/svgs/iot/card-fill.svg"),y=g("card"),v=async()=>{C.value=!0;try{const c=await I.getPluginConfigPage(o);P.value=c.list,S.value=c.total}finally{C.value=!1}},w=()=>{o.pageNo=1,v()},A=()=>{L.value.resetFields(),w()},O=g(),T=(c,e)=>{O.value.open(c,e)},{push:H}=ce(),j=c=>{H({name:"IoTPluginDetail",params:{id:c}})},D=async c=>{try{await b.delConfirm(),await I.deletePluginConfig(c),b.success(q("common.delSuccess")),await v()}catch{}};return ve(()=>{v()}),(c,e)=>{const J=Ce,h=Pe,M=Te,Q=Ne,m=ue,p=Ue,X=Ve,$=Ie,E=ge,f=Se,z=fe,B=Le,W=Oe,Z=je,ee=De,le=Ee,ae=ze,te=Ge,se=Ke,ie=me,_=_e("hasPermi"),ne=Ye;return n(),U(V,null,[l(E,null,{default:t(()=>[l($,{class:"-mb-15px",model:s(o),ref_key:"queryFormRef",ref:L,inline:!0,"label-width":"68px"},{default:t(()=>[l(h,{label:"\u63D2\u4EF6\u540D\u79F0",prop:"name"},{default:t(()=>[l(J,{modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=a=>s(o).name=a),placeholder:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u540D\u79F0",clearable:"",onKeyup:be(w,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(h,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[l(Q,{modelValue:s(o).status,"onUpdate:modelValue":e[1]||(e[1]=a=>s(o).status=a),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:"",onChange:w,class:"!w-240px"},{default:t(()=>[(n(!0),U(V,null,Y(s(de)(s(N).IOT_PLUGIN_STATUS),a=>(n(),r(M,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(h,{class:"float-right !mr-0 !mb-0"},{default:t(()=>[l(X,null,{default:t(()=>[l(p,{type:s(y)==="card"?"primary":"default",onClick:e[2]||(e[2]=a=>y.value="card")},{default:t(()=>[l(m,{icon:"ep:grid"})]),_:1},8,["type"]),l(p,{type:s(y)==="list"?"primary":"default",onClick:e[3]||(e[3]=a=>y.value="list")},{default:t(()=>[l(m,{icon:"ep:list"})]),_:1},8,["type"])]),_:1})]),_:1}),l(h,null,{default:t(()=>[l(p,{onClick:w},{default:t(()=>[l(m,{icon:"ep:search",class:"mr-5px"}),e[7]||(e[7]=u(" \u641C\u7D22"))]),_:1}),l(p,{onClick:A},{default:t(()=>[l(m,{icon:"ep:refresh",class:"mr-5px"}),e[8]||(e[8]=u(" \u91CD\u7F6E"))]),_:1}),x((n(),r(p,{type:"primary",plain:"",onClick:e[4]||(e[4]=a=>T("create"))},{default:t(()=>[l(m,{icon:"ep:plus",class:"mr-5px"}),e[9]||(e[9]=u(" \u65B0\u589E "))]),_:1})),[[_,["iot:plugin-config:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(E,null,{default:t(()=>[s(y)==="list"?x((n(),r(W,{key:0,data:s(P),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[l(f,{label:"\u63D2\u4EF6\u540D\u79F0",align:"center",prop:"name"}),l(f,{label:"\u63D2\u4EF6\u6807\u8BC6",align:"center",prop:"pluginKey"}),l(f,{label:"jar \u5305",align:"center",prop:"fileName"}),l(f,{label:"\u7248\u672C\u53F7",align:"center",prop:"version"}),l(f,{label:"\u90E8\u7F72\u65B9\u5F0F",align:"center",prop:"deployType"},{default:t(a=>[l(z,{type:s(N).IOT_PLUGIN_DEPLOY_TYPE,value:a.row.deployType},null,8,["type","value"])]),_:1}),l(f,{label:"\u72B6\u6001",align:"center",prop:"status"},{default:t(a=>[l(B,{modelValue:a.row.status,"onUpdate:modelValue":d=>a.row.status=d,"active-value":1,"inactive-value":0,onChange:d=>(async(oe,G)=>{try{const K=G===1?"\u542F\u7528":"\u505C\u7528";await b.confirm('\u786E\u8BA4\u8981"'+K+'"\u63D2\u4EF6\u5417?'),await I.updatePluginStatus({id:oe,status:G}),b.success("\u66F4\u65B0\u72B6\u6001\u6210\u529F"),v()}catch{b.error("\u66F4\u65B0\u72B6\u6001\u5931\u8D25")}})(a.row.id,Number(d))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(f,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:s(we),width:"180px"},null,8,["formatter"]),l(f,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:t(a=>[x((n(),r(p,{link:"",type:"primary",onClick:d=>j(a.row.id)},{default:t(()=>e[10]||(e[10]=[u(" \u67E5\u770B ")])),_:2},1032,["onClick"])),[[_,["iot:product:query"]]]),x((n(),r(p,{link:"",type:"primary",onClick:d=>T("update",a.row.id)},{default:t(()=>e[11]||(e[11]=[u(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["iot:plugin-config:update"]]]),x((n(),r(p,{link:"",type:"danger",onClick:d=>D(a.row.id)},{default:t(()=>e[12]||(e[12]=[u(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["iot:plugin-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[ne,s(C)]]):F("",!0),s(y)==="card"?(n(),r(se,{key:1,gutter:16},{default:t(()=>[(n(!0),U(V,null,Y(s(P),a=>(n(),r(te,{key:a.id,xs:24,sm:12,md:12,lg:6,class:"mb-4"},{default:t(()=>[l(ae,{class:"h-full transition-colors relative overflow-hidden","body-style":{padding:"0"}},{default:t(()=>[i("div",Fe,[i("div",qe,[i("div",Re,[l(Z,{src:s(R),class:"w-[18px] h-[18px]"},null,8,["src"])]),i("div",Ae,k(a.name),1),i("div",He,[i("div",{class:ke(["w-1 h-1 rounded-full mr-1.5",a.status===1?"bg-[var(--el-color-success)]":"bg-[var(--el-color-danger)]"])},null,2),l(ee,{class:"!text-xs font-bold",type:a.status===1?"success":"danger"},{default:t(()=>[u(k(a.status===1?"\u5F00\u542F":"\u7981\u7528"),1)]),_:2},1032,["type"])])]),i("div",Je,[i("div",Me,[i("div",Qe,[e[13]||(e[13]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u63D2\u4EF6\u6807\u8BC6",-1)),i("span",Xe,k(a.pluginKey),1)]),i("div",$e,[e[14]||(e[14]=i("span",{class:"text-[#717c8e] mr-2.5"},"jar \u5305",-1)),i("span",Be,k(a.fileName),1)]),i("div",We,[e[15]||(e[15]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u7248\u672C\u53F7",-1)),i("span",Ze,k(a.version),1)]),i("div",el,[e[16]||(e[16]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u90E8\u7F72\u65B9\u5F0F",-1)),l(z,{type:s(N).IOT_PLUGIN_DEPLOY_TYPE,value:a.deployType},null,8,["type","value"])])])]),l(le,{class:"!my-3"}),i("div",ll,[x((n(),r(p,{class:"flex-1 !px-2 !h-[32px] text-[13px]",type:"primary",plain:"",onClick:d=>T("update",a.id)},{default:t(()=>[l(m,{icon:"ep:edit-pen",class:"mr-1"}),e[17]||(e[17]=u(" \u7F16\u8F91 "))]),_:2},1032,["onClick"])),[[_,["iot:plugin-config:update"]]]),l(p,{class:"flex-1 !px-2 !h-[32px] !ml-[10px] text-[13px]",type:"warning",plain:"",onClick:d=>j(a.id)},{default:t(()=>[l(m,{icon:"ep:view",class:"mr-1"}),e[18]||(e[18]=u(" \u8BE6\u60C5 "))]),_:2},1032,["onClick"]),e[19]||(e[19]=i("div",{class:"mx-[10px] h-[20px] w-[1px] bg-[#dcdfe6]"},null,-1)),x((n(),r(p,{class:"!px-2 !h-[32px] text-[13px]",type:"danger",plain:"",onClick:d=>D(a.id)},{default:t(()=>[l(m,{icon:"ep:delete"})]),_:2},1032,["onClick"])),[[_,["iot:device:delete"]]])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):F("",!0),l(ie,{total:s(S),page:s(o).pageNo,"onUpdate:page":e[5]||(e[5]=a=>s(o).pageNo=a),limit:s(o).pageSize,"onUpdate:limit":e[6]||(e[6]=a=>s(o).pageSize=a),onPagination:v},null,8,["total","page","limit"])]),_:1}),l(he,{ref_key:"formRef",ref:O,onSuccess:v},null,512)],64)}}});export{al as default};
