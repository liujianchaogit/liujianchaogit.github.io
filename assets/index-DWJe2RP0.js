import{e as Q,D as R,d as X,b as $,h as H,u as J,_ as W}from"./index-C1TKk8vI.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as Z}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{x as ee,r as y,X as ae,j as le,y as r,z as E,O as e,F as o,u as n,a5 as oe,M as N,a4 as ne,E as u,K as p,G as w,aq as te}from"./form-create-7GAbgMwl.js";import{d as se}from"./formatTime-EbFUBcAO.js";import{K as I}from"./index-BHVZZTlJ.js";import{c as de}from"./permission-0vfiopec.js";import{C as _}from"./constants-IYPHa1Ih.js";import{k as re,ai as ie,Q as ue,x as pe,f as me,h as ce,$ as ge,D as we,_ as fe,aj as ke}from"./form-designer-BpYekVAY.js";const ye=ee({name:"KnowledgeDocument",__name:"index",setup(_e){const m=X(),{t:K}=$(),D=H(),f=J(),v=y(!0),S=y([]),V=y(0),t=ae({pageNo:1,pageSize:10,name:void 0,status:void 0,knowledgeId:void 0}),A=y(),c=async()=>{v.value=!0;try{const h=await I.getKnowledgeDocumentPage(t);S.value=h.list,V.value=h.total}finally{v.value=!1}},b=()=>{t.pageNo=1,c()},U=()=>{A.value.resetFields(),b()},T=()=>{f.push({name:"AiKnowledgeDocumentCreate",query:{knowledgeId:t.knowledgeId}})};return le(()=>{if(!D.query.knowledgeId)return m.error("\u77E5\u8BC6\u5E93 ID \u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u67E5\u770B\u6587\u6863\u5217\u8868"),void f.push({name:"AiKnowledge"});t.knowledgeId=D.query.knowledgeId,c()}),(h,a)=>{const B=re,C=ie,L=ue,z=pe,x=W,i=me,F=ce,q=Z,d=ge,M=we,O=fe,P=Y,k=te("hasPermi"),j=ke;return r(),E(N,null,[e(q,null,{default:o(()=>[e(F,{class:"-mb-15px",model:n(t),ref_key:"queryFormRef",ref:A,inline:!0,"label-width":"68px"},{default:o(()=>[e(C,{label:"\u6587\u4EF6\u540D\u79F0",prop:"name"},{default:o(()=>[e(B,{modelValue:n(t).name,"onUpdate:modelValue":a[0]||(a[0]=l=>n(t).name=l),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D\u79F0",clearable:"",onKeyup:oe(b,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(C,{label:"\u662F\u5426\u542F\u7528",prop:"status"},{default:o(()=>[e(z,{modelValue:n(t).status,"onUpdate:modelValue":a[1]||(a[1]=l=>n(t).status=l),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u542F\u7528",clearable:"",class:"!w-240px"},{default:o(()=>[(r(!0),E(N,null,ne(n(Q)(n(R).COMMON_STATUS),l=>(r(),u(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,null,{default:o(()=>[e(i,{onClick:b},{default:o(()=>[e(x,{icon:"ep:search",class:"mr-5px"}),a[4]||(a[4]=p(" \u641C\u7D22"))]),_:1}),e(i,{onClick:U},{default:o(()=>[e(x,{icon:"ep:refresh",class:"mr-5px"}),a[5]||(a[5]=p(" \u91CD\u7F6E"))]),_:1}),w((r(),u(i,{type:"primary",plain:"",onClick:T},{default:o(()=>[e(x,{icon:"ep:plus",class:"mr-5px"}),a[6]||(a[6]=p(" \u65B0\u589E "))]),_:1})),[[k,["ai:knowledge:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(q,null,{default:o(()=>[w((r(),u(O,{data:n(S),stripe:!0,"show-overflow-tooltip":!0},{default:o(()=>[e(d,{label:"\u6587\u6863\u7F16\u53F7",align:"center",prop:"id"}),e(d,{label:"\u6587\u4EF6\u540D\u79F0",align:"center",prop:"name"}),e(d,{label:"\u5B57\u7B26\u6570",align:"center",prop:"contentLength"}),e(d,{label:"Token \u6570",align:"center",prop:"tokens"}),e(d,{label:"\u5206\u7247\u6700\u5927 Token \u6570",align:"center",prop:"segmentMaxTokens"}),e(d,{label:"\u53EC\u56DE\u6B21\u6570",align:"center",prop:"retrievalCount"}),e(d,{label:"\u662F\u5426\u542F\u7528",align:"center",prop:"status"},{default:o(l=>[e(M,{modelValue:l.row.status,"onUpdate:modelValue":g=>l.row.status=g,"active-value":0,"inactive-value":1,onChange:g=>(async s=>{try{const G=s.status===_.ENABLE?"\u542F\u7528":"\u7981\u7528";await m.confirm('\u786E\u8BA4\u8981"'+G+'""'+s.name+'"\u6587\u6863\u5417?'),await I.updateKnowledgeDocumentStatus({id:s.id,status:s.status}),m.success(K("common.updateSuccess")),await c()}catch{s.status=s.status===_.ENABLE?_.DISABLE:_.ENABLE}})(l.row),disabled:!n(de)(["ai:knowledge:update"])},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:1}),e(d,{label:"\u4E0A\u4F20\u65F6\u95F4",align:"center",prop:"createTime",formatter:n(se),width:"180px"},null,8,["formatter"]),e(d,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:o(l=>[w((r(),u(i,{link:"",type:"primary",onClick:g=>{return s=l.row.id,void f.push({name:"AiKnowledgeDocumentUpdate",query:{id:s,knowledgeId:t.knowledgeId}});var s}},{default:o(()=>a[7]||(a[7]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:update"]]]),w((r(),u(i,{link:"",type:"primary",onClick:g=>{return s=l.row.id,void f.push({name:"AiKnowledgeSegment",query:{documentId:s}});var s}},{default:o(()=>a[8]||(a[8]=[p(" \u5206\u6BB5 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:query"]]]),w((r(),u(i,{link:"",type:"danger",onClick:g=>(async s=>{try{await m.delConfirm(),await I.deleteKnowledgeDocument(s),m.success(K("common.delSuccess")),await c()}catch{}})(l.row.id)},{default:o(()=>a[9]||(a[9]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[k,["ai:knowledge:delete"]]])]),_:1})]),_:1},8,["data"])),[[j,n(v)]]),e(P,{total:n(V),page:n(t).pageNo,"onUpdate:page":a[2]||(a[2]=l=>n(t).pageNo=l),limit:n(t).pageSize,"onUpdate:limit":a[3]||(a[3]=l=>n(t).pageSize=l),onPagination:c},null,8,["total","page","limit"])]),_:1})],64)}}});export{ye as default};
