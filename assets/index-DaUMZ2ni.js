import{d as L,b as X,au as v,D as $,_ as B}from"./index-C1TKk8vI.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as J}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as Q}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as W}from"./index-BhsNgP9o.js";import{x as Y,r as n,X as Z,j as ee,aq as ae,y as c,z as le,O as e,F as t,u as l,a5 as te,K as d,G as m,E as f,M as re}from"./form-create-7GAbgMwl.js";import{d as oe}from"./formatTime-EbFUBcAO.js";import{d as pe}from"./download-oWiM5xVU.js";import{P as k}from"./index-DkO2ojqL.js";import{P as ie}from"./index-STa9kZSg.js";import{_ as ne}from"./ProductForm.vue_vue_type_script_setup_true_lang-CAhr1M3i.js";import{h as se,d as ce}from"./tree-COGD3qag.js";import{k as de,ai as ue,av as me,f as fe,h as ge,$ as ye,_ as _e,aj as we}from"./form-designer-BpYekVAY.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-Bw_ycH6P.js";import"./constants-IYPHa1Ih.js";const be=Y({name:"ErpProduct",__name:"index",setup(xe){const _=L(),{t:z}=X(),w=n(!0),C=n([]),P=n(0),o=Z({pageNo:1,pageSize:10,name:void 0,categoryId:void 0}),N=n(),b=n(!1),S=n([]),u=async()=>{w.value=!0;try{const i=await k.getProductPage(o);C.value=i.list,P.value=i.total}finally{w.value=!1}},x=()=>{o.pageNo=1,u()},E=()=>{N.value.resetFields(),x()},V=n(),I=(i,a)=>{V.value.open(i,a)},F=async()=>{try{await _.exportConfirm(),b.value=!0;const i=await k.exportProduct(o);pe.excel(i,"\u4EA7\u54C1.xls")}catch{}finally{b.value=!1}};return ee(async()=>{await u();const i=await ie.getProductCategorySimpleList();S.value=se(i,"id","parentId")}),(i,a)=>{const M=W,O=de,h=ue,T=me,g=B,s=fe,j=ge,U=Q,p=ye,q=J,K=_e,R=H,y=ae("hasPermi"),A=we;return c(),le(re,null,[e(M,{title:"\u3010\u4EA7\u54C1\u3011\u4EA7\u54C1\u4FE1\u606F\u3001\u5206\u7C7B\u3001\u5355\u4F4D",url:"https://doc.iocoder.cn/erp/product/"}),e(U,null,{default:t(()=>[e(j,{class:"-mb-15px",model:l(o),ref_key:"queryFormRef",ref:N,inline:!0,"label-width":"68px"},{default:t(()=>[e(h,{label:"\u540D\u79F0",prop:"name"},{default:t(()=>[e(O,{modelValue:l(o).name,"onUpdate:modelValue":a[0]||(a[0]=r=>l(o).name=r),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",clearable:"",onKeyup:te(x,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(h,{label:"\u5206\u7C7B",prop:"categoryId"},{default:t(()=>[e(T,{modelValue:l(o).categoryId,"onUpdate:modelValue":a[1]||(a[1]=r=>l(o).categoryId=r),data:l(S),props:l(ce),"check-strictly":"","default-expand-all":"",placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B",class:"!w-240px"},null,8,["modelValue","data","props"])]),_:1}),e(h,null,{default:t(()=>[e(s,{onClick:x},{default:t(()=>[e(g,{icon:"ep:search",class:"mr-5px"}),a[5]||(a[5]=d(" \u641C\u7D22"))]),_:1}),e(s,{onClick:E},{default:t(()=>[e(g,{icon:"ep:refresh",class:"mr-5px"}),a[6]||(a[6]=d(" \u91CD\u7F6E"))]),_:1}),m((c(),f(s,{type:"primary",plain:"",onClick:a[2]||(a[2]=r=>I("create"))},{default:t(()=>[e(g,{icon:"ep:plus",class:"mr-5px"}),a[7]||(a[7]=d(" \u65B0\u589E "))]),_:1})),[[y,["erp:product:create"]]]),m((c(),f(s,{type:"success",plain:"",onClick:F,loading:l(b)},{default:t(()=>[e(g,{icon:"ep:download",class:"mr-5px"}),a[8]||(a[8]=d(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[y,["erp:product:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(U,null,{default:t(()=>[m((c(),f(K,{data:l(C),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[e(p,{label:"\u6761\u7801",align:"center",prop:"barCode"}),e(p,{label:"\u540D\u79F0",align:"center",prop:"name"}),e(p,{label:"\u89C4\u683C",align:"center",prop:"standard"}),e(p,{label:"\u5206\u7C7B",align:"center",prop:"categoryName"}),e(p,{label:"\u5355\u4F4D",align:"center",prop:"unitName"}),e(p,{label:"\u91C7\u8D2D\u4EF7\u683C",align:"center",prop:"purchasePrice",formatter:l(v)},null,8,["formatter"]),e(p,{label:"\u9500\u552E\u4EF7\u683C",align:"center",prop:"salePrice",formatter:l(v)},null,8,["formatter"]),e(p,{label:"\u6700\u4F4E\u4EF7\u683C",align:"center",prop:"minPrice",formatter:l(v)},null,8,["formatter"]),e(p,{label:"\u72B6\u6001",align:"center",prop:"status"},{default:t(r=>[e(q,{type:l($).COMMON_STATUS,value:r.row.status},null,8,["type","value"])]),_:1}),e(p,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:l(oe),width:"180px"},null,8,["formatter"]),e(p,{label:"\u64CD\u4F5C",align:"center",width:"110"},{default:t(r=>[m((c(),f(s,{link:"",type:"primary",onClick:D=>I("update",r.row.id)},{default:t(()=>a[9]||(a[9]=[d(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[y,["erp:product:update"]]]),m((c(),f(s,{link:"",type:"danger",onClick:D=>(async G=>{try{await _.delConfirm(),await k.deleteProduct(G),_.success(z("common.delSuccess")),await u()}catch{}})(r.row.id)},{default:t(()=>a[10]||(a[10]=[d(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[y,["erp:product:delete"]]])]),_:1})]),_:1},8,["data"])),[[A,l(w)]]),e(R,{total:l(P),page:l(o).pageNo,"onUpdate:page":a[3]||(a[3]=r=>l(o).pageNo=r),limit:l(o).pageSize,"onUpdate:limit":a[4]||(a[4]=r=>l(o).pageSize=r),onPagination:u},null,8,["total","page","limit"])]),_:1}),e(ne,{ref_key:"formRef",ref:V,onSuccess:u},null,512)],64)}}});export{be as default};
