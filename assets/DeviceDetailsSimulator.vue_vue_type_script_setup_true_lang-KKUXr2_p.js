import{d as A}from"./index-DiGvuAxb.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{T as K}from"./index-xRJmLA9g.js";import{a as y,D as L}from"./index-4TQdK-Zm.js";import{_ as M}from"./DeviceDetailsLog.vue_vue_type_script_setup_true_lang-CoMd7I1t.js";import{g as P}from"./config-GFxGHtga.js";import{_ as S}from"./DataDefinition.vue_vue_type_script_setup_true_lang-Cl50HVaN.js";import{i as Z,j as q,a0 as W,$ as B,aj as G,Z as J,_ as Q,k as R,f as X}from"./form-designer-drfGvdgz.js";import{k as Y,r as _,P as ee,c as ae,b as le,e as te,y as v,m as b,z as l,H as e,u as d,h as D,C as U,A as re,v as $,E as V,F as de}from"./form-create-D7wT855o.js";const ue={class:"mt-10px"},oe={class:"flex gap-4"},se=Y({__name:"DeviceDetailsSimulator",props:{product:{},device:{}},setup(x){const w=x,m=A(),i=_("up"),o=_("property"),g=_(!1),p=ee({type:void 0,productId:-1}),k=_([]),C=ae(()=>t=>P(t)),N=async()=>{var t;g.value=!0;try{p.productId=((t=w.product)==null?void 0:t.id)||-1;const a=await K.getThingModelList(p);k.value=a.map(s=>({...s,simulateValue:""}))}finally{g.value=!1}};le([i,o],([t,a])=>{if(t==="up")switch(a){case"property":p.type=1;break;case"event":p.type=3}else if(t==="down")switch(a){case"propertyDebug":p.type=1;break;case"service":p.type=2}N()},{immediate:!0});const O=async()=>{const t={};k.value.forEach(a=>{a.simulateValue!==void 0&&a.simulateValue!==""&&(t[a.identifier]=a.simulateValue)});try{await L.upstreamDevice({id:w.device.id,type:"property",identifier:"report",data:t}),m.success("\u5C5E\u6027\u4E0A\u62A5\u6210\u529F")}catch{m.error("\u5C5E\u6027\u4E0A\u62A5\u5931\u8D25")}},E=async t=>{try{await L.upstreamDevice({id:w.device.id,type:"state",identifier:"report",data:t}),m.success(`\u8BBE\u5907${t===y.ONLINE?"\u4E0A\u7EBF":"\u4E0B\u7EBF"}\u6210\u529F`)}catch{m.error(`\u8BBE\u5907${t===y.ONLINE?"\u4E0A\u7EBF":"\u4E0B\u7EBF"}\u5931\u8D25`)}};return te(()=>{N()}),(t,a)=>{const s=Q,F=R,T=J,h=X,n=H,u=B,c=W,I=q,j=Z,z=G;return b(),v(n,null,{default:l(()=>[e(j,{gutter:20},{default:l(()=>[e(I,{span:12},{default:l(()=>[e(c,{modelValue:d(i),"onUpdate:modelValue":a[4]||(a[4]=r=>D(i)?i.value=r:null),type:"border-card"},{default:l(()=>[e(u,{label:"\u4E0A\u884C\u6307\u4EE4\u8C03\u8BD5",name:"up"},{default:l(()=>[d(i)==="up"?(b(),v(c,{key:0,modelValue:d(o),"onUpdate:modelValue":a[2]||(a[2]=r=>D(o)?o.value=r:null)},{default:l(()=>[e(u,{label:"\u5C5E\u6027\u4E0A\u62A5",name:"property"},{default:l(()=>[e(n,null,{default:l(()=>[re((b(),v(T,{data:d(k),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(s,{align:"center",label:"\u529F\u80FD\u540D\u79F0",prop:"name"}),e(s,{align:"center",label:"\u6807\u8BC6\u7B26",prop:"identifier"}),e(s,{align:"center",label:"\u6570\u636E\u7C7B\u578B",prop:"identifier"},{default:l(({row:r})=>{var f;return[V(de(d(C)((f=r.property)==null?void 0:f.dataType)??"-"),1)]}),_:1}),e(s,{align:"left",label:"\u6570\u636E\u5B9A\u4E49",prop:"identifier"},{default:l(({row:r})=>[e(d(S),{data:r},null,8,["data"])]),_:1}),e(s,{align:"center",label:"\u503C",width:"80"},{default:l(r=>[e(F,{modelValue:r.row.simulateValue,"onUpdate:modelValue":f=>r.row.simulateValue=f,class:"!w-60px"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])),[[z,d(g)]]),$("div",ue,[e(h,{type:"primary",onClick:O},{default:l(()=>a[5]||(a[5]=[V(" \u53D1\u9001")])),_:1})])]),_:1})]),_:1}),e(u,{label:"\u4E8B\u4EF6\u4E0A\u62A5",name:"event"},{default:l(()=>[e(n)]),_:1}),e(u,{label:"\u72B6\u6001\u53D8\u66F4",name:"status"},{default:l(()=>[e(n,null,{default:l(()=>[$("div",oe,[e(h,{type:"primary",onClick:a[0]||(a[0]=r=>E(d(y).ONLINE))},{default:l(()=>a[6]||(a[6]=[V(" \u8BBE\u5907\u4E0A\u7EBF ")])),_:1}),e(h,{type:"danger",onClick:a[1]||(a[1]=r=>E(d(y).OFFLINE))},{default:l(()=>a[7]||(a[7]=[V(" \u8BBE\u5907\u4E0B\u7EBF ")])),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])):U("",!0)]),_:1}),e(u,{label:"\u4E0B\u884C\u6307\u4EE4\u8C03\u8BD5",name:"down"},{default:l(()=>[d(i)==="down"?(b(),v(c,{key:0,modelValue:d(o),"onUpdate:modelValue":a[3]||(a[3]=r=>D(o)?o.value=r:null)},{default:l(()=>[e(u,{label:"\u5C5E\u6027\u8C03\u8BD5",name:"propertyDebug"},{default:l(()=>[e(n)]),_:1}),e(u,{label:"\u670D\u52A1\u8C03\u7528",name:"service"},{default:l(()=>[e(n)]),_:1})]),_:1},8,["modelValue"])):U("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(I,{span:12},{default:l(()=>[e(c,{type:"border-card"},{default:l(()=>[e(u,{label:"\u8BBE\u5907\u65E5\u5FD7"},{default:l(()=>[e(M,{"device-key":t.device.deviceKey},null,8,["device-key"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{se as _};
