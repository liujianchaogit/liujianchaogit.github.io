import{p as e,n as _,Q as h}from"./index-C1TKk8vI.js";import{x as j,X as k,Q as E,j as Q,c as $,f as v,u as o,z as w,L as z,H,y as L}from"./form-create-7GAbgMwl.js";const M=j({name:"CountTo",__name:"CountTo",props:{startVal:e.number.def(0),endVal:e.number.def(2021),duration:e.number.def(3e3),autoplay:e.bool.def(!0),decimals:e.number.validate(i=>i>=0).def(0),decimal:e.string.def("."),separator:e.string.def(","),prefix:e.string.def(""),suffix:e.string.def(""),useEasing:e.bool.def(!0),easingFn:{type:Function,default:(i,p,m,V)=>m*(1-Math.pow(2,-10*i/V))*1024/1023+p}},emits:["mounted","callback"],setup(i,{expose:p,emit:m}){const{getPrefixCls:V}=_(),y=V("count-to"),t=i,A=m,d=r=>{const{decimals:s,decimal:u,separator:l,suffix:n,prefix:q}=t;r=Number(r).toFixed(s);const S=(r+="").split(".");let c=S[0];const C=S.length>1?u+S[1]:"",x=/(\d+)(\d{3})/;if(l&&!h(l))for(;x.test(c);)c=c.replace(x,"$1"+l+"$2");return q+c+C+n},a=k({localStartVal:t.startVal,displayValue:d(t.startVal),printVal:null,paused:!1,localDuration:t.duration,startTime:null,timestamp:null,remaining:null,rAF:null}),D=E(a,"displayValue");Q(()=>{t.autoplay&&F(),A("mounted")});const f=$(()=>t.startVal>t.endVal);v([()=>t.startVal,()=>t.endVal],()=>{t.autoplay&&F()});const F=()=>{const{startVal:r,duration:s}=t;a.localStartVal=r,a.startTime=null,a.localDuration=s,a.paused=!1,a.rAF=requestAnimationFrame(g)},b=()=>{cancelAnimationFrame(a.rAF)},T=()=>{a.startTime=null,a.localDuration=+a.remaining,a.localStartVal=+a.printVal,requestAnimationFrame(g)},g=r=>{const{useEasing:s,easingFn:u,endVal:l}=t;a.startTime||(a.startTime=r),a.timestamp=r;const n=r-a.startTime;a.remaining=a.localDuration-n,s?o(f)?a.printVal=a.localStartVal-u(n,0,a.localStartVal-l,a.localDuration):a.printVal=u(n,a.localStartVal,l-a.localStartVal,a.localDuration):o(f)?a.printVal=a.localStartVal-(a.localStartVal-l)*(n/a.localDuration):a.printVal=a.localStartVal+(l-a.localStartVal)*(n/a.localDuration),o(f)?a.printVal=a.printVal<l?l:a.printVal:a.printVal=a.printVal>l?l:a.printVal,a.displayValue=d(a.printVal),n<a.localDuration?a.rAF=requestAnimationFrame(g):A("callback")};return p({pauseResume:()=>{a.paused?(T(),a.paused=!1):(b(),a.paused=!0)},reset:()=>{a.startTime=null,cancelAnimationFrame(a.rAF),a.displayValue=d(t.startVal)},start:F,pause:b}),(r,s)=>(L(),w("span",{class:H(o(y))},z(o(D)),3))}});export{M as _};
