import{aH as m,au as f}from"./index-DiGvuAxb.js";import{_ as S}from"./Echart.vue_vue_type_script_setup_true_lang-DccU3tqu.js";import{S as h}from"./customer-CtPL_dS-.js";import{ac as I,af as D,aj as q,_ as j,Z as B}from"./form-designer-drfGvdgz.js";import{k as H,r as w,P as L,e as U,l as Z,m as b,G as k,H as a,z as o,u as r,A as z,y as E,E as d,F as u}from"./form-create-D7wT855o.js";const F=H({name:"CustomerSummary",__name:"CustomerSummary",props:{queryParams:{}},setup(C,{expose:v}){const p=C,l=w(!1),c=w([]),e=L({grid:{left:20,right:30,bottom:20,containLabel:!0},legend:{},series:[{name:"\u65B0\u589E\u5BA2\u6237\u6570",type:"bar",yAxisIndex:0,data:[]},{name:"\u6210\u4EA4\u5BA2\u6237\u6570",type:"bar",yAxisIndex:1,data:[]}],toolbox:{feature:{dataZoom:{xAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u5BA2\u6237\u603B\u91CF\u5206\u6790"}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"\u65B0\u589E\u5BA2\u6237\u6570",min:0,minInterval:1},{type:"value",name:"\u6210\u4EA4\u5BA2\u6237\u6570",min:0,minInterval:1,splitLine:{lineStyle:{type:"dotted",opacity:.7}}}],xAxis:{type:"category",name:"\u65E5\u671F",data:[]}}),y=async()=>{l.value=!0;try{await(async()=>{const n=await h.getCustomerSummaryByDate(p.queryParams),g=await h.getCustomerSummaryByUser(p.queryParams);e.xAxis&&e.xAxis.data&&(e.xAxis.data=n.map(s=>s.time)),e.series&&e.series[0]&&e.series[0].data&&(e.series[0].data=n.map(s=>s.customerCreateCount)),e.series&&e.series[1]&&e.series[1].data&&(e.series[1].data=n.map(s=>s.customerDealCount)),c.value=g})()}finally{l.value=!1}};return v({loadData:y}),U(()=>{y()}),(n,g)=>{const s=S,P=D,x=I,t=j,_=B,A=q;return b(),Z(k,null,[a(x,{shadow:"never"},{default:o(()=>[a(P,{loading:r(l),animated:""},{default:o(()=>[a(s,{height:500,options:r(e)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),a(x,{shadow:"never",class:"mt-16px"},{default:o(()=>[z((b(),E(_,{data:r(c)},{default:o(()=>[a(t,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80",fixed:"left"}),a(t,{label:"\u5458\u5DE5\u59D3\u540D",prop:"ownerUserName","min-width":"100",fixed:"left"}),a(t,{label:"\u65B0\u589E\u5BA2\u6237\u6570",align:"right",prop:"customerCreateCount","min-width":"200"}),a(t,{label:"\u6210\u4EA4\u5BA2\u6237\u6570",align:"right",prop:"customerDealCount","min-width":"200"}),a(t,{label:"\u5BA2\u6237\u6210\u4EA4\u7387(%)",align:"right","min-width":"200"},{default:o(i=>[d(u(r(m)(i.row.customerDealCount,i.row.customerCreateCount)),1)]),_:1}),a(t,{label:"\u5408\u540C\u603B\u91D1\u989D",align:"right",prop:"contractPrice","min-width":"200",formatter:r(f)},null,8,["formatter"]),a(t,{label:"\u56DE\u6B3E\u91D1\u989D",align:"right",prop:"receivablePrice","min-width":"200",formatter:r(f)},null,8,["formatter"]),a(t,{label:"\u672A\u56DE\u6B3E\u91D1\u989D",align:"right","min-width":"200"},{default:o(i=>[d(u(r(m)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1}),a(t,{label:"\u56DE\u6B3E\u5B8C\u6210\u7387(%)",align:"right","min-width":"200",fixed:"right"},{default:o(i=>[d(u(r(m)(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1})]),_:1},8,["data"])),[[A,r(l)]])]),_:1})],64)}}});export{F as _};
