import{b as C,d as S}from"./index-C1TKk8vI.js";import{_ as j}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{c as z,d as E}from"./index-BLpDMWlm.js";import{g as G}from"./index-BtHQyrBm.js";import{k as K,ai as D,Q as M,x as O,h as Q,f as q,aj as B}from"./form-designer-BpYekVAY.js";import{x as H,r as n,y as i,E as c,F as u,O as o,u as s,K as y,G as J,z as L,M as N,a4 as P,l as T}from"./form-create-7GAbgMwl.js";const W=H({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(X,{expose:V,emit:b}){const{t:k}=C(),I=S(),m=n(!1),r=n(!1),e=n({id:-1,nickname:"",username:"",roleIds:[]}),t=n(),v=n([]);V({open:async d=>{m.value=!0,x(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,r.value=!0;try{e.value.roleIds=await z(d.id)}finally{r.value=!1}v.value=await G()}});const w=b,U=async()=>{if(t&&await t.value.validate()){r.value=!0;try{await E({userId:e.value.id,roleIds:e.value.roleIds}),I.success(k("common.updateSuccess")),m.value=!1,w("success",!0)}finally{r.value=!1}}},x=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,a)=>{const p=K,f=D,h=M,F=O,g=Q,_=q,R=j,A=B;return i(),c(R,{modelValue:s(m),"onUpdate:modelValue":a[4]||(a[4]=l=>T(m)?m.value=l:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:s(r),type:"primary",onClick:U},{default:u(()=>a[5]||(a[5]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),o(_,{onClick:a[3]||(a[3]=l=>m.value=!1)},{default:u(()=>a[6]||(a[6]=[y("\u53D6 \u6D88")])),_:1})]),default:u(()=>[J((i(),c(g,{ref_key:"formRef",ref:t,model:s(e),"label-width":"80px"},{default:u(()=>[o(f,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).username,"onUpdate:modelValue":a[0]||(a[0]=l=>s(e).username=l),disabled:!0},null,8,["modelValue"])]),_:1}),o(f,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).nickname,"onUpdate:modelValue":a[1]||(a[1]=l=>s(e).nickname=l),disabled:!0},null,8,["modelValue"])]),_:1}),o(f,{label:"\u89D2\u8272"},{default:u(()=>[o(F,{modelValue:s(e).roleIds,"onUpdate:modelValue":a[2]||(a[2]=l=>s(e).roleIds=l),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),L(N,null,P(s(v),l=>(i(),c(h,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[A,s(r)]])]),_:1},8,["modelValue"])}}});export{W as _};
