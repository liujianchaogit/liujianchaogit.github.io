import{_ as d,D as U,aV as j,a as J,d as X,h as Y,aW as D}from"./index-DiGvuAxb.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as ae}from"./index-BrNbcFk-.js";import{k as te,H as a,r as o,G as b,P as le,e as se,af as ne,l as O,m as y,z as s,u as l,Z as oe,$ as ie,y as A,A as re,E as i,h as ue}from"./form-create-D7wT855o.js";import{h as de}from"./tree-COGD3qag.js";import{b as me,d as ce,u as pe}from"./index-Bvk6TbIU.js";import{_ as ye}from"./MenuForm.vue_vue_type_script_setup_true_lang-CAAM1X4v.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{c as f}from"./permission-DHNmNb_V.js";import{C as M}from"./constants-C3gLHYOK.js";import{b3 as R,D as he,f as r,h as ke,ai as ve,k as we,x as _e,Q as xe,b1 as Ce,b2 as be}from"./form-designer-drfGvdgz.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import"./Tooltip.vue_vue_type_script_setup_true_lang-D7nG6-e5.js";import"./color-BN7ZL7BD.js";const Re=te({name:"SystemMenu",__name:"index",setup(Se){const S=[{key:"name",title:"\u83DC\u5355\u540D\u79F0",dataKey:"name",width:250,fixed:R.LEFT},{key:"icon",title:"\u56FE\u6807",dataKey:"icon",width:100,align:"center",cellRenderer:({cellData:t})=>a(d,{icon:t},null)},{key:"sort",title:"\u6392\u5E8F",dataKey:"sort",width:60},{key:"permission",title:"\u6743\u9650\u6807\u8BC6",dataKey:"permission",width:300},{key:"component",title:"\u7EC4\u4EF6\u8DEF\u5F84",dataKey:"component",width:500},{key:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0",dataKey:"componentName",width:200},{key:"status",title:"\u72B6\u6001",dataKey:"status",width:60,fixed:R.RIGHT,cellRenderer:({rowData:t})=>f(["system:menu:update"])?a(he,{modelValue:t.status,"onUpdate:modelValue":e=>t.status=e,"active-value":M.ENABLE,"inactive-value":M.DISABLE,loading:x[t.id],class:"ml-4px",onChange:e=>H(t,e)},null):a(fe,{type:U.COMMON_STATUS,value:t.status},null)},{key:"operations",title:"\u64CD\u4F5C",align:"center",width:160,fixed:R.RIGHT,cellRenderer:({rowData:t})=>{const e=[];return f(["system:menu:update"])&&e.push(a(r,{key:"edit",link:!0,type:"primary",onClick:()=>_("update",t.id)},{default:()=>[i("\u4FEE\u6539")]})),f(["system:menu:create"])&&e.push(a(r,{key:"create",link:!0,type:"primary",onClick:()=>_("create",void 0,t.id)},{default:()=>[i("\u65B0\u589E")]})),f(["system:menu:delete"])&&e.push(a(r,{key:"delete",link:!0,type:"danger",onClick:()=>G(t.id)},{default:()=>[i("\u5220\u9664")]})),e.length===0?null:a(b,null,[e])}}],{wsCache:K}=j(),{t:N}=J(),h=X(),T=o(!0),k=o([]),u=le({name:void 0,status:void 0}),V=o(),v=o(!1);o(!0);const m=o([]),c=async()=>{T.value=!0;try{const t=await me(u);k.value=de(t)}finally{T.value=!1}},w=()=>{c()},L=()=>{V.value.resetFields(),w()},g=o(),_=(t,e,p)=>{g.value.open(t,e,p)},B=()=>{v.value?m.value=[]:m.value=k.value.map(t=>t.id),v.value=!v.value},F=async()=>{try{await h.confirm("\u5373\u5C06\u66F4\u65B0\u7F13\u5B58\u5237\u65B0\u6D4F\u89C8\u5668\uFF01","\u5237\u65B0\u83DC\u5355\u7F13\u5B58"),K.delete(D.USER),K.delete(D.ROLE_ROUTERS),location.reload()}catch{}},G=async t=>{try{await h.delConfirm(),await ce(t),h.success(N("common.delSuccess")),await c()}catch{}},x=o({}),H=async(t,e)=>{x.value[t.id]=!0;try{t.status=e,await pe(t)}finally{x.value[t.id]=!1}};return se(()=>{c()}),(t,e)=>{const p=ae,I=we,C=ve,P=xe,q=_e,z=ke,E=ee,Q=be,W=Ce,Z=ne("hasPermi");return y(),O(b,null,[a(p,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(p,{title:"\u83DC\u5355\u8DEF\u7531",url:"https://doc.iocoder.cn/vue3/route/"}),a(E,null,{default:s(()=>[a(z,{ref_key:"queryFormRef",ref:V,inline:!0,model:l(u),class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(C,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:s(()=>[a(I,{modelValue:l(u).name,"onUpdate:modelValue":e[0]||(e[0]=n=>l(u).name=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:oe(w,["enter"])},null,8,["modelValue"])]),_:1}),a(C,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[a(q,{modelValue:l(u).status,"onUpdate:modelValue":e[1]||(e[1]=n=>l(u).status=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:s(()=>[(y(!0),O(b,null,ie(l(Y)(l(U).COMMON_STATUS),n=>(y(),A(P,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(C,null,{default:s(()=>[a(l(r),{onClick:w},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=i(" \u641C\u7D22 "))]),_:1}),a(l(r),{onClick:L},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=i(" \u91CD\u7F6E "))]),_:1}),re((y(),A(l(r),{plain:"",type:"primary",onClick:e[2]||(e[2]=n=>_("create"))},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=i(" \u65B0\u589E "))]),_:1})),[[Z,["system:menu:create"]]]),a(l(r),{plain:"",type:"danger",onClick:B},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:sort"}),e[7]||(e[7]=i(" \u5C55\u5F00/\u6298\u53E0 "))]),_:1}),a(l(r),{plain:"",onClick:F},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[8]||(e[8]=i(" \u5237\u65B0\u83DC\u5355\u7F13\u5B58 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(E,null,{default:s(()=>[a(W,null,{default:s(({width:n})=>[a(Q,{"expanded-row-keys":l(m),"onUpdate:expandedRowKeys":e[3]||(e[3]=$=>ue(m)?m.value=$:null),columns:S,data:l(k),"expand-column-key":S[0].key,height:1e3,width:n,fixed:"","row-key":"id"},null,8,["expanded-row-keys","data","expand-column-key","width"])]),_:1})]),_:1}),a(ye,{ref_key:"formRef",ref:g,onSuccess:c},null,512)],64)}}});export{Re as default};
