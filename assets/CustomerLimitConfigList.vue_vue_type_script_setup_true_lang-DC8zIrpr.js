import{d as R,a as z,_ as M,D as O}from"./index-DiGvuAxb.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as P}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{d as G}from"./formatTime-DeTj2b0K.js";import{L as v,_ as Q,g as D,d as F}from"./CustomerLimitConfigForm.vue_vue_type_script_setup_true_lang-Ckbi-SW-.js";import{f as Y,aj as B,_ as H,Z}from"./form-designer-drfGvdgz.js";import{k as q,r as d,P as J,e as K,af as V,l as W,m as p,G as X,H as t,A as g,z as n,E as y,y as f,u as l,C as $}from"./form-create-D7wT855o.js";const ee=q({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{}},setup(T){const k=R(),{t:I}=z(),_=d(!0),w=d(0),b=d([]),s=J({pageNo:1,pageSize:10,type:T.confType}),m=async()=>{_.value=!0;try{const o=await D(s);b.value=o.list,w.value=o.total}finally{_.value=!1}},N=d(),S=(o,e)=>{N.value.open(o,T.confType,e)},L=()=>{s.pageNo=1,m()};return K(()=>{m()}),(o,e)=>{const h=M,u=Y,i=H,x=P,E=Z,U=j,C=V("hasPermi"),A=B;return p(),W(X,null,[t(u,{plain:"",onClick:L},{default:n(()=>[t(h,{icon:"ep:refresh",class:"mr-5px"}),e[3]||(e[3]=y(" \u5237\u65B0 "))]),_:1}),g((p(),f(u,{type:"primary",plain:"",onClick:e[0]||(e[0]=a=>S("create"))},{default:n(()=>[t(h,{icon:"ep:plus",class:"mr-5px"}),e[4]||(e[4]=y(" \u65B0\u589E "))]),_:1})),[[C,["crm:customer-limit-config:create"]]]),g((p(),f(E,{data:l(b),stripe:!0,"show-overflow-tooltip":!0,class:"mt-4"},{default:n(()=>[t(i,{label:"\u7F16\u53F7",align:"center",prop:"id"}),t(i,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",align:"center",formatter:a=>{var r;return(r=a.users)==null?void 0:r.map(c=>c.nickname).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",align:"center",formatter:a=>{var r;return(r=a.depts)==null?void 0:r.map(c=>c.name).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:o.confType===l(v).CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",align:"center",prop:"maxCount"},null,8,["label"]),o.confType===l(v).CUSTOMER_QUANTITY_LIMIT?(p(),f(i,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",align:"center",prop:"dealCountEnabled","min-width":"100"},{default:n(a=>[t(x,{type:l(O).INFRA_BOOLEAN_STRING,value:a.row.dealCountEnabled},null,8,["type","value"])]),_:1})):$("",!0),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:l(G),width:"180px"},null,8,["formatter"]),t(i,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:n(a=>[g((p(),f(u,{link:"",type:"primary",onClick:r=>S("update",a.row.id)},{default:n(()=>e[5]||(e[5]=[y(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:update"]]]),g((p(),f(u,{link:"",type:"danger",onClick:r=>(async c=>{try{await k.delConfirm(),await F(c),k.success(I("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:n(()=>e[6]||(e[6]=[y(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[A,l(_)]]),t(U,{total:l(w),page:l(s).pageNo,"onUpdate:page":e[1]||(e[1]=a=>l(s).pageNo=a),limit:l(s).pageSize,"onUpdate:limit":e[2]||(e[2]=a=>l(s).pageSize=a),onPagination:m},null,8,["total","page","limit"]),t(Q,{ref_key:"formRef",ref:N,onSuccess:m},null,512)],64)}}});export{ee as _};
