import{p as _,S as K,_ as L,c as O}from"./index-DiGvuAxb.js";import{k as P,r as k,b as G,l as r,m as n,v as H,G as V,$,N as I,B as Q,H as N,u as M,C as R,F as T}from"./form-create-D7wT855o.js";const D=(s,w)=>{const[l,o]=[s.x,w.x].sort(),[a,v]=[s.y,w.y].sort(),p=o+1,f=v+1;return{left:l,right:p,top:a,bottom:f,height:f-a,width:p-l}},U={class:"relative"},W={class:"cube-table"},X=["onClick","onMouseenter"],Y=["onClick"],Z=["onClick"],ee={key:1},te=O(P({name:"MagicCubeEditor",__name:"index",props:{modelValue:K().isRequired,rows:_.number.def(4),cols:_.number.def(4),cubeSize:_.number.def(75)},emits:["update:modelValue","hotAreaSelected"],setup(s,{emit:w}){const l=s,o=k([]);G(()=>[l.rows,l.cols],()=>{if(o.value=[],l.rows&&l.cols)for(let i=0;i<l.rows;i++){o.value[i]=[];for(let e=0;e<l.cols;e++)o.value[i].push({x:e,y:i,active:!1})}},{immediate:!0});const a=k([]);G(()=>l.modelValue,()=>a.value=l.modelValue||[],{immediate:!0});const v=k(),p=()=>!!v.value,f=w,A=()=>f("update:modelValue",a),q=k(0),B=(i,e)=>{q.value=e,f("hotAreaSelected",i,e)};function x(){j((i,e,u)=>{u.active&&(u.active=!1)}),v.value=void 0}const j=i=>{for(let e=0;e<o.value.length;e++)for(let u=0;u<o.value[e].length;u++)i(e,u,o.value[e][u])};return(i,e)=>{const u=L;return n(),r("div",U,[H("table",W,[H("tbody",null,[(n(!0),r(V,null,$(M(o),(t,d)=>(n(),r("tr",{key:d},[(n(!0),r(V,null,$(t,(S,m)=>(n(),r("td",{key:m,class:Q(["cube",{active:S.active}]),style:I({width:`${s.cubeSize}px`,height:`${s.cubeSize}px`}),onClick:J=>((z,C)=>{const b=o.value[z][C];if(!p())return v.value=b,void(v.value.active=!0);a.value.push(D(v.value,b)),x();let c=a.value.length-1;B(a.value[c],c),A()})(d,m),onMouseenter:J=>((z,C)=>{if(!p())return;const b=D(v.value,o.value[z][C]);for(const E of a.value)if(h=b,(c=E).left<h.left+h.width&&c.left+c.width>h.left&&c.top<h.top+h.height&&c.height+c.top>h.top)return void x();var c,h;j((E,le,F)=>{var g,y;F.active=(g=b,(y=F).x>=g.left&&y.x<g.right&&y.y>=g.top&&y.y<g.bottom)})})(d,m)},[N(u,{icon:"ep-plus"})],46,X))),128))]))),128))]),(n(!0),r(V,null,$(M(a),(t,d)=>(n(),r("div",{key:d,class:"hot-area",style:I({top:s.cubeSize*t.top+"px",left:s.cubeSize*t.left+"px",height:s.cubeSize*t.height+"px",width:s.cubeSize*t.width+"px"}),onClick:S=>B(t,d),onMouseover:x},[M(q)===d&&t.width&&t.height?(n(),r("div",{key:0,class:"btn-delete",onClick:S=>(m=>{a.value.splice(m,1),x(),A()})(d)},[N(u,{icon:"ep:circle-close-filled"})],8,Z)):R("",!0),t.width?(n(),r("span",ee,T(`${t.width}\xD7${t.height}`),1)):R("",!0)],44,Y))),128))])])}}}),[["__scopeId","data-v-6ccd5352"]]);export{te as _};
