import{S as G,p as V,_ as K,c as N}from"./index-C1TKk8vI.js";import{x as P,r as k,f as J,y as r,z as n,C as L,M as _,a4 as M,H as Q,V as O,O as R,u as $,J as B,L as T}from"./form-create-7GAbgMwl.js";const D=(s,x)=>{const[l,a]=[s.x,x.x].sort(),[o,d]=[s.y,x.y].sort(),p=a+1,f=d+1;return{left:l,right:p,top:o,bottom:f,height:f-o,width:p-l}},U={class:"relative"},W={class:"cube-table"},X=["onClick","onMouseenter"],Y=["onClick"],Z=["onClick"],ee={key:1},te=N(P({name:"MagicCubeEditor",__name:"index",props:{modelValue:G().isRequired,rows:V.number.def(4),cols:V.number.def(4),cubeSize:V.number.def(75)},emits:["update:modelValue","hotAreaSelected"],setup(s,{emit:x}){const l=s,a=k([]);J(()=>[l.rows,l.cols],()=>{if(a.value=[],l.rows&&l.cols)for(let i=0;i<l.rows;i++){a.value[i]=[];for(let e=0;e<l.cols;e++)a.value[i].push({x:e,y:i,active:!1})}},{immediate:!0});const o=k([]);J(()=>l.modelValue,()=>o.value=l.modelValue||[],{immediate:!0});const d=k(),p=()=>!!d.value,f=x,A=()=>f("update:modelValue",o),q=k(0),E=(i,e)=>{q.value=e,f("hotAreaSelected",i,e)};function y(){j((i,e,u)=>{u.active&&(u.active=!1)}),d.value=void 0}const j=i=>{for(let e=0;e<a.value.length;e++)for(let u=0;u<a.value[e].length;u++)i(e,u,a.value[e][u])};return(i,e)=>{const u=K;return r(),n("div",U,[L("table",W,[L("tbody",null,[(r(!0),n(_,null,M($(a),(t,v)=>(r(),n("tr",{key:v},[(r(!0),n(_,null,M(t,(S,m)=>(r(),n("td",{key:m,class:Q(["cube",{active:S.active}]),style:O({width:`${s.cubeSize}px`,height:`${s.cubeSize}px`}),onClick:F=>((C,z)=>{const b=a.value[C][z];if(!p())return d.value=b,void(d.value.active=!0);o.value.push(D(d.value,b)),y();let c=o.value.length-1;E(o.value[c],c),A()})(v,m),onMouseenter:F=>((C,z)=>{if(!p())return;const b=D(d.value,a.value[C][z]);for(const H of o.value)if(h=b,(c=H).left<h.left+h.width&&c.left+c.width>h.left&&c.top<h.top+h.height&&c.height+c.top>h.top)return void y();var c,h;j((H,le,I)=>{var g,w;I.active=(g=b,(w=I).x>=g.left&&w.x<g.right&&w.y>=g.top&&w.y<g.bottom)})})(v,m)},[R(u,{icon:"ep-plus"})],46,X))),128))]))),128))]),(r(!0),n(_,null,M($(o),(t,v)=>(r(),n("div",{key:v,class:"hot-area",style:O({top:s.cubeSize*t.top+"px",left:s.cubeSize*t.left+"px",height:s.cubeSize*t.height+"px",width:s.cubeSize*t.width+"px"}),onClick:S=>E(t,v),onMouseover:y},[$(q)===v&&t.width&&t.height?(r(),n("div",{key:0,class:"btn-delete",onClick:S=>(m=>{o.value.splice(m,1),y(),A()})(v)},[R(u,{icon:"ep:circle-close-filled"})],8,Z)):B("",!0),t.width?(r(),n("span",ee,T(`${t.width}\xD7${t.height}`),1)):B("",!0)],44,Y))),128))])])}}}),[["__scopeId","data-v-6ccd5352"]]);export{te as _};
