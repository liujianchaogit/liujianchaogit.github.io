import{e as j,D as s,_ as q}from"./index-C1TKk8vI.js";import{_ as G}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as B}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{d as J,v as W,r as Z,t as X}from"./formatter-BBGnTCQg.js";import{g as ee}from"./couponTemplate-if6DBRiW.js";import{h as ae}from"./constants-IYPHa1Ih.js";import{k as le,ai as te,Q as oe,x as pe,f as ue,h as ne,$ as re,_ as ie,aj as se}from"./form-designer-BpYekVAY.js";import{x as me,r,X as ce,y as _,E as O,F as o,O as e,u as a,K as m,z as de,M as fe,a4 as _e,G as ye,L as Te,l as ve}from"./form-create-7GAbgMwl.js";const Oe=me({name:"CouponSelect",__name:"CouponSelect",props:{multipleSelection:{},takeType:{}},emits:["update:multipleSelection","change"],setup(U,{expose:x,emit:V}){const b=U,g=V,i=r(!1),E=r("\u9009\u62E9\u4F18\u60E0\u52B5"),I=r(!1),y=r(!0),S=r(0),h=r([]),p=ce({pageNo:1,pageSize:10,name:null,discountType:null,canTakeTypes:[ae.USER.type]}),c=r(),C=r([]),w=async()=>{y.value=!0;try{p.canTakeTypes=[b.takeType];const n=await ee(p);h.value=n.list,S.value=n.total}finally{y.value=!1}},T=()=>{p.pageNo=1,w()},k=()=>{var n;(n=c==null?void 0:c.value)==null||n.resetFields(),T()};x({open:async()=>{i.value=!0,k()}});const M=n=>{b.multipleSelection?g("update:multipleSelection",n):C.value=n},R=()=>{i.value=!1,g("change",C.value)};return(n,t)=>{const z=le,v=te,D=oe,F=pe,N=q,d=ue,K=ne,P=H,u=re,f=B,Y=ie,A=Q,L=G,$=se;return _(),O(L,{modelValue:a(i),"onUpdate:modelValue":t[5]||(t[5]=l=>ve(i)?i.value=l:null),title:a(E),width:"65%"},{footer:o(()=>[e(d,{disabled:a(I),type:"primary",onClick:R},{default:o(()=>t[8]||(t[8]=[m("\u786E \u5B9A")])),_:1},8,["disabled"]),e(d,{onClick:t[4]||(t[4]=l=>i.value=!1)},{default:o(()=>t[9]||(t[9]=[m("\u53D6 \u6D88")])),_:1})]),default:o(()=>[e(P,null,{default:o(()=>[e(K,{ref_key:"queryFormRef",ref:c,inline:!0,model:a(p),class:"-mb-15px","label-width":"82px"},{default:o(()=>[e(v,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:o(()=>[e(z,{modelValue:a(p).name,"onUpdate:modelValue":t[0]||(t[0]=l=>a(p).name=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",onKeyup:T},null,8,["modelValue"])]),_:1}),e(v,{label:"\u4F18\u60E0\u7C7B\u578B",prop:"discountType"},{default:o(()=>[e(F,{modelValue:a(p).discountType,"onUpdate:modelValue":t[1]||(t[1]=l=>a(p).discountType=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:o(()=>[(_(!0),de(fe,null,_e(a(j)(a(s).PROMOTION_DISCOUNT_TYPE),l=>(_(),O(D,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,null,{default:o(()=>[e(d,{onClick:T},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:search"}),t[6]||(t[6]=m(" \u641C\u7D22 "))]),_:1}),e(d,{onClick:k},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:refresh"}),t[7]||(t[7]=m(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:o(()=>[ye((_(),O(Y,{data:a(h),onSelectionChange:M},{default:o(()=>[e(u,{type:"selection",width:"55"}),e(u,{label:"\u4F18\u60E0\u5238\u540D\u79F0","min-width":"140",prop:"name"}),e(u,{label:"\u7C7B\u578B","min-width":"80",prop:"productScope"},{default:o(l=>[e(f,{type:a(s).PROMOTION_PRODUCT_SCOPE,value:l.row.productScope},null,8,["type","value"])]),_:1}),e(u,{label:"\u4F18\u60E0","min-width":"100",prop:"discount"},{default:o(l=>[e(f,{type:a(s).PROMOTION_DISCOUNT_TYPE,value:l.row.discountType},null,8,["type","value"]),m(" "+Te(a(J)(l.row)),1)]),_:1}),e(u,{label:"\u9886\u53D6\u65B9\u5F0F","min-width":"100",prop:"takeType"},{default:o(l=>[e(f,{type:a(s).PROMOTION_COUPON_TAKE_TYPE,value:l.row.takeType},null,8,["type","value"])]),_:1}),e(u,{formatter:a(W),align:"center",label:"\u4F7F\u7528\u65F6\u95F4",prop:"validityType",width:"185"},null,8,["formatter"]),e(u,{align:"center",label:"\u53D1\u653E\u6570\u91CF",prop:"totalCount"}),e(u,{formatter:a(Z),align:"center",label:"\u5269\u4F59\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),e(u,{formatter:a(X),align:"center",label:"\u9886\u53D6\u4E0A\u9650",prop:"takeLimitCount"},null,8,["formatter"]),e(u,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:o(l=>[e(f,{type:a(s).COMMON_STATUS,value:l.row.status},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[$,a(y)]]),e(A,{limit:a(p).pageSize,"onUpdate:limit":t[2]||(t[2]=l=>a(p).pageSize=l),page:a(p).pageNo,"onUpdate:page":t[3]||(t[3]=l=>a(p).pageNo=l),total:a(S),onPagination:w},null,8,["limit","page","total"])]),_:1})]),_:1},8,["modelValue","title"])}}});export{Oe as _};
