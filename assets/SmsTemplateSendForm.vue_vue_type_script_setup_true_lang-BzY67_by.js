import{d as x}from"./index-C1TKk8vI.js";import{_ as S}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{g as U,s as F}from"./index-DiKtCieb.js";import{k as q,ai as j,h as M,f as T,aj as z}from"./form-designer-BpYekVAY.js";import{x as E,r as i,X as G,y as c,E as f,F as m,O as u,u as t,K as y,G as K,z as O,M as R,a4 as X,l as A}from"./form-create-7GAbgMwl.js";const B=E({name:"SystemSmsTemplateSendForm",__name:"SmsTemplateSendForm",setup(D,{expose:V}){const _=x(),d=i(!1),p=i(!1),a=i({content:"",params:{},mobile:"",templateCode:"",templateParams:new Map}),v=G({mobile:[{required:!0,message:"\u624B\u673A\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateCode:[{required:!0,message:"\u6A21\u7248\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateParams:{}}),n=i();V({open:async s=>{d.value=!0,P(),p.value=!0;try{const e=await U(s);a.value.content=e.content,a.value.params=e.params,a.value.templateCode=e.code,a.value.templateParams=e.params.reduce((o,r)=>(o[r]="",o),{}),v.templateParams=e.params.reduce((o,r)=>(o[r]={required:!0,message:"\u53C2\u6570 "+r+" \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},o),{})}finally{p.value=!1}}});const g=async()=>{if(n&&await n.value.validate()){p.value=!0;try{const s=a.value,e=await F(s);e&&_.success("\u63D0\u4EA4\u53D1\u9001\u6210\u529F\uFF01\u53D1\u9001\u7ED3\u679C\uFF0C\u89C1\u53D1\u9001\u65E5\u5FD7\u7F16\u53F7\uFF1A"+e),d.value=!1}finally{p.value=!1}}},P=()=>{var s;a.value={content:"",params:{},mobile:"",templateCode:"",templateParams:new Map},(s=n.value)==null||s.resetFields()};return(s,e)=>{const o=q,r=j,h=M,b=T,w=S,C=z;return c(),f(w,{modelValue:t(d),"onUpdate:modelValue":e[3]||(e[3]=l=>A(d)?d.value=l:null),title:"\u6D4B\u8BD5"},{footer:m(()=>[u(b,{disabled:t(p),type:"primary",onClick:g},{default:m(()=>e[4]||(e[4]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),u(b,{onClick:e[2]||(e[2]=l=>d.value=!1)},{default:m(()=>e[5]||(e[5]=[y("\u53D6 \u6D88")])),_:1})]),default:m(()=>[K((c(),f(h,{ref_key:"formRef",ref:n,model:t(a),rules:t(v),"label-width":"140px"},{default:m(()=>[u(r,{label:"\u6A21\u677F\u5185\u5BB9",prop:"content"},{default:m(()=>[u(o,{modelValue:t(a).content,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).content=l),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u5185\u5BB9",readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1}),u(r,{label:"\u624B\u673A\u53F7",prop:"mobile"},{default:m(()=>[u(o,{modelValue:t(a).mobile,"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).mobile=l),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),_:1}),(c(!0),O(R,null,X(t(a).params,l=>(c(),f(r,{key:l,label:"\u53C2\u6570 {"+l+"}",prop:"templateParams."+l},{default:m(()=>[u(o,{modelValue:t(a).templateParams[l],"onUpdate:modelValue":k=>t(a).templateParams[l]=k,placeholder:"\u8BF7\u8F93\u5165 "+l+" \u53C2\u6570"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])),[[C,t(p)]])]),_:1},8,["modelValue"])}}});export{B as _};
