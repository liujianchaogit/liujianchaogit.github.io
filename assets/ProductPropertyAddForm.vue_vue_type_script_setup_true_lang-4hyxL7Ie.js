import{a as j,d as q}from"./index-DiGvuAxb.js";import{_ as z}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{k as E,r as n,P as G,b as H,y as c,m as i,u as s,h as M,z as u,A as Q,Z as R,M as D,H as p,l as S,G as Z,$,E as b}from"./form-create-D7wT855o.js";import{e as B,f as I}from"./property-CPQMPIru.js";import{h as J,ai as N,x as O,Q as T,aj as W,f as X}from"./form-designer-drfGvdgz.js";const Y=E({name:"ProductPropertyForm",__name:"ProductPropertyAddForm",props:{propertyList:{type:Array,default:()=>{}}},setup(k,{expose:x}){const{t:V}=j(),y=q(),t=n(!1),o=n(!1),a=n({name:""}),h=G({name:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),d=n(),m=n([]),f=n([]),P=k;H(()=>P.propertyList,l=>{l&&(m.value=l)},{deep:!0,immediate:!0}),x({open:async()=>{t.value=!0,g(),await F()}});const _=async()=>{for(const e of m.value)if(e.name===a.value.name)return y.error("\u8BE5\u5C5E\u6027\u5DF2\u5B58\u5728\uFF0C\u8BF7\u52FF\u91CD\u590D\u6DFB\u52A0");if(!d||!await d.value.validate())return;const l=f.value.find(e=>e.name===a.value.name);if(l)return m.value.push({id:l.id,...a.value,values:[]}),void(t.value=!1);o.value=!0;try{const e=a.value,v=await B(e);m.value.push({id:v,...a.value,values:[]}),y.success(V("common.createSuccess")),t.value=!1}finally{o.value=!1}},g=()=>{var l;a.value={name:""},(l=d.value)==null||l.resetFields()},F=async()=>{o.value=!0;try{f.value=await I()}finally{o.value=!1}};return(l,e)=>{const v=T,A=O,C=N,K=J,w=X,L=z,U=W;return i(),c(L,{modelValue:s(t),"onUpdate:modelValue":e[2]||(e[2]=r=>M(t)?t.value=r:null),title:"\u6DFB\u52A0\u5546\u54C1\u5C5E\u6027"},{footer:u(()=>[p(w,{disabled:s(o),type:"primary",onClick:_},{default:u(()=>e[3]||(e[3]=[b("\u786E \u5B9A")])),_:1},8,["disabled"]),p(w,{onClick:e[1]||(e[1]=r=>t.value=!1)},{default:u(()=>e[4]||(e[4]=[b("\u53D6 \u6D88")])),_:1})]),default:u(()=>[Q((i(),c(K,{ref_key:"formRef",ref:d,model:s(a),rules:s(h),"label-width":"80px",onKeydown:R(D(_,["prevent"]),["enter"])},{default:u(()=>[p(C,{label:"\u5C5E\u6027\u540D\u79F0",prop:"name"},{default:u(()=>[p(A,{modelValue:s(a).name,"onUpdate:modelValue":e[0]||(e[0]=r=>s(a).name=r),"reserve-keyword":!1,"allow-create":"",class:"!w-360px","default-first-option":"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5C5E\u6027\u540D\u79F0\u3002\u5982\u679C\u4E0D\u5B58\u5728\uFF0C\u53EF\u624B\u52A8\u8F93\u5165\u9009\u62E9"},{default:u(()=>[(i(!0),S(Z,null,$(s(f),r=>(i(),c(v,{key:r.id,label:r.name,value:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules","onKeydown"])),[[U,s(o)]])]),_:1},8,["modelValue"])}}});export{Y as _};
