import{u as O,d as T,_ as W,c as X}from"./index-DiGvuAxb.js";import{_ as Y}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{_ as $}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{k as ee,r,P as ae,Q as le,a6 as oe,af as te,l as S,m as d,H as a,z as l,v as g,y as h,u as o,M as se,Z as re,A as q,E as u,h as z,G as me}from"./form-create-D7wT855o.js";import{V as ne}from"./vuedraggable.umd-f2FZsIjZ.js";import{C as A}from"./index-2iWJkeed.js";import{a as ie}from"./index-PFHQ4aD1.js";import{_ as de}from"./CategoryForm.vue_vue_type_script_setup_true_lang-Bq0-QDAq.js";import ue from"./CategoryDraggableModel-BI4H0fnL.js";import{h as pe,ai as ce,k as fe,f as ye,a1 as _e,a2 as ve,a3 as xe,V as ge,aj as he,K as B}from"./form-designer-drfGvdgz.js";import"./constants-C3gLHYOK.js";import"./el-collapse-transition-l0sNRNKZ.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./formatTime-DeTj2b0K.js";import"./index-DTNfh8Br.js";import"./formCreate-DGy7HbUv.js";import"./permission-DHNmNb_V.js";const Ce={class:"flex justify-between pl-20px items-center"},be={key:1,class:"mr-20px"},ke={class:"px-15px"},we=X(ee({name:"BpmModel",__name:"index",setup(Ve){const{push:I}=O(),M=T(),y=r(!0),n=r(!1),p=ae({name:void 0}),U=r(),m=r([]),C=r([]),j=()=>{i()},_=r(!1),b=r({rule:[],option:{}}),k=r(),F=()=>{k.value.open("create")},K=()=>{C.value=B(m.value),n.value=!0},L=()=>{m.value=B(C.value),n.value=!1},P=async()=>{const c=m.value.map(e=>e.id);await A.updateCategorySortBatch(c),n.value=!1,M.success("\u6392\u5E8F\u5206\u7C7B\u6210\u529F"),await i()},i=async()=>{y.value=!0;try{const c=await ie(p.name),e=await A.getCategorySimpleList();m.value=e.map(s=>({...s,modelList:c.filter(v=>v.categoryName==s.name)}))}finally{y.value=!1}};return le(()=>{i()}),(c,e)=>{const s=W,v=fe,x=ce,f=ye,w=xe,R=ve,E=_e,G=pe,H=ge,V=$,J=oe("form-create"),N=Y,Q=te("hasPermi"),Z=he;return d(),S(me,null,[a(V,null,{default:l(()=>[g("div",Ce,[e[11]||(e[11]=g("h3",{class:"font-extrabold"},"\u6D41\u7A0B\u6A21\u578B",-1)),o(n)?(d(),S("div",be,[a(f,{onClick:L},{default:l(()=>e[9]||(e[9]=[u(" \u53D6 \u6D88 ")])),_:1}),a(f,{type:"primary",onClick:P},{default:l(()=>e[10]||(e[10]=[u(" \u4FDD\u5B58\u6392\u5E8F ")])),_:1})])):(d(),h(G,{key:0,class:"-mb-15px flex mr-10px",model:o(p),ref_key:"queryFormRef",ref:U,inline:!0,"label-width":"68px",onSubmit:e[3]||(e[3]=se(()=>{},["prevent"]))},{default:l(()=>[a(x,{prop:"name",class:"ml-auto"},{default:l(()=>[a(v,{modelValue:o(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>o(p).name=t),placeholder:"\u641C\u7D22\u6D41\u7A0B",clearable:"",onKeyup:re(j,["enter"]),class:"!w-240px"},{prefix:l(()=>[a(s,{icon:"ep:search",class:"mx-10px"})]),_:1},8,["modelValue"])]),_:1}),a(x,null,{default:l(()=>[q((d(),h(f,{type:"primary",onClick:e[1]||(e[1]=t=>{I({name:"BpmModelCreate"})})},{default:l(()=>[a(s,{icon:"ep:plus",class:"mr-5px"}),e[6]||(e[6]=u(" \u65B0\u5EFA\u6A21\u578B "))]),_:1})),[[Q,["bpm:model:create"]]])]),_:1}),a(x,null,{default:l(()=>[a(E,{onCommand:e[2]||(e[2]=t=>(D=>{switch(D){case"handleCategoryAdd":F();break;case"handleCategorySort":K()}})(t)),placement:"bottom-end"},{dropdown:l(()=>[a(R,null,{default:l(()=>[a(w,{command:"handleCategoryAdd"},{default:l(()=>[a(s,{icon:"ep:circle-plus",size:13,class:"mr-5px"}),e[7]||(e[7]=u(" \u65B0\u5EFA\u5206\u7C7B "))]),_:1}),a(w,{command:"handleCategorySort"},{default:l(()=>[a(s,{icon:"fa:sort-amount-desc",size:13,class:"mr-5px"}),e[8]||(e[8]=u(" \u5206\u7C7B\u6392\u5E8F "))]),_:1})]),_:1})]),default:l(()=>[a(f,{class:"w-30px",plain:""},{default:l(()=>[a(s,{icon:"ep:setting"})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))]),a(H),g("div",ke,[a(o(ne),{disabled:!o(n),modelValue:o(m),"onUpdate:modelValue":e[4]||(e[4]=t=>z(m)?m.value=t:null),"item-key":"id",animation:400},{item:l(({element:t})=>[q((d(),h(V,{class:"rounded-lg transition-all duration-300 ease-in-out hover:shadow-xl","body-style":{padding:0},key:t.id},{default:l(()=>[a(ue,{isCategorySorting:o(n),categoryInfo:t,onSuccess:i},null,8,["isCategorySorting","categoryInfo"])]),_:2},1024)),[[Z,o(y)]])]),_:1},8,["disabled","modelValue"])])]),_:1}),a(de,{ref_key:"categoryFormRef",ref:k,onSuccess:i},null,512),a(N,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:o(_),"onUpdate:modelValue":e[5]||(e[5]=t=>z(_)?_.value=t:null),width:"800"},{default:l(()=>[a(J,{rule:o(b).rule,option:o(b).option},null,8,["rule","option"])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-d65242ea"]]);export{we as default};
