import{u as oe,e as w,D as h,as as te,_ as re}from"./index-C1TKk8vI.js";import{_ as de}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as ue}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as ie}from"./index-BhsNgP9o.js";import{x as se,r as s,X as pe,f as me,j as ne,aq as ce,y as d,z as p,O as o,F as t,u as l,M as m,a4 as y,E as u,J as T,a5 as ve,G as g,P as ye,K as k,C as fe}from"./form-create-7GAbgMwl.js";import{_ as _e}from"./OrderDeliveryForm.vue_vue_type_script_setup_true_lang-D0U_Vl7p.js";import{_ as be}from"./OrderUpdateRemarkForm.vue_vue_type_script_setup_true_lang-CjLSUkBt.js";import{e as ke}from"./index-DsFOJog9.js";import{a as Ve}from"./index-DCZ6sajB.js";import{g as he}from"./index-CyioDjMj.js";import{D as x,T as Ue}from"./constants-IYPHa1Ih.js";import Ce from"./OrderTableColumn-BXG0dvHE.js";import{Q as we,x as Te,ai as ge,F as xe,k as Ee,f as Pe,h as Ie,a4 as De,a3 as Se,a2 as Re,_ as qe,aj as Ne}from"./form-designer-BpYekVAY.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./formatTime-EbFUBcAO.js";const Ye={class:"flex items-center justify-center"},Ae=se({name:"TradeOrder",__name:"index",setup(Oe){const{currentRoute:J,push:X}=oe(),E=s(!0),S=s(2),P=s([]),R=s(),r=s({pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0}),V=pe({queryParam:""}),q=s([{value:"no",label:"\u8BA2\u5355\u53F7"},{value:"userId",label:"\u7528\u6237UID"},{value:"userNickname",label:"\u7528\u6237\u6635\u79F0"},{value:"userMobile",label:"\u7528\u6237\u7535\u8BDD"}]),G=n=>{var a;(a=q.value.filter(f=>f.value!==n))==null||a.forEach(f=>{r.value.hasOwnProperty(f.value)&&delete r.value[f.value]})},_=async()=>{E.value=!0;try{const n=await ke(l(r));P.value=n.list,S.value=n.total}finally{E.value=!1}},I=async()=>{r.value.pageNo=1,await _()},Q=()=>{var n;(n=R.value)==null||n.resetFields(),r.value={pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0},I()},N=s(),Y=s();me(()=>J.value,()=>{_()});const D=s([]),A=s([]);return ne(async()=>{await _(),D.value=await Ve(),A.value=await he()}),(n,a)=>{const f=ie,c=we,v=Te,i=ge,B=xe,O=Ee,b=re,U=Pe,W=Ie,F=ue,z=De,Z=Se,$=Re,ee=qe,le=de,M=ce("hasPermi"),ae=Ne;return d(),p(m,null,[o(f,{title:"\u3010\u4EA4\u6613\u3011\u4EA4\u6613\u8BA2\u5355",url:"https://doc.iocoder.cn/mall/trade-order/"}),o(f,{title:"\u3010\u4EA4\u6613\u3011\u8D2D\u7269\u8F66",url:"https://doc.iocoder.cn/mall/trade-cart/"}),o(F,null,{default:t(()=>[o(W,{ref_key:"queryFormRef",ref:R,inline:!0,model:l(r),class:"-mb-15px","label-width":"68px"},{default:t(()=>[o(i,{label:"\u8BA2\u5355\u72B6\u6001",prop:"status"},{default:t(()=>[o(v,{modelValue:l(r).status,"onUpdate:modelValue":a[0]||(a[0]=e=>l(r).status=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(w)(l(h).TRADE_ORDER_STATUS),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"\u652F\u4ED8\u65B9\u5F0F",prop:"payChannelCode"},{default:t(()=>[o(v,{modelValue:l(r).payChannelCode,"onUpdate:modelValue":a[1]||(a[1]=e=>l(r).payChannelCode=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(te)(l(h).PAY_CHANNEL_CODE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:t(()=>[o(B,{modelValue:l(r).createTime,"onUpdate:modelValue":a[2]||(a[2]=e=>l(r).createTime=e),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-280px","end-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4","start-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),o(i,{label:"\u8BA2\u5355\u6765\u6E90",prop:"terminal"},{default:t(()=>[o(v,{modelValue:l(r).terminal,"onUpdate:modelValue":a[3]||(a[3]=e=>l(r).terminal=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(w)(l(h).TERMINAL),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"\u8BA2\u5355\u7C7B\u578B",prop:"type"},{default:t(()=>[o(v,{modelValue:l(r).type,"onUpdate:modelValue":a[4]||(a[4]=e=>l(r).type=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(w)(l(h).TRADE_ORDER_TYPE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"\u914D\u9001\u65B9\u5F0F",prop:"deliveryType"},{default:t(()=>[o(v,{modelValue:l(r).deliveryType,"onUpdate:modelValue":a[5]||(a[5]=e=>l(r).deliveryType=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(w)(l(h).TRADE_DELIVERY_TYPE),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r).deliveryType===l(x).EXPRESS.type?(d(),u(i,{key:0,label:"\u5FEB\u9012\u516C\u53F8",prop:"logisticsId"},{default:t(()=>[o(v,{modelValue:l(r).logisticsId,"onUpdate:modelValue":a[6]||(a[6]=e=>l(r).logisticsId=e),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(A),e=>(d(),u(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),l(r).deliveryType===l(x).PICK_UP.type?(d(),u(i,{key:1,label:"\u81EA\u63D0\u95E8\u5E97",prop:"pickUpStoreId"},{default:t(()=>[o(v,{modelValue:l(r).pickUpStoreId,"onUpdate:modelValue":a[7]||(a[7]=e=>l(r).pickUpStoreId=e),class:"!w-280px",clearable:"",multiple:"",placeholder:"\u5168\u90E8"},{default:t(()=>[(d(!0),p(m,null,y(l(D),e=>(d(),u(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),l(r).deliveryType===l(x).PICK_UP.type?(d(),u(i,{key:2,label:"\u6838\u9500\u7801",prop:"pickUpVerifyCode"},{default:t(()=>[o(O,{modelValue:l(r).pickUpVerifyCode,"onUpdate:modelValue":a[8]||(a[8]=e=>l(r).pickUpVerifyCode=e),class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u81EA\u63D0\u6838\u9500\u7801",onKeyup:ve(I,["enter"])},null,8,["modelValue"])]),_:1})):T("",!0),o(i,{label:"\u805A\u5408\u641C\u7D22"},{default:t(()=>[g(o(O,{modelValue:l(r)[l(V).queryParam],"onUpdate:modelValue":a[10]||(a[10]=e=>l(r)[l(V).queryParam]=e),type:l(V).queryParam==="userId"?"number":"text",class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165"},{prepend:t(()=>[o(v,{modelValue:l(V).queryParam,"onUpdate:modelValue":a[9]||(a[9]=e=>l(V).queryParam=e),class:"!w-110px",clearable:"",placeholder:"\u5168\u90E8",onChange:G},{default:t(()=>[(d(!0),p(m,null,y(l(q),e=>(d(),u(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","type"]),[[ye,!0]])]),_:1}),o(i,null,{default:t(()=>[o(U,{onClick:I},{default:t(()=>[o(b,{class:"mr-5px",icon:"ep:search"}),a[13]||(a[13]=k(" \u641C\u7D22 "))]),_:1}),o(U,{onClick:Q},{default:t(()=>[o(b,{class:"mr-5px",icon:"ep:refresh"}),a[14]||(a[14]=k(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(F,null,{default:t(()=>[g((d(),u(ee,{data:l(P),"row-key":"id"},{default:t(()=>[o(l(Ce),{list:l(P),"pick-up-store-list":l(D)},{default:t(({row:e})=>[fe("div",Ye,[g((d(),u(U,{link:"",type:"primary",onClick:K=>{return C=e.id,void X({name:"TradeOrderDetail",params:{id:C}});var C}},{default:t(()=>[o(b,{icon:"ep:notification"}),a[15]||(a[15]=k(" \u8BE6\u60C5 "))]),_:2},1032,["onClick"])),[[M,["trade:order:query"]]]),g((d(),u($,{onCommand:K=>((C,L)=>{var j,H;switch(C){case"remark":(j=Y.value)==null||j.open(L);break;case"delivery":(H=N.value)==null||H.open(L)}})(K,e)},{dropdown:t(()=>[o(Z,null,{default:t(()=>[e.deliveryType===l(x).EXPRESS.type&&e.status===l(Ue).UNDELIVERED.status?(d(),u(z,{key:0,command:"delivery"},{default:t(()=>[o(b,{icon:"ep:takeaway-box"}),a[17]||(a[17]=k(" \u53D1\u8D27 "))]),_:1})):T("",!0),o(z,{command:"remark"},{default:t(()=>[o(b,{icon:"ep:chat-line-square"}),a[18]||(a[18]=k(" \u5907\u6CE8 "))]),_:1})]),_:2},1024)]),default:t(()=>[o(U,{link:"",type:"primary"},{default:t(()=>[o(b,{icon:"ep:d-arrow-right"}),a[16]||(a[16]=k(" \u66F4\u591A "))]),_:1})]),_:2},1032,["onCommand"])),[[M,["trade:order:update"]]])])]),_:1},8,["list","pick-up-store-list"])]),_:1},8,["data"])),[[ae,l(E)]]),o(le,{limit:l(r).pageSize,"onUpdate:limit":a[11]||(a[11]=e=>l(r).pageSize=e),page:l(r).pageNo,"onUpdate:page":a[12]||(a[12]=e=>l(r).pageNo=e),total:l(S),onPagination:_},null,8,["limit","page","total"])]),_:1}),o(_e,{ref_key:"deliveryFormRef",ref:N,onSuccess:_},null,512),o(be,{ref_key:"updateRemarkForm",ref:Y,onSuccess:_},null,512)],64)}}});export{Ae as default};
