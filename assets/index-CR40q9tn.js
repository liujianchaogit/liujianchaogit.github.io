import{d as j,u as q,h as B}from"./index-C1TKk8vI.js";import{g as G,_ as I}from"./index-ArudIG2A.js";import{u as J}from"./tagsView-C2oS-OQq.js";import{g as K,t as P}from"./index-uXIyVRuV.js";import{_ as Q}from"./ClueForm.vue_vue_type_script_setup_true_lang-BRstRBEx.js";import{_ as V}from"./ClueDetailsHeader.vue_vue_type_script_setup_true_lang-B9noLk9v.js";import{_ as W}from"./ClueDetailsInfo.vue_vue_type_script_setup_true_lang-Epo-7YII.js";import{_ as H}from"./PermissionList.vue_vue_type_script_setup_true_lang-BPeTlrGi.js";import{_ as X}from"./TransferForm.vue_vue_type_script_setup_true_lang-5gdfxDt4.js";import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-Cc1LpVql.js";import{B as f}from"./index-BuK0ap75.js";import{f as N,a0 as Y,a1 as Z,j as aa}from"./form-designer-BpYekVAY.js";import{x as ea,r as s,j as ia,y as m,z as ra,O as e,F as i,u as a,G as ta,E as d,K as c,J as E,M as la,aq as oa}from"./form-create-7GAbgMwl.js";import"./formatTime-EbFUBcAO.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-R1Ohxk4X.js";import"./tree-COGD3qag.js";import"./index-CZiMqbPE.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-C_qKaUAE.js";import"./index-DLPyhh9r.js";import"./index-C_v5t3_7.js";import"./index-Bdw660V1.js";import"./index-DdKGlDdM.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-De4klYft.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DrAuCfpX.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-B-IANjnk.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-D8lenXv5.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-C-tbO4kY.js";import"./index-2SiQtehE.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-w8Q4BfL1.js";import"./index-C69xrZfi.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-Cgo1EbLC.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-DNhdDOrK.js";const sa=ea({name:"CrmClueDetail",__name:"index",setup(ma){const l=s(0),_=s(!0),y=j(),{delView:L}=J(),{currentRoute:M}=q(),u=s(),o=s({}),v=async()=>{_.value=!0;try{o.value=await K(l.value),await S()}finally{_.value=!1}},z=s(),h=()=>{var r;(r=z.value)==null||r.open("update",l.value)},C=s(),x=()=>{var r;(r=C.value)==null||r.open(l.value)},O=async()=>{await y.confirm(`\u786E\u5B9A\u5C06\u3010${o.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await P(l.value),y.success(`\u8F6C\u5316\u5BA2\u6237\u3010${o.value.name}\u3011\u6210\u529F`),await v()},w=s([]),S=async()=>{const r=await G({bizType:f.CRM_CLUE,bizId:l.value});w.value=r.list},b=()=>{L(a(M))},{params:k}=B();return ia(()=>{if(!k.id)return y.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void b();l.value=k.id,v()}),(r,t)=>{const p=N,n=Y,D=I,F=Z,T=aa,$=oa("hasPermi");return m(),ra(la,null,[e(V,{clue:a(o),loading:a(_)},{default:i(()=>{var g,R,U;return[(g=a(u))!=null&&g.validateWrite?ta((m(),d(p,{key:0,type:"primary",onClick:h},{default:i(()=>t[0]||(t[0]=[c(" \u7F16\u8F91 ")])),_:1})),[[$,["crm:clue:update"]]]):E("",!0),(R=a(u))!=null&&R.validateOwnerUser?(m(),d(p,{key:1,type:"primary",onClick:x},{default:i(()=>t[1]||(t[1]=[c(" \u8F6C\u79FB ")])),_:1})):E("",!0),(U=a(u))!=null&&U.validateOwnerUser&&!a(o).transformStatus?(m(),d(p,{key:2,type:"success",onClick:O},{default:i(()=>t[2]||(t[2]=[c(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")])),_:1})):(m(),d(p,{key:3,disabled:"",type:"success"},{default:i(()=>t[3]||(t[3]=[c("\u5DF2\u8F6C\u5316\u5BA2\u6237")])),_:1}))]}),_:1},8,["clue","loading"]),e(T,null,{default:i(()=>[e(F,null,{default:i(()=>[e(n,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[e(A,{"biz-id":a(l),"biz-type":a(f).CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u57FA\u672C\u4FE1\u606F"},{default:i(()=>[e(W,{clue:a(o)},null,8,["clue"])]),_:1}),e(n,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[e(H,{ref_key:"permissionListRef",ref:u,"biz-id":a(o).id,"biz-type":a(f).CRM_CLUE,"show-action":!0,onQuitTeam:b},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[e(D,{"log-list":a(w)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(Q,{ref_key:"formRef",ref:z,onSuccess:v},null,512),e(X,{ref_key:"transferFormRef",ref:C,"biz-type":a(f).CRM_CLUE,onSuccess:b},null,8,["biz-type"])],64)}}});export{sa as default};
