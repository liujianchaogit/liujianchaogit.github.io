import{d as Q,b as X,e as H,D as P,G as I,_ as J}from"./index-C1TKk8vI.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as Z}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as aa}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as ea}from"./index-BhsNgP9o.js";import{x as ta,r as d,X as la,j as oa,aq as ia,y as p,z as V,O as a,F as l,u as o,a5 as ra,M as D,a4 as pa,E as c,K as s,G as f,L as x}from"./form-create-7GAbgMwl.js";import{f as O,d as sa}from"./formatTime-EbFUBcAO.js";import{a as na,b as ma,d as ua}from"./combinationActivity-DsCd1-D3.js";import{_ as ca}from"./CombinationActivityForm.vue_vue_type_script_setup_true_lang-CaggMNBB.js";import{f as da}from"./formatter-Cy2d_MRj.js";import{k as fa,ai as wa,Q as _a,x as ba,f as ya,h as ha,$ as ka,ak as va,_ as ga,aj as xa}from"./form-designer-BpYekVAY.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./Form-D57Ko41z.js";import"./InputPassword-C2NBtECC.js";import"./tsxHelper-C4ukkQNk.js";import"./formRules-NkbEJCk0.js";import"./useCrudSchemas-CYXvU7P5.js";import"./tree-COGD3qag.js";import"./SpuSelect.vue_vue_type_script_setup_true_lang-CCllmZHn.js";import"./index-DK77YGos.js";import"./SkuList.vue_vue_type_script_setup_true_lang-Bof6RkjR.js";import"./category-BHM6Cffl.js";import"./spu-75LBH-4N.js";import"./SpuAndSkuList.vue_vue_type_script_setup_true_lang-B3bd3U-D.js";const Ca=ta({name:"PromotionBargainActivity",__name:"index",setup(Ma){const w=Q(),{t:z}=X(),b=d(!0),C=d(0),M=d([]),r=la({pageNo:1,pageSize:10,name:null,status:null}),S=d(),m=async()=>{b.value=!0;try{const n=await na(r);M.value=n.list,C.value=n.total}finally{b.value=!1}},y=()=>{r.pageNo=1,m()},A=()=>{S.value.resetFields(),y()},N=d(),U=(n,t)=>{N.value.open(n,t)},F=n=>{const t=Math.min(...n.map(h=>h.combinationPrice));return`\uFFE5${I(t)}`};return oa(async()=>{await m()}),(n,t)=>{const h=ea,R=fa,k=wa,j=_a,q=ba,v=J,u=ya,G=ha,Y=aa,i=ka,K=va,$=Z,B=ga,E=W,_=ia("hasPermi"),L=xa;return p(),V(D,null,[a(h,{title:"\u3010\u8425\u9500\u3011\u62FC\u56E2\u6D3B\u52A8",url:"https://doc.iocoder.cn/mall/promotion-combination/"}),a(Y,null,{default:l(()=>[a(G,{ref_key:"queryFormRef",ref:S,inline:!0,model:o(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[a(k,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name"},{default:l(()=>[a(R,{modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=e=>o(r).name=e),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0",onKeyup:ra(y,["enter"])},null,8,["modelValue"])]),_:1}),a(k,{label:"\u6D3B\u52A8\u72B6\u6001",prop:"status"},{default:l(()=>[a(q,{modelValue:o(r).status,"onUpdate:modelValue":t[1]||(t[1]=e=>o(r).status=e),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u72B6\u6001"},{default:l(()=>[(p(!0),V(D,null,pa(o(H)(o(P).COMMON_STATUS),e=>(p(),c(j,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(k,null,{default:l(()=>[a(u,{onClick:y},{default:l(()=>[a(v,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=s(" \u641C\u7D22 "))]),_:1}),a(u,{onClick:A},{default:l(()=>[a(v,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=s(" \u91CD\u7F6E "))]),_:1}),f((p(),c(u,{plain:"",type:"primary",onClick:t[2]||(t[2]=e=>U("create"))},{default:l(()=>[a(v,{class:"mr-5px",icon:"ep:plus"}),t[7]||(t[7]=s(" \u65B0\u589E "))]),_:1})),[[_,["promotion:combination-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(Y,null,{default:l(()=>[f((p(),c(B,{data:o(M),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[a(i,{label:"\u6D3B\u52A8\u7F16\u53F7","min-width":"80",prop:"id"}),a(i,{label:"\u6D3B\u52A8\u540D\u79F0","min-width":"140",prop:"name"}),a(i,{label:"\u6D3B\u52A8\u65F6\u95F4","min-width":"210"},{default:l(e=>[s(x(o(O)(e.row.startTime,"YYYY-MM-DD"))+" ~ "+x(o(O)(e.row.endTime,"YYYY-MM-DD")),1)]),_:1}),a(i,{label:"\u5546\u54C1\u56FE\u7247","min-width":"80",prop:"spuName"},{default:l(e=>[a(K,{"preview-src-list":[e.row.picUrl],src:e.row.picUrl,class:"h-40px w-40px","preview-teleported":""},null,8,["preview-src-list","src"])]),_:1}),a(i,{label:"\u5546\u54C1\u6807\u9898","min-width":"300",prop:"spuName"}),a(i,{formatter:o(da),label:"\u539F\u4EF7","min-width":"100",prop:"marketPrice"},null,8,["formatter"]),a(i,{label:"\u62FC\u56E2\u4EF7","min-width":"100",prop:"seckillPrice"},{default:l(e=>[s(x(F(e.row.products)),1)]),_:1}),a(i,{label:"\u5F00\u56E2\u7EC4\u6570","min-width":"100",prop:"groupCount"}),a(i,{label:"\u6210\u56E2\u7EC4\u6570","min-width":"100",prop:"groupSuccessCount"}),a(i,{label:"\u8D2D\u4E70\u6B21\u6570","min-width":"100",prop:"recordCount"}),a(i,{align:"center",label:"\u6D3B\u52A8\u72B6\u6001","min-width":"100",prop:"status"},{default:l(e=>[a($,{type:o(P).COMMON_STATUS,value:e.row.status},null,8,["type","value"])]),_:1}),a(i,{formatter:o(sa),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),a(i,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"150px"},{default:l(e=>[f((p(),c(u,{link:"",type:"primary",onClick:T=>U("update",e.row.id)},{default:l(()=>t[8]||(t[8]=[s(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:update"]]]),e.row.status===0?f((p(),c(u,{key:0,link:"",type:"danger",onClick:T=>(async g=>{try{await w.confirm("\u786E\u8BA4\u5173\u95ED\u8BE5\u62FC\u56E2\u6D3B\u52A8\u5417\uFF1F"),await ma(g),w.success("\u5173\u95ED\u6210\u529F"),await m()}catch{}})(e.row.id)},{default:l(()=>t[9]||(t[9]=[s(" \u5173\u95ED ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:close"]]]):f((p(),c(u,{key:1,link:"",type:"danger",onClick:T=>(async g=>{try{await w.delConfirm(),await ua(g),w.success(z("common.delSuccess")),await m()}catch{}})(e.row.id)},{default:l(()=>t[10]||(t[10]=[s(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["promotion:combination-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[L,o(b)]]),a(E,{limit:o(r).pageSize,"onUpdate:limit":t[3]||(t[3]=e=>o(r).pageSize=e),page:o(r).pageNo,"onUpdate:page":t[4]||(t[4]=e=>o(r).pageNo=e),total:o(C),onPagination:m},null,8,["limit","page","total"])]),_:1}),a(ca,{ref_key:"formRef",ref:N,onSuccess:m},null,512)],64)}}});export{Ca as default};
