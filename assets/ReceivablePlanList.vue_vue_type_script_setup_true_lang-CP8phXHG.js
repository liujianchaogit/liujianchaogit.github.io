import{au as D,d as E,b as F,_ as G}from"./index-C1TKk8vI.js";import{_ as K}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{g as O,d as X}from"./index-DZT3uREC.js";import{_ as $}from"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-zqCBcaAo.js";import{b as C}from"./formatTime-EbFUBcAO.js";import{f as A,i as B,$ as H,_ as J,aj as Q}from"./form-designer-BpYekVAY.js";import{x as V,r as u,X as W,f as Y,y as s,z as Z,O as a,F as c,K as f,G as g,u as i,E as b,M as ee,aq as ae}from"./form-create-7GAbgMwl.js";const re=V({name:"CrmReceivablePlanList",__name:"ReceivablePlanList",props:{customerId:{},contractId:{}},emits:["createReceivable"],setup(N,{emit:S}){const r=N,w=E(),{t:P}=F(),v=u(!0),_=u(0),y=u([]),t=W({pageNo:1,pageSize:10,customerId:void 0,contractId:void 0}),d=async()=>{v.value=!0;try{r.customerId&&!r.contractId?t.customerId=r.customerId:r.customerId&&r.contractId&&(t.customerId=r.customerId,t.contractId=r.contractId);const n=await O(t);y.value=n.list,_.value=n.total}finally{v.value=!1}},k=u(),h=(n,e)=>{k.value.open(n,e,r.customerId,r.contractId)},R=S;return Y(()=>[r.customerId,r.contractId],n=>{n[0]&&(t.pageNo=1,t.customerId=void 0,t.contractId=void 0,d())},{immediate:!0,deep:!0}),(n,e)=>{const z=G,p=A,U=B,o=H,j=J,L=M,T=K,I=ae("hasPermi"),q=Q;return s(),Z(ee,null,[a(U,{justify:"end"},{default:c(()=>[a(p,{onClick:e[0]||(e[0]=l=>h("create",void 0))},{default:c(()=>[a(z,{class:"mr-5px",icon:"icon-park:income"}),e[3]||(e[3]=f(" \u521B\u5EFA\u56DE\u6B3E\u8BA1\u5212 "))]),_:1})]),_:1}),a(T,{class:"mt-10px"},{default:c(()=>[g((s(),b(j,{data:i(y),"show-overflow-tooltip":!0,stripe:!0},{default:c(()=>[a(o,{align:"center",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"150px"}),a(o,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"200px"}),a(o,{align:"center",label:"\u671F\u6570",prop:"period"}),a(o,{align:"center",label:"\u8BA1\u5212\u56DE\u6B3E(\u5143)",prop:"price",width:"120",formatter:i(D)},null,8,["formatter"]),a(o,{formatter:i(C),align:"center",label:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"180px"},null,8,["formatter"]),a(o,{align:"center",label:"\u63D0\u524D\u51E0\u5929\u63D0\u9192",prop:"remindDays",width:"150"}),a(o,{formatter:i(C),align:"center",label:"\u63D0\u9192\u65E5\u671F",prop:"remindTime",width:"180px"},null,8,["formatter"]),a(o,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),a(o,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(o,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"200px"},{default:c(l=>[g((s(),b(p,{link:"",type:"primary",onClick:x=>{return m=l.row,void R("createReceivable",m);var m},disabled:l.row.receivableId},{default:c(()=>e[4]||(e[4]=[f(" \u521B\u5EFA\u56DE\u6B3E ")])),_:2},1032,["onClick","disabled"])),[[I,["crm:receivable:create"]]]),g((s(),b(p,{link:"",type:"primary",onClick:x=>h("update",l.row.id)},{default:c(()=>e[5]||(e[5]=[f(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[I,["crm:receivable-plan:update"]]]),g((s(),b(p,{link:"",type:"danger",onClick:x=>(async m=>{try{await w.delConfirm(),await X(m),w.success(P("common.delSuccess")),await d()}catch{}})(l.row.id)},{default:c(()=>e[6]||(e[6]=[f(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[I,["crm:receivable-plan:delete"]]])]),_:1})]),_:1},8,["data"])),[[q,i(v)]]),a(L,{limit:i(t).pageSize,"onUpdate:limit":e[1]||(e[1]=l=>i(t).pageSize=l),page:i(t).pageNo,"onUpdate:page":e[2]||(e[2]=l=>i(t).pageNo=l),total:i(_),onPagination:d},null,8,["limit","page","total"])]),_:1}),a($,{ref_key:"formRef",ref:k,onSuccess:d},null,512)],64)}}});export{re as _};
