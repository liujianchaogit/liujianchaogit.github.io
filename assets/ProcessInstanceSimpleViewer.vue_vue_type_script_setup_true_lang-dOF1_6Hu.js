import{p as S}from"./index-DiGvuAxb.js";import{T as e}from"./index-7o_S5bjn.js";import{a as i}from"./consts-CvaDWb4S.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{aj as v}from"./form-designer-drfGvdgz.js";import{_ as I}from"./simple-process-designer-DszNnWcD.js";import{u as f}from"./node-CQ9Ble-i.js";import{k as E,r as u,b as O,y as P,m,u as y,p as A,A as D,l as V,H as w}from"./form-create-D7wT855o.js";const C=E({name:"SimpleProcessViewer",__name:"SimpleProcessViewer",props:{flowNode:{type:Object,required:!0},tasks:{type:Array,default:()=>[]},processInstance:{type:Object,default:()=>{}}},setup(N){const c=N,r=u(c.tasks),p=u(c.processInstance),T=f(c);return O(()=>c.tasks,n=>{r.value=n}),O(()=>c.processInstance,n=>{p.value=n}),A("tasks",r),A("processInstance",p),(n,t)=>{const s=I;return m(),P(s,{"flow-node":y(T),readonly:!0},null,8,["flow-node"])}}}),k={class:"process-viewer-container"},H=E({name:"BpmProcessInstanceSimpleViewer",__name:"ProcessInstanceSimpleViewer",props:{loading:S.bool.def(!1),modelView:S.object,simpleJson:S.string},setup(N){const c=N,r=u({}),p=u([]),T=u();O(()=>c.modelView,async t=>{var s;if(t){p.value=t.tasks,T.value=t.processInstance;const o=t.rejectedTaskActivityIds,d=t.unfinishedTaskActivityIds,a=t.finishedTaskActivityIds,l=t.finishedSequenceFlowActivityIds;n(t.simpleModel,(s=t.processInstance)==null?void 0:s.status,o,d,a,l),r.value=t.simpleModel?t.simpleModel:{}}}),O(()=>c.simpleJson,async t=>{t&&(r.value=JSON.parse(t))});const n=(t,s,o,d,a,l)=>{var _;t&&(t.type!==i.END_EVENT_NODE?(t.type!==i.START_USER_NODE&&t.type!==i.USER_TASK_NODE&&t.type!==i.TRANSACTOR_NODE&&t.type!==i.CHILD_PROCESS_NODE||(t.activityStatus=e.NOT_START,o.includes(t.id)?t.activityStatus=e.REJECT:d.includes(t.id)?t.activityStatus=e.RUNNING:a.includes(t.id)&&(t.activityStatus=e.APPROVE)),t.type===i.COPY_TASK_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.DELAY_TIMER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.TRIGGER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.CONDITION_NODE&&(l.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type!==i.CONDITION_BRANCH_NODE&&t.type!==i.PARALLEL_BRANCH_NODE&&t.type!==i.INCLUSIVE_BRANCH_NODE&&t.type!==i.ROUTER_BRANCH_NODE||(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START,(_=t.conditionNodes)==null||_.forEach(R=>{n(R,s,o,d,a,l)})),n(t.childNode,s,o,d,a,l)):a.includes(t.id)?t.activityStatus=s:t.activityStatus=e.NOT_START)};return(t,s)=>{const o=v;return D((m(),V("div",k,[w(y(C),{"flow-node":y(r),tasks:y(p),"process-instance":y(T)},null,8,["flow-node","tasks","process-instance"])])),[[o,N.loading]])}}});export{H as _};
