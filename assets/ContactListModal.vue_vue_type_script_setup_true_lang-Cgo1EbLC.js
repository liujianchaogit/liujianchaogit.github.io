import{D as T,d as $,u as H,_ as J}from"./index-C1TKk8vI.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as Y}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as Z}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{x as ee,r as t,X as ae,y,E as v,F as l,O as a,K as m,u as s,a5 as le,G as R,L as oe,l as se,aq as re}from"./form-create-7GAbgMwl.js";import{g as te}from"./index-C_v5t3_7.js";import{_ as ne}from"./ContactForm.vue_vue_type_script_setup_true_lang-DNhdDOrK.js";import{k as ie,ai as pe,f as me,h as ue,$ as ce,P as de,_ as fe,aj as _e}from"./form-designer-BpYekVAY.js";const ge=ee({name:"ContactListModal",__name:"ContactListModal",props:{customerId:{}},emits:["success"],setup(S,{expose:V,emit:U}){const z=$(),b=S,n=t(!1),d=t(!0),w=t(0),C=t([]),h=t(),F=t(!1),r=ae({pageNo:1,pageSize:10,name:void 0,customerId:b.customerId});V({open:async()=>{n.value=!0,r.customerId=b.customerId,await c()}});const c=async()=>{d.value=!0;try{const i=await te(r);C.value=i.list,w.value=i.total}finally{d.value=!1}},f=()=>{r.pageNo=1,c()},L=()=>{h.value.resetFields(),f()},x=t(),D=U,_=t(),O=async()=>{const i=_.value.getSelectionRows().map(e=>e.id);if(i.length===0)return z.error("\u672A\u9009\u62E9\u8054\u7CFB\u4EBA");n.value=!1,D("success",i,_.value.getSelectionRows())},{push:P}=H();return(i,e)=>{const q=ie,k=pe,g=J,u=me,A=ue,N=Z,p=ce,E=de,G=Y,K=fe,M=W,X=Q,j=re("hasPermi"),B=_e;return y(),v(X,{modelValue:s(n),"onUpdate:modelValue":e[5]||(e[5]=o=>se(n)?n.value=o:null),title:"\u5173\u8054\u8054\u7CFB\u4EBA"},{footer:l(()=>[a(u,{disabled:s(F),type:"primary",onClick:O},{default:l(()=>e[9]||(e[9]=[m("\u786E \u5B9A")])),_:1},8,["disabled"]),a(u,{onClick:e[4]||(e[4]=o=>n.value=!1)},{default:l(()=>e[10]||(e[10]=[m("\u53D6 \u6D88")])),_:1})]),default:l(()=>[a(N,null,{default:l(()=>[a(A,{ref_key:"queryFormRef",ref:h,inline:!0,model:s(r),class:"-mb-15px","label-width":"90px"},{default:l(()=>[a(k,{label:"\u8054\u7CFB\u4EBA\u540D\u79F0",prop:"name"},{default:l(()=>[a(q,{modelValue:s(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>s(r).name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u540D\u79F0",onKeyup:le(f,["enter"])},null,8,["modelValue"])]),_:1}),a(k,null,{default:l(()=>[a(u,{onClick:f},{default:l(()=>[a(g,{class:"mr-5px",icon:"ep:search"}),e[6]||(e[6]=m(" \u641C\u7D22 "))]),_:1}),a(u,{onClick:L},{default:l(()=>[a(g,{class:"mr-5px",icon:"ep:refresh"}),e[7]||(e[7]=m(" \u91CD\u7F6E "))]),_:1}),R((y(),v(u,{type:"primary",onClick:e[1]||(e[1]=o=>{x.value.open("create")})},{default:l(()=>[a(g,{class:"mr-5px",icon:"ep:plus"}),e[8]||(e[8]=m(" \u65B0\u589E "))]),_:1})),[[j,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(N,{class:"mt-10px"},{default:l(()=>[R((y(),v(K,{ref_key:"contactRef",ref:_,data:s(C),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[a(p,{type:"selection",width:"55"}),a(p,{align:"center",fixed:"left",label:"\u59D3\u540D",prop:"name"},{default:l(o=>[a(E,{underline:!1,type:"primary",onClick:ye=>{return I=o.row.id,void P({name:"CrmContactDetail",params:{id:I}});var I}},{default:l(()=>[m(oe(o.row.name),1)]),_:2},1032,["onClick"])]),_:1}),a(p,{align:"center",label:"\u624B\u673A\u53F7",prop:"mobile"}),a(p,{align:"center",label:"\u804C\u4F4D",prop:"post"}),a(p,{align:"center",label:"\u76F4\u5C5E\u4E0A\u7EA7",prop:"parentName"}),a(p,{align:"center",label:"\u662F\u5426\u5173\u952E\u51B3\u7B56\u4EBA","min-width":"100",prop:"master"},{default:l(o=>[a(G,{type:s(T).INFRA_BOOLEAN_STRING,value:o.row.master},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[B,s(d)]]),a(M,{limit:s(r).pageSize,"onUpdate:limit":e[2]||(e[2]=o=>s(r).pageSize=o),page:s(r).pageNo,"onUpdate:page":e[3]||(e[3]=o=>s(r).pageNo=o),total:s(w),onPagination:c},null,8,["limit","page","total"])]),_:1}),a(ne,{ref_key:"formRef",ref:x,onSuccess:c},null,512)]),_:1},8,["modelValue"])}}});export{ge as _};
