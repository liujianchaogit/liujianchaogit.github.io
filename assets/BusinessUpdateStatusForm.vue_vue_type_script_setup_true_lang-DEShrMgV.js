import{b as z,d as B}from"./index-C1TKk8vI.js";import{_ as D}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{e as E}from"./index-DLPyhh9r.js";import{D as G,a as K}from"./index-2SiQtehE.js";import{Q as M,x as O,ai as Q,h as R,f as T,aj as X}from"./form-designer-BpYekVAY.js";import{x as A,r,X as H,y as o,E as v,F as u,O as m,K as y,u as l,G as J,z as _,a4 as b,M as S,l as L}from"./form-create-7GAbgMwl.js";const N=A({__name:"BusinessUpdateStatusForm",emits:["success"],setup(P,{expose:I,emit:k}){z();const w=B(),d=r(!1),i=r(!1),t=r({id:void 0,statusId:void 0,endStatus:void 0,status:void 0}),V=H({status:[{required:!0,message:"\u5546\u673A\u9636\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),n=r(),f=r([]);I({open:async s=>{d.value=!0,g(),t.value={id:s.id,statusId:s.statusId,endStatus:s.endStatus,status:s.endStatus!=null?-s.endStatus:s.statusId},i.value=!0;try{f.value=await K(s.statusTypeId)}finally{i.value=!1}}});const x=k,h=async()=>{if(n&&await n.value.validate()){i.value=!0;try{await E({id:t.value.id,statusId:t.value.status>0?t.value.status:void 0,endStatus:t.value.status<0?-t.value.status:void 0}),w.success("\u66F4\u65B0\u5546\u673A\u72B6\u6001\u6210\u529F"),d.value=!1,x("success")}finally{i.value=!1}}},g=()=>{var s;t.value={id:void 0,statusId:void 0,endStatus:void 0,status:void 0},(s=n.value)==null||s.resetFields()};return(s,e)=>{const p=M,F=O,U=Q,C=R,c=T,j=D,q=X;return o(),v(j,{title:"\u53D8\u66F4\u5546\u673A\u72B6\u6001",modelValue:l(d),"onUpdate:modelValue":e[2]||(e[2]=a=>L(d)?d.value=a:null),width:"400"},{footer:u(()=>[m(c,{onClick:h,type:"primary",disabled:l(i)},{default:u(()=>e[3]||(e[3]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),m(c,{onClick:e[1]||(e[1]=a=>d.value=!1)},{default:u(()=>e[4]||(e[4]=[y("\u53D6 \u6D88")])),_:1})]),default:u(()=>[J((o(),v(C,{ref_key:"formRef",ref:n,model:l(t),rules:l(V),"label-width":"80px"},{default:u(()=>[m(U,{label:"\u5546\u673A\u9636\u6BB5",prop:"status"},{default:u(()=>[m(F,{modelValue:l(t).status,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).status=a),placeholder:"\u8BF7\u9009\u62E9\u5546\u673A\u9636\u6BB5",class:"w-1/1"},{default:u(()=>[(o(!0),_(S,null,b(l(f),a=>(o(),v(p,{key:a.id,label:a.name+"(\u8D62\u5355\u7387\uFF1A"+a.percent+"%)",value:a.id},null,8,["label","value"]))),128)),(o(!0),_(S,null,b(G,a=>(o(),v(p,{key:a.endStatus,label:a.name+"(\u8D62\u5355\u7387\uFF1A"+a.percent+"%)",value:-a.endStatus},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[q,l(i)]])]),_:1},8,["modelValue"])}}});export{N as _};
