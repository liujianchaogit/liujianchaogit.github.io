import{_ as d,D as U,aV as J,b as Y,d as Z,e as $,aW as O}from"./index-C1TKk8vI.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as ae}from"./index-BhsNgP9o.js";import{x as te,O as a,K as o,M as C,r as i,X as le,j as se,aq as ne,y,z as D,F as s,u as l,a5 as oe,a4 as ie,E as M,G as re,l as ue}from"./form-create-7GAbgMwl.js";import{h as de}from"./tree-COGD3qag.js";import{d as me,u as ce,b as pe}from"./index-DvrIs0Uy.js";import{_ as ye}from"./MenuForm.vue_vue_type_script_setup_true_lang-BK6k27Df.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{c as f}from"./permission-0vfiopec.js";import{C as N}from"./constants-IYPHa1Ih.js";import{b3 as R,D as he,f as r,k as ke,ai as ve,Q as we,x as _e,h as xe,b1 as be,b2 as Ce}from"./form-designer-BpYekVAY.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./Tooltip.vue_vue_type_script_setup_true_lang-CTZOMnhL.js";import"./color-BN7ZL7BD.js";const Re=te({name:"SystemMenu",__name:"index",setup(Ke){const K=[{key:"name",title:"\u83DC\u5355\u540D\u79F0",dataKey:"name",width:250,fixed:R.LEFT},{key:"icon",title:"\u56FE\u6807",dataKey:"icon",width:100,align:"center",cellRenderer:({cellData:t})=>a(d,{icon:t},null)},{key:"sort",title:"\u6392\u5E8F",dataKey:"sort",width:60},{key:"permission",title:"\u6743\u9650\u6807\u8BC6",dataKey:"permission",width:300},{key:"component",title:"\u7EC4\u4EF6\u8DEF\u5F84",dataKey:"component",width:500},{key:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0",dataKey:"componentName",width:200},{key:"status",title:"\u72B6\u6001",dataKey:"status",width:60,fixed:R.RIGHT,cellRenderer:({rowData:t})=>f(["system:menu:update"])?a(he,{modelValue:t.status,"onUpdate:modelValue":e=>t.status=e,"active-value":N.ENABLE,"inactive-value":N.DISABLE,loading:x[t.id],class:"ml-4px",onChange:e=>I(t,e)},null):a(fe,{type:U.COMMON_STATUS,value:t.status},null)},{key:"operations",title:"\u64CD\u4F5C",align:"center",width:160,fixed:R.RIGHT,cellRenderer:({rowData:t})=>{const e=[];return f(["system:menu:update"])&&e.push(a(r,{key:"edit",link:!0,type:"primary",onClick:()=>_("update",t.id)},{default:()=>[o("\u4FEE\u6539")]})),f(["system:menu:create"])&&e.push(a(r,{key:"create",link:!0,type:"primary",onClick:()=>_("create",void 0,t.id)},{default:()=>[o("\u65B0\u589E")]})),f(["system:menu:delete"])&&e.push(a(r,{key:"delete",link:!0,type:"danger",onClick:()=>H(t.id)},{default:()=>[o("\u5220\u9664")]})),e.length===0?null:a(C,null,[e])}}],{wsCache:S}=J(),{t:A}=Y(),h=Z(),T=i(!0),k=i([]),u=le({name:void 0,status:void 0}),V=i(),v=i(!1);i(!0);const m=i([]),c=async()=>{T.value=!0;try{const t=await pe(u);k.value=de(t)}finally{T.value=!1}},w=()=>{c()},F=()=>{V.value.resetFields(),w()},g=i(),_=(t,e,p)=>{g.value.open(t,e,p)},L=()=>{v.value?m.value=[]:m.value=k.value.map(t=>t.id),v.value=!v.value},G=async()=>{try{await h.confirm("\u5373\u5C06\u66F4\u65B0\u7F13\u5B58\u5237\u65B0\u6D4F\u89C8\u5668\uFF01","\u5237\u65B0\u83DC\u5355\u7F13\u5B58"),S.delete(O.USER),S.delete(O.ROLE_ROUTERS),location.reload()}catch{}},H=async t=>{try{await h.delConfirm(),await me(t),h.success(A("common.delSuccess")),await c()}catch{}},x=i({}),I=async(t,e)=>{x.value[t.id]=!0;try{t.status=e,await ce(t)}finally{x.value[t.id]=!1}};return se(()=>{c()}),(t,e)=>{const p=ae,q=ke,b=ve,B=we,j=_e,z=xe,E=ee,P=be,Q=Ce,W=ne("hasPermi");return y(),D(C,null,[a(p,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(p,{title:"\u83DC\u5355\u8DEF\u7531",url:"https://doc.iocoder.cn/vue3/route/"}),a(E,null,{default:s(()=>[a(z,{ref_key:"queryFormRef",ref:V,inline:!0,model:l(u),class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(b,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:s(()=>[a(q,{modelValue:l(u).name,"onUpdate:modelValue":e[0]||(e[0]=n=>l(u).name=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:oe(w,["enter"])},null,8,["modelValue"])]),_:1}),a(b,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[a(j,{modelValue:l(u).status,"onUpdate:modelValue":e[1]||(e[1]=n=>l(u).status=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:s(()=>[(y(!0),D(C,null,ie(l($)(l(U).COMMON_STATUS),n=>(y(),M(B,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(b,null,{default:s(()=>[a(l(r),{onClick:w},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=o(" \u641C\u7D22 "))]),_:1}),a(l(r),{onClick:F},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=o(" \u91CD\u7F6E "))]),_:1}),re((y(),M(l(r),{plain:"",type:"primary",onClick:e[2]||(e[2]=n=>_("create"))},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=o(" \u65B0\u589E "))]),_:1})),[[W,["system:menu:create"]]]),a(l(r),{plain:"",type:"danger",onClick:L},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:sort"}),e[7]||(e[7]=o(" \u5C55\u5F00/\u6298\u53E0 "))]),_:1}),a(l(r),{plain:"",onClick:G},{default:s(()=>[a(l(d),{class:"mr-5px",icon:"ep:refresh"}),e[8]||(e[8]=o(" \u5237\u65B0\u83DC\u5355\u7F13\u5B58 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(E,null,{default:s(()=>[a(Q,null,{default:s(({width:n})=>[a(P,{"expanded-row-keys":l(m),"onUpdate:expandedRowKeys":e[3]||(e[3]=X=>ue(m)?m.value=X:null),columns:K,data:l(k),"expand-column-key":K[0].key,height:1e3,width:n,fixed:"","row-key":"id"},null,8,["expanded-row-keys","data","expand-column-key","width"])]),_:1})]),_:1}),a(ye,{ref_key:"formRef",ref:g,onSuccess:c},null,512)],64)}}});export{Re as default};
