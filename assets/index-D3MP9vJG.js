import{d as H,a as K,u as I,_ as J,D as L}from"./index-DiGvuAxb.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as X}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{_ as Y}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as $}from"./index-BrNbcFk-.js";import{k as ee,r as s,P as ae,b as le,e as te,a6 as oe,af as re,l as ie,m as n,H as a,z as l,u as t,Z as ne,A as u,E as p,y as d,h as pe,G as me}from"./form-create-D7wT855o.js";import{d as se}from"./formatTime-DeTj2b0K.js";import{b as ue,d as de,g as ce}from"./index-DTNfh8Br.js";import{b as fe}from"./formCreate-DGy7HbUv.js";import{h as _e,ai as ye,k as be,f as ge,Z as ke,_ as we,aj as Ce}from"./form-designer-drfGvdgz.js";import"./color-BN7ZL7BD.js";const he=ee({name:"BpmForm",__name:"index",setup(ve){const S=H(),{t:T}=K(),{currentRoute:O,push:P}=I(),g=s(!0),V=s(0),N=s([]),r=ae({pageNo:1,pageSize:10,name:null}),U=s(),c=async()=>{g.value=!0;try{const f=await ue(r);N.value=f.list,V.value=f.total}finally{g.value=!1}},k=()=>{r.pageNo=1,c()},Z=()=>{U.value.resetFields(),k()},w=(f,e)=>{const b={name:"BpmFormEditor",query:{type:f}};typeof e!="number"&&typeof e!="string"||(b.query.id=e),P(b)},y=s(!1),C=s({rule:[],option:{}});return le(()=>O.value,()=>{c()},{immediate:!0}),te(()=>{c()}),(f,e)=>{const b=$,A=be,q=ye,h=J,i=ge,B=_e,z=Y,m=we,E=X,G=ke,M=W,R=oe("form-create"),j=Q,_=re("hasPermi"),D=Ce;return n(),ie(me,null,[a(b,{title:"\u5BA1\u6279\u63A5\u5165\uFF08\u6D41\u7A0B\u8868\u5355\uFF09",url:"https://doc.iocoder.cn/bpm/use-bpm-form/"}),a(z,null,{default:l(()=>[a(B,{ref_key:"queryFormRef",ref:U,inline:!0,model:t(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[a(q,{label:"\u8868\u5355\u540D",prop:"name"},{default:l(()=>[a(A,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(r).name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D",onKeyup:ne(k,["enter"])},null,8,["modelValue"])]),_:1}),a(q,null,{default:l(()=>[a(i,{onClick:k},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=p(" \u641C\u7D22 "))]),_:1}),a(i,{onClick:Z},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=p(" \u91CD\u7F6E "))]),_:1}),u((n(),d(i,{plain:"",type:"primary",onClick:w},{default:l(()=>[a(h,{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=p(" \u65B0\u589E "))]),_:1})),[[_,["bpm:form:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(z,null,{default:l(()=>[u((n(),d(G,{data:t(N)},{default:l(()=>[a(m,{align:"center",label:"\u7F16\u53F7",prop:"id"}),a(m,{align:"center",label:"\u8868\u5355\u540D",prop:"name"}),a(m,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:l(o=>[a(E,{type:t(L).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),a(m,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(m,{formatter:t(se),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},null,8,["formatter"]),a(m,{align:"center",label:"\u64CD\u4F5C"},{default:l(o=>[u((n(),d(i,{link:"",type:"primary",onClick:v=>w("copy",o.row.id)},{default:l(()=>e[7]||(e[7]=[p(" \u590D\u5236 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((n(),d(i,{link:"",type:"primary",onClick:v=>w("update",o.row.id)},{default:l(()=>e[8]||(e[8]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:update"]]]),u((n(),d(i,{link:"",onClick:v=>(async x=>{const F=await ce(x);fe(C,F.conf,F.fields),y.value=!0})(o.row.id)},{default:l(()=>e[9]||(e[9]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:query"]]]),u((n(),d(i,{link:"",type:"danger",onClick:v=>(async x=>{try{await S.delConfirm(),await de(x),S.success(T("common.delSuccess")),await c()}catch{}})(o.row.id)},{default:l(()=>e[10]||(e[10]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["bpm:form:delete"]]])]),_:1})]),_:1},8,["data"])),[[D,t(g)]]),a(M,{limit:t(r).pageSize,"onUpdate:limit":e[1]||(e[1]=o=>t(r).pageSize=o),page:t(r).pageNo,"onUpdate:page":e[2]||(e[2]=o=>t(r).pageNo=o),total:t(V),onPagination:c},null,8,["limit","page","total"])]),_:1}),a(j,{modelValue:t(y),"onUpdate:modelValue":e[3]||(e[3]=o=>pe(y)?y.value=o:null),title:"\u8868\u5355\u8BE6\u60C5",width:"800"},{default:l(()=>[a(R,{option:t(C).option,rule:t(C).rule},null,8,["option","rule"])]),_:1},8,["modelValue"])],64)}}});export{he as default};
