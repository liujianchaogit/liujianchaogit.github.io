import{D as I,u as R,h as G,c as J}from"./index-C1TKk8vI.js";import{_ as K}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import{_ as $}from"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import{_ as H}from"./index-BhsNgP9o.js";import{d as Q}from"./formatTime-EbFUBcAO.js";import{g as W}from"./index-CxCrYW_I.js";import{b as Z}from"./formCreate-DNZv5C32.js";import{B as g}from"./constants-IYPHa1Ih.js";import{$ as aa,ak as ea,a7 as ta,o as la,f as oa,a6 as ra,_ as na,aj as ia}from"./form-designer-BpYekVAY.js";import{x as sa,r as u,X as ma,j as pa,y as r,z as M,O as e,F as t,G as P,u as l,E as s,J as da,K as f,L as m,C as x,l as ua,M as fa,ae as ca,aq as ya}from"./form-create-7GAbgMwl.js";import"./color-BN7ZL7BD.js";const _a={key:2},wa=J(sa({name:"BpmProcessDefinition",__name:"index",setup(ka){const{push:b}=R(),{query:N}=G(),y=u(!0),C=u(0),v=u([]),p=ma({pageNo:1,pageSize:10,key:N.key}),U=async()=>{y.value=!0;try{const i=await W(p);v.value=i.list,C.value=i.total}finally{y.value=!1}},c=u(!1),_=u({rule:[],option:{}}),T=async i=>{i.formType==g.NORMAL?(Z(_,i.formConf,i.formFields),c.value=!0):await b({path:i.formCustomCreatePath})};return pa(()=>{U()}),(i,o)=>{const O=H,n=aa,j=ea,w=ta,q=la,z=$,k=oa,B=ra,L=na,S=Y,D=X,E=ca("form-create"),V=K,A=ya("hasPermi"),F=ia;return r(),M(fa,null,[e(O,{title:"\u5DE5\u4F5C\u6D41\u624B\u518C",url:"https://doc.iocoder.cn/bpm/"}),e(D,null,{default:t(()=>[P((r(),s(L,{data:l(v)},{default:t(()=>[e(n,{label:"\u5B9A\u4E49\u7F16\u53F7",align:"center",prop:"id","min-width":"250"}),e(n,{label:"\u6D41\u7A0B\u540D\u79F0",align:"center",prop:"name","min-width":"150"}),e(n,{label:"\u6D41\u7A0B\u56FE\u6807",align:"center","min-width":"50"},{default:t(({row:a})=>[a.icon?(r(),s(j,{key:0,src:a.icon,class:"h-24px w-24pxrounded"},null,8,["src"])):da("",!0)]),_:1}),e(n,{label:"\u53EF\u89C1\u8303\u56F4",prop:"startUserIds","min-width":"100"},{default:t(({row:a})=>{var d;return[(d=a.startUsers)!=null&&d.length?a.startUsers.length===1?(r(),s(w,{key:1},{default:t(()=>[f(m(a.startUsers[0].nickname),1)]),_:2},1024)):(r(),s(w,{key:2},{default:t(()=>[e(q,{class:"box-item",effect:"dark",placement:"top",content:a.startUsers.map(h=>h.nickname).join("\u3001")},{default:t(()=>[f(m(a.startUsers[0].nickname)+"\u7B49 "+m(a.startUsers.length)+" \u4EBA\u53EF\u89C1 ",1)]),_:2},1032,["content"])]),_:2},1024)):(r(),s(w,{key:0},{default:t(()=>o[3]||(o[3]=[f(" \u5168\u90E8\u53EF\u89C1 ")])),_:1}))]}),_:1}),e(n,{label:"\u6D41\u7A0B\u7C7B\u578B",prop:"modelType","min-width":"120"},{default:t(({row:a})=>[e(z,{value:a.modelType,type:l(I).BPM_MODEL_TYPE},null,8,["value","type"])]),_:1}),e(n,{label:"\u8868\u5355\u4FE1\u606F",prop:"formType","min-width":"150"},{default:t(a=>[a.row.formType===l(g).NORMAL?(r(),s(k,{key:0,type:"primary",link:"",onClick:d=>T(a.row)},{default:t(()=>[x("span",null,m(a.row.formName),1)]),_:2},1032,["onClick"])):a.row.formType===l(g).CUSTOM?(r(),s(k,{key:1,type:"primary",link:"",onClick:d=>T(a.row)},{default:t(()=>[x("span",null,m(a.row.formCustomCreatePath),1)]),_:2},1032,["onClick"])):(r(),M("label",_a,"\u6682\u65E0\u8868\u5355"))]),_:1}),e(n,{label:"\u6D41\u7A0B\u7248\u672C",align:"center","min-width":"80"},{default:t(a=>[e(B,null,{default:t(()=>[f("v"+m(a.row.version),1)]),_:2},1024)]),_:1}),e(n,{label:"\u90E8\u7F72\u65F6\u95F4",align:"center",prop:"deploymentTime",width:"180",formatter:l(Q)},null,8,["formatter"]),e(n,{label:"\u64CD\u4F5C",align:"center"},{default:t(a=>[P((r(),s(k,{link:"",type:"primary",onClick:d=>(async h=>{await b({name:"BpmModelUpdate",params:{id:h,type:"definition"}})})(a.row.id)},{default:t(()=>o[4]||(o[4]=[f(" \u6062\u590D ")])),_:2},1032,["onClick"])),[[A,["bpm:model:update"]]])]),_:1})]),_:1},8,["data"])),[[F,l(y)]]),e(S,{total:l(C),page:l(p).pageNo,"onUpdate:page":o[0]||(o[0]=a=>l(p).pageNo=a),limit:l(p).pageSize,"onUpdate:limit":o[1]||(o[1]=a=>l(p).pageSize=a),onPagination:U},null,8,["total","page","limit"])]),_:1}),e(V,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:l(c),"onUpdate:modelValue":o[2]||(o[2]=a=>ua(c)?c.value=a:null),width:"800"},{default:t(()=>[e(E,{rule:l(_).rule,option:l(_).option},null,8,["rule","option"])]),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-e8a0c358"]]);export{wa as default};
