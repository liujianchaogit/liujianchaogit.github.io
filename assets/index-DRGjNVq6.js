import{V as y,d as Y,_ as $}from"./index-DiGvuAxb.js";import{_ as B}from"./index-BrNbcFk-.js";import{_ as J}from"./ReplyForm.vue_vue_type_script_setup_true_lang-CpxjT9fh.js";import{R as k}from"./TabNews-D-FaOhZv.js";import"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import"./main-CdM2KXdt.js";import"./main-BGh45ysb.js";import"./main.vue_vue_type_script_setup_true_lang-DBhac8-A.js";import{h as L,ai as W,a0 as X,i as Z,j as ee,f as ae,$ as le,v as te}from"./form-designer-drfGvdgz.js";import"./main-IGdPYDx_.js";import"./useUpload-Bn-ruquy.js";import"./TabImage-FZyWfbXj.js";import"./TabVoice-Bn6aKj5C.js";import"./TabVideo-Bn1_7Qo2.js";import"./main-I-G8Vrj-.js";import{_ as se}from"./main.vue_vue_type_script_setup_true_lang-CGoZ6TCQ.js";import{_ as D}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{_ as oe}from"./ReplyTable.vue_vue_type_script_setup_true_lang-CCB8VJ4O.js";import{M as c}from"./types-CAO1T7C7.js";import{k as re,r as p,P as ue,af as pe,l as ie,m as A,H as l,z as s,u as t,h,A as ne,C as de,y as me,E as v,G as ce}from"./form-create-D7wT855o.js";import"./index-B5z0KHO1.js";import"./index-BXtMzGO2.js";import"./formatTime-DeTj2b0K.js";import"./TabText.vue_vue_type_script_setup_true_lang-D41KAlt6.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-DbyC1m1-.js";import"./index-YBGE2sI_.js";import"./tagsView-B3xQDSQ0.js";import"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import"./color-BN7ZL7BD.js";import"./main-DI9h-5Ia.js";const ve=re({name:"MpAutoReply",__name:"index",setup(ye){const f=Y(),q=p(-1),u=p(c.Keyword),U=p(!0),K=p(0),I=p([]),w=p(null),i=ue({pageNo:1,pageSize:10,accountId:q}),b=p(!1),n=p(!1),r=p({}),o=p({type:k.Text,accountId:-1}),R=a=>{q.value=a,o.value.accountId=a,i.pageNo=1,M()},M=async()=>{U.value=!0;try{const e=await(a={...i,type:u.value},y.get({url:"/mp/auto-reply/page",params:a}));I.value=e.list,K.value=e.total}finally{U.value=!1}var a},F=a=>{u.value=a,i.pageNo=1,M()},H=()=>{T(),o.value={type:k.Text,accountId:i.accountId},b.value=!0,n.value=!0},N=async a=>{T();const e=await(m=>y.get({url:"/mp/auto-reply/get?id="+m}))(a);r.value={...e},delete r.value.responseMessageType,delete r.value.responseContent,delete r.value.responseMediaId,delete r.value.responseMediaUrl,delete r.value.responseDescription,delete r.value.responseArticles,o.value={type:e.responseMessageType,accountId:i.accountId,content:e.responseContent,mediaId:e.responseMediaId,url:e.responseMediaUrl,title:e.responseTitle,description:e.responseDescription,thumbMediaId:e.responseThumbMediaId,thumbMediaUrl:e.responseThumbMediaUrl,articles:e.responseArticles,musicUrl:e.responseMusicUrl,hqMusicUrl:e.responseHqMusicUrl},b.value=!1,n.value=!0},j=async a=>{await f.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(e=>y.delete({url:"/mp/auto-reply/delete?id="+e}))(a),await M(),f.success("\u5220\u9664\u6210\u529F")},z=async()=>{var m;await((m=w.value)==null?void 0:m.validate());const a={...r.value};var e;a.responseMessageType=o.value.type,a.responseContent=o.value.content,a.responseMediaId=o.value.mediaId,a.responseMediaUrl=o.value.url,a.responseTitle=o.value.title,a.responseDescription=o.value.description,a.responseThumbMediaId=o.value.thumbMediaId,a.responseThumbMediaUrl=o.value.thumbMediaUrl,a.responseArticles=o.value.articles,a.responseMusicUrl=o.value.musicUrl,a.responseHqMusicUrl=o.value.hqMusicUrl,r.value.id!==void 0?(await(e=a,y.put({url:"/mp/auto-reply/update",data:e})),f.success("\u4FEE\u6539\u6210\u529F")):(await(x=>y.post({url:"/mp/auto-reply/create",data:x}))(a),f.success("\u65B0\u589E\u6210\u529F")),n.value=!1,await M()},T=()=>{var a;r.value={id:void 0,accountId:i.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===c.Keyword?1:void 0,requestMessageType:void 0},(a=w.value)==null||a.resetFields()},O=()=>{n.value=!1,T()};return(a,e)=>{const m=B,x=W,P=L,g=$,V=ae,E=ee,_=Z,C=le,G=X,Q=te,S=pe("hasPermi");return A(),ie(ce,null,[l(m,{title:"\u81EA\u52A8\u56DE\u590D",url:"https://doc.iocoder.cn/mp/auto-reply/"}),l(t(D),null,{default:s(()=>[l(P,{class:"-mb-15px",model:t(i),inline:!0,"label-width":"68px"},{default:s(()=>[l(x,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:s(()=>[l(t(se),{onChange:R})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(D),null,{default:s(()=>[l(G,{modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=d=>h(u)?u.value=d:null),onTabChange:F},{default:s(()=>[l(_,{gutter:10,class:"mb8"},{default:s(()=>[l(E,{span:1.5},{default:s(()=>[t(u)!==t(c).Follow||t(I).length<=0?ne((A(),me(V,{key:0,type:"primary",plain:"",onClick:H},{default:s(()=>[l(g,{icon:"ep:plus"}),e[4]||(e[4]=v("\u65B0\u589E "))]),_:1})),[[S,["mp:auto-reply:create"]]]):de("",!0)]),_:1})]),_:1}),l(C,{name:t(c).Follow},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:star",class:"mr-2px"}),e[5]||(e[5]=v(" \u5173\u6CE8\u65F6\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(C,{name:t(c).Message},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"ep:chat-line-round",class:"mr-2px"}),e[6]||(e[6]=v(" \u6D88\u606F\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(C,{name:t(c).Keyword},{label:s(()=>[l(_,{align:"middle"},{default:s(()=>[l(g,{icon:"fa:newspaper-o",class:"mr-2px"}),e[7]||(e[7]=v(" \u5173\u952E\u8BCD\u56DE\u590D"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(oe,{loading:t(U),list:t(I),"msg-type":t(u),onOnUpdate:N,onOnDelete:j},null,8,["loading","list","msg-type"]),l(Q,{title:t(b)?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:t(n),"onUpdate:modelValue":e[3]||(e[3]=d=>h(n)?n.value=d:null),width:"800px","destroy-on-close":""},{footer:s(()=>[l(V,{onClick:O},{default:s(()=>e[8]||(e[8]=[v("\u53D6 \u6D88")])),_:1}),l(V,{type:"primary",onClick:z},{default:s(()=>e[9]||(e[9]=[v("\u786E \u5B9A")])),_:1})]),default:s(()=>[l(J,{modelValue:t(r),"onUpdate:modelValue":e[1]||(e[1]=d=>h(r)?r.value=d:null),reply:t(o),"onUpdate:reply":e[2]||(e[2]=d=>h(o)?o.value=d:null),"msg-type":t(u),ref_key:"formRef",ref:w},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}}});export{ve as default};
