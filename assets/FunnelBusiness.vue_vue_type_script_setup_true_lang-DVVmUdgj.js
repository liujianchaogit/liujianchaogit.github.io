import{D as T}from"./index-DiGvuAxb.js";import{_ as W}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{_ as k}from"./Echart.vue_vue_type_script_setup_true_lang-DccU3tqu.js";import{S as f}from"./funnel-Bt-oN92Q.js";import{ac as q,i as A,j as D,ap as F,f as j,af as I,aj as N,_ as U,Z as G}from"./form-designer-drfGvdgz.js";import{k as H,r as m,P as L,e as M,l as O,m as h,G as R,H as a,z as t,E as v,u as l,A as V,y as Y}from"./form-create-D7wT855o.js";const Z=H({name:"FunnelBusiness",__name:"FunnelBusiness",props:{queryParams:{}},setup(g,{expose:S}){const p=g,d=m(!0),u=m(!1),c=m([]),n=L({title:{text:"\u9500\u552E\u6F0F\u6597"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}"},toolbox:{feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},legend:{data:["\u5BA2\u6237","\u5546\u673A","\u8D62\u5355"]},series:[{name:"\u9500\u552E\u6F0F\u6597",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",min:0,max:100,minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:[{value:60,name:"\u5BA2\u6237-0\u4E2A"},{value:40,name:"\u5546\u673A-0\u4E2A"},{value:20,name:"\u8D62\u5355-0\u4E2A"}]}]}),b=async s=>{d.value=s,await o()},o=async()=>{u.value=!0;const s=await f.getFunnelSummary(p.queryParams);if(s&&n.series&&n.series[0]&&n.series[0].data){const e=[];d.value?(e.push({value:60,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:40,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:20,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})):(e.push({value:s.customerCount||0,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:s.businessCount||0,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:s.businessWinCount||0,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})),n.series[0].data=e}c.value=await f.getBusinessSummaryByEndStatus(p.queryParams),u.value=!1};return S({loadData:o}),M(()=>{o()}),(s,e)=>{const y=j,w=F,C=k,x=I,P=D,$=A,_=q,i=U,E=W,B=G,z=N;return h(),O(R,null,[a(_,{shadow:"never"},{default:t(()=>[a($,null,{default:t(()=>[a(P,{span:24},{default:t(()=>[a(w,{class:"mb-10px"},{default:t(()=>[a(y,{type:"primary",onClick:e[0]||(e[0]=r=>b(!0))},{default:t(()=>e[2]||(e[2]=[v("\u5BA2\u6237\u89C6\u89D2")])),_:1}),a(y,{type:"primary",onClick:e[1]||(e[1]=r=>b(!1))},{default:t(()=>e[3]||(e[3]=[v("\u52A8\u6001\u89C6\u89D2")])),_:1})]),_:1}),a(x,{loading:l(u),animated:""},{default:t(()=>[a(C,{height:500,options:l(n)},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(_,{class:"mt-16px",shadow:"never"},{default:t(()=>[V((h(),Y(B,{data:l(c)},{default:t(()=>[a(i,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),a(i,{align:"center",label:"\u9636\u6BB5",prop:"endStatus",width:"200"},{default:t(r=>[a(E,{type:l(T).CRM_BUSINESS_END_STATUS_TYPE,value:r.row.endStatus},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5546\u673A\u6570","min-width":"200",prop:"businessCount"}),a(i,{align:"center",label:"\u5546\u673A\u603B\u91D1\u989D(\u5143)","min-width":"200",prop:"totalPrice"})]),_:1},8,["data"])),[[z,l(u)]])]),_:1})],64)}}});export{Z as _};
