import{h as G,d as J,u as K}from"./index-C1TKk8vI.js";import{g as Q,_ as U}from"./index-ArudIG2A.js";import{u as V}from"./tagsView-C2oS-OQq.js";import{b as W}from"./index-DdKGlDdM.js";import{_ as q}from"./ContractDetailsInfo.vue_vue_type_script_setup_true_lang-CXDSf-X7.js";import{_ as H}from"./ContractDetailsHeader.vue_vue_type_script_setup_true_lang-Dj403U1n.js";import{_ as P}from"./ContractProductList.vue_vue_type_script_setup_true_lang-_fXdV77N.js";import{B as s}from"./index-BuK0ap75.js";import{_ as X}from"./ContractForm.vue_vue_type_script_setup_true_lang-BL6ujW-4.js";import{_ as Y}from"./TransferForm.vue_vue_type_script_setup_true_lang-5gdfxDt4.js";import{_ as Z}from"./PermissionList.vue_vue_type_script_setup_true_lang-BPeTlrGi.js";import{_ as $}from"./index.vue_vue_type_script_setup_true_lang-Cc1LpVql.js";import{_ as tt}from"./ReceivableList.vue_vue_type_script_setup_true_lang-DMw2l6CX.js";import{_ as rt}from"./ReceivablePlanList.vue_vue_type_script_setup_true_lang-CP8phXHG.js";import{f as at,a0 as it,a1 as et,j as ot,aj as mt}from"./form-designer-BpYekVAY.js";import{x as lt,r as m,j as st,y as p,z as pt,G as ut,u as t,E as d,F as o,K as O,J as M,O as r,M as nt}from"./form-create-7GAbgMwl.js";import"./formatTime-EbFUBcAO.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CXvvgLEc.js";import"./DictTag.vue_vue_type_script_lang-B3VNccaT.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import"./index-Bdw660V1.js";import"./index-CZiMqbPE.js";import"./index-C_v5t3_7.js";import"./index-DLPyhh9r.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-BsCJVFcd.js";import"./index-C69xrZfi.js";import"./index-uXIyVRuV.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-C_qKaUAE.js";import"./index.vue_vue_type_script_setup_true_lang-CrL0kGRz.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-De4klYft.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-DrAuCfpX.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-B-IANjnk.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-D8lenXv5.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-C-tbO4kY.js";import"./index-2SiQtehE.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-w8Q4BfL1.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-Cgo1EbLC.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-DNhdDOrK.js";import"./index-R1Ohxk4X.js";import"./tree-COGD3qag.js";import"./index-pmRUIUos.js";import"./ReceivableForm.vue_vue_type_script_setup_true_lang-CpUQxp4U.js";import"./index-DZT3uREC.js";import"./ReceivablePlanForm.vue_vue_type_script_setup_true_lang-zqCBcaAo.js";const ct=lt({name:"CrmContractDetail",__name:"index",props:{id:{}},setup(g){const x=g,A=G(),I=J(),u=m(0),n=m(!0),a=m({}),c=m(),_=m(),b=async()=>{n.value=!0;try{a.value=await W(u.value),await N(u.value)}finally{n.value=!1}},y=m([]),N=async i=>{if(!i)return;const e=await Q({bizType:s.CRM_CONTRACT,bizId:i});y.value=e.list},v=m(),j=i=>{var e;(e=v.value)==null||e.createReceivable(i)},C=m(),h=()=>{var i;(i=C.value)==null||i.open(a.value.id)},{delView:F}=V(),{currentRoute:L}=K(),f=()=>{F(t(L))};return st(async()=>{const i=x.id||A.params.id;if(!i)return I.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5408\u540C\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void f();u.value=i,await b()}),(i,e)=>{const R=at,l=it,S=U,B=et,D=ot,E=mt;return p(),pt(nt,null,[ut((p(),d(H,{contract:t(a)},{default:o(()=>{var z,T;return[(z=t(c))!=null&&z.validateWrite?(p(),d(R,{key:0,onClick:e[0]||(e[0]=ft=>{return k="update",w=t(a).id,void _.value.open(k,w);var k,w})},{default:o(()=>e[1]||(e[1]=[O(" \u7F16\u8F91 ")])),_:1})):M("",!0),(T=t(c))!=null&&T.validateOwnerUser?(p(),d(R,{key:1,type:"primary",onClick:h},{default:o(()=>e[2]||(e[2]=[O(" \u8F6C\u79FB ")])),_:1})):M("",!0)]}),_:1},8,["contract"])),[[E,t(n)]]),r(D,null,{default:o(()=>[r(B,null,{default:o(()=>[r(l,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:o(()=>[r($,{"biz-id":t(a).id,"biz-type":t(s).CRM_CONTRACT},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u57FA\u672C\u4FE1\u606F"},{default:o(()=>[r(q,{contract:t(a)},null,8,["contract"])]),_:1}),r(l,{label:"\u4EA7\u54C1"},{default:o(()=>[r(P,{contract:t(a)},null,8,["contract"])]),_:1}),r(l,{label:"\u56DE\u6B3E"},{default:o(()=>[r(rt,{"contract-id":t(a).id,"customer-id":t(a).customerId,onCreateReceivable:j},null,8,["contract-id","customer-id"]),r(tt,{ref_key:"receivableListRef",ref:v,"contract-id":t(a).id,"customer-id":t(a).customerId},null,8,["contract-id","customer-id"])]),_:1}),r(l,{label:"\u56E2\u961F\u6210\u5458"},{default:o(()=>[r(Z,{ref_key:"permissionListRef",ref:c,"biz-id":t(a).id,"biz-type":t(s).CRM_CONTRACT,"show-action":!0,onQuitTeam:f},null,8,["biz-id","biz-type"])]),_:1}),r(l,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:o(()=>[r(S,{"log-list":t(y)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),r(X,{ref_key:"formRef",ref:_,onSuccess:b},null,512),r(Y,{ref_key:"transferFormRef",ref:C,"biz-type":t(s).CRM_CONTRACT,onSuccess:f},null,8,["biz-type"])],64)}}});export{ct as default};
