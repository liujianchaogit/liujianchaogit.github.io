import{a as G,d as H,h as R,D as Y}from"./index-DiGvuAxb.js";import{_ as $}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{P as g}from"./index-p5LjRz9j.js";import{P as J}from"./index-BpoDeB_2.js";import{P as K}from"./index-J-izylAb.js";import{C as W}from"./constants-C3gLHYOK.js";import{d as X,h as Z}from"./tree-COGD3qag.js";import{h as ee,i as ae,j as le,ai as de,k as oe,at as ue,x as re,Q as te,s as se,u as ie,l as me,aj as pe,f as ne}from"./form-designer-drfGvdgz.js";import{k as ce,r as i,P as fe,y as v,m as c,z as o,A as ve,u as l,H as e,l as x,G as I,$ as C,E as y,F as Ve,h as _e}from"./form-create-D7wT855o.js";const ge=ce({name:"ProductForm",__name:"ProductForm",emits:["success"],setup(ye,{expose:D,emit:S}){const{t:V}=G(),b=H(),m=i(!1),h=i(""),p=i(!1),P=i(""),u=i({id:void 0,name:void 0,barCode:void 0,categoryId:void 0,unitId:void 0,status:void 0,standard:void 0,remark:void 0,expiryDay:void 0,weight:void 0,purchasePrice:void 0,salePrice:void 0,minPrice:void 0}),q=fe({name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],barCode:[{required:!0,message:"\u4EA7\u54C1\u6761\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7B\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],unitId:[{required:!0,message:"\u5355\u4F4D\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u4EA7\u54C1\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),_=i(),w=i([]),k=i([]);D({open:async(s,a)=>{if(m.value=!0,h.value=V("action."+s),P.value=s,E(),a){p.value=!0;try{u.value=await g.getProduct(a)}finally{p.value=!1}}const n=await J.getProductCategorySimpleList();w.value=Z(n,"id","parentId"),k.value=await K.getProductUnitSimpleList()}});const F=S,A=async()=>{await _.value.validate(),p.value=!0;try{const s=u.value;P.value==="create"?(await g.createProduct(s),b.success(V("common.createSuccess"))):(await g.updateProduct(s),b.success(V("common.updateSuccess"))),m.value=!1,F("success")}finally{p.value=!1}},E=()=>{var s;u.value={id:void 0,name:void 0,barCode:void 0,categoryId:void 0,unitId:void 0,status:W.ENABLE,standard:void 0,remark:void 0,expiryDay:void 0,weight:void 0,purchasePrice:void 0,salePrice:void 0,minPrice:void 0},(s=_.value)==null||s.resetFields()};return(s,a)=>{const n=oe,r=de,t=le,L=ue,N=te,T=re,j=ie,z=se,f=me,M=ae,O=ee,U=ne,Q=$,B=pe;return c(),v(Q,{title:l(h),modelValue:l(m),"onUpdate:modelValue":a[13]||(a[13]=d=>_e(m)?m.value=d:null)},{footer:o(()=>[e(U,{onClick:A,type:"primary",disabled:l(p)},{default:o(()=>a[14]||(a[14]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),e(U,{onClick:a[12]||(a[12]=d=>m.value=!1)},{default:o(()=>a[15]||(a[15]=[y("\u53D6 \u6D88")])),_:1})]),default:o(()=>[ve((c(),v(O,{ref_key:"formRef",ref:_,model:l(u),rules:l(q),"label-width":"100px"},{default:o(()=>[e(M,{gutter:20},{default:o(()=>[e(t,{span:12},{default:o(()=>[e(r,{label:"\u540D\u79F0",prop:"name"},{default:o(()=>[e(n,{modelValue:l(u).name,"onUpdate:modelValue":a[0]||(a[0]=d=>l(u).name=d),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u6761\u7801",prop:"barCode"},{default:o(()=>[e(n,{modelValue:l(u).barCode,"onUpdate:modelValue":a[1]||(a[1]=d=>l(u).barCode=d),placeholder:"\u8BF7\u8F93\u5165\u6761\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u5206\u7C7B",prop:"categoryId"},{default:o(()=>[e(L,{modelValue:l(u).categoryId,"onUpdate:modelValue":a[2]||(a[2]=d=>l(u).categoryId=d),data:l(w),props:l(X),"check-strictly":"","default-expand-all":"",placeholder:"\u8BF7\u9009\u62E9\u5206\u7C7B",class:"w-1/1"},null,8,["modelValue","data","props"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u5355\u4F4D",prop:"unitId"},{default:o(()=>[e(T,{modelValue:l(u).unitId,"onUpdate:modelValue":a[3]||(a[3]=d=>l(u).unitId=d),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D",class:"w-1/1"},{default:o(()=>[(c(!0),x(I,null,C(l(k),d=>(c(),v(N,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[e(z,{modelValue:l(u).status,"onUpdate:modelValue":a[4]||(a[4]=d=>l(u).status=d)},{default:o(()=>[(c(!0),x(I,null,C(l(R)(l(Y).COMMON_STATUS),d=>(c(),v(j,{key:d.value,value:d.value},{default:o(()=>[y(Ve(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u89C4\u683C",prop:"standard"},{default:o(()=>[e(n,{modelValue:l(u).standard,"onUpdate:modelValue":a[5]||(a[5]=d=>l(u).standard=d),placeholder:"\u8BF7\u8F93\u5165\u89C4\u683C"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u4FDD\u8D28\u671F\u5929\u6570",prop:"expiryDay"},{default:o(()=>[e(f,{modelValue:l(u).expiryDay,"onUpdate:modelValue":a[6]||(a[6]=d=>l(u).expiryDay=d),placeholder:"\u8BF7\u8F93\u5165\u4FDD\u8D28\u671F\u5929\u6570",min:0,precision:0,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u91CD\u91CF\uFF08kg\uFF09",prop:"weight"},{default:o(()=>[e(f,{modelValue:l(u).weight,"onUpdate:modelValue":a[7]||(a[7]=d=>l(u).weight=d),placeholder:"\u8BF7\u8F93\u5165\u91CD\u91CF\uFF08kg\uFF09",min:0,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u91C7\u8D2D\u4EF7\u683C",prop:"purchasePrice"},{default:o(()=>[e(f,{modelValue:l(u).purchasePrice,"onUpdate:modelValue":a[8]||(a[8]=d=>l(u).purchasePrice=d),placeholder:"\u8BF7\u8F93\u5165\u91C7\u8D2D\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u9500\u552E\u4EF7\u683C",prop:"salePrice"},{default:o(()=>[e(f,{modelValue:l(u).salePrice,"onUpdate:modelValue":a[9]||(a[9]=d=>l(u).salePrice=d),placeholder:"\u8BF7\u8F93\u5165\u9500\u552E\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:12},{default:o(()=>[e(r,{label:"\u6700\u4F4E\u4EF7\u683C",prop:"minPrice"},{default:o(()=>[e(f,{modelValue:l(u).minPrice,"onUpdate:modelValue":a[10]||(a[10]=d=>l(u).minPrice=d),placeholder:"\u8BF7\u8F93\u5165\u6700\u4F4E\u4EF7\u683C\uFF0C\u5355\u4F4D\uFF1A\u5143",min:0,precision:2,class:"!w-1/1"},null,8,["modelValue"])]),_:1})]),_:1}),e(t,{span:24},{default:o(()=>[e(r,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[e(n,{type:"textarea",modelValue:l(u).remark,"onUpdate:modelValue":a[11]||(a[11]=d=>l(u).remark=d),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[B,l(p)]])]),_:1},8,["title","modelValue"])}}});export{ge as _};
