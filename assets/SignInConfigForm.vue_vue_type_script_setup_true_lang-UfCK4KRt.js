import{V as p,b as T,d as j,e as z,D as B}from"./index-C1TKk8vI.js";import{_ as D}from"./Dialog.vue_vue_type_style_index_0_lang-CB5cl-Ts.js";import{C as G}from"./constants-IYPHa1Ih.js";import{l as I,a7 as K,ai as R,u as X,s as H,h as J,f as P,aj as Q}from"./form-designer-BpYekVAY.js";import{x as W,r as d,X as Y,y as f,E as b,F as i,O as u,u as a,K as g,G as Z,z as $,M as ee,a4 as ae,L as le,l as se}from"./form-create-7GAbgMwl.js";const te=async()=>await p.get({url:"/member/sign-in/config/list"}),ie=async _=>await p.delete({url:"/member/sign-in/config/delete?id="+_}),ue=W({__name:"SignInConfigForm",emits:["success"],setup(_,{expose:O,emit:S}){const{t:v}=T(),V=j(),o=d(!1),x=d(""),n=d(!1),w=d(""),l=d({}),U=(s,e,r)=>{if(!l.value.point&&!l.value.experience)return void r(new Error("\u5956\u52B1\u79EF\u5206\u4E0E\u5956\u52B1\u7ECF\u9A8C\u81F3\u5C11\u914D\u7F6E\u4E00\u4E2A"));const y=(s==null?void 0:s.field)==="point"?"experience":"point";m.value.validateField(y,()=>null),r()},k=Y({day:[{required:!0,message:"\u7B7E\u5230\u5929\u6570\u4E0D\u80FD\u7A7A",trigger:"blur"}],point:[{required:!0,message:"\u5956\u52B1\u79EF\u5206\u4E0D\u80FD\u7A7A",trigger:"blur"},{validator:U,trigger:"blur"}],experience:[{required:!0,message:"\u5956\u52B1\u7ECF\u9A8C\u4E0D\u80FD\u7A7A",trigger:"blur"},{validator:U,trigger:"blur"}]}),m=d();O({open:async(s,e)=>{if(o.value=!0,x.value=v("action."+s),w.value=s,F(),e){n.value=!0;try{l.value=await(async r=>await p.get({url:"/member/sign-in/config/get?id="+r}))(e)}finally{n.value=!1}}}});const q=S,E=async()=>{if(m&&await m.value.validate()){n.value=!0;try{w.value==="create"?(await(async s=>await p.post({url:"/member/sign-in/config/create",data:s}))(l.value),V.success(v("common.createSuccess"))):(await(async s=>await p.put({url:"/member/sign-in/config/update",data:s}))(l.value),V.success(v("common.updateSuccess"))),o.value=!1,q("success")}finally{n.value=!1}}},F=()=>{var s;l.value={id:void 0,day:void 0,point:0,experience:0,status:G.ENABLE},(s=m.value)==null||s.resetFields()};return(s,e)=>{const r=I,y=K,c=R,M=X,h=H,A=J,C=P,L=D,N=Q;return f(),b(L,{title:a(x),modelValue:a(o),"onUpdate:modelValue":e[5]||(e[5]=t=>se(o)?o.value=t:null)},{footer:i(()=>[u(C,{onClick:E,type:"primary",disabled:a(n)},{default:i(()=>e[7]||(e[7]=[g("\u786E \u5B9A")])),_:1},8,["disabled"]),u(C,{onClick:e[4]||(e[4]=t=>o.value=!1)},{default:i(()=>e[8]||(e[8]=[g("\u53D6 \u6D88")])),_:1})]),default:i(()=>[Z((f(),b(A,{ref_key:"formRef",ref:m,model:a(l),rules:a(k),"label-width":"100px"},{default:i(()=>[u(c,{label:"\u7B7E\u5230\u5929\u6570",prop:"day"},{default:i(()=>[u(r,{modelValue:a(l).day,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).day=t),min:1,max:7,precision:0},null,8,["modelValue"]),u(y,{class:"mx-1",style:{"margin-left":"10px"},type:"danger"},{default:i(()=>e[6]||(e[6]=[g(" \u53EA\u5141\u8BB8\u8BBE\u7F6E 1-7\uFF0C\u9ED8\u8BA4\u7B7E\u5230 7 \u5929\u4E3A\u4E00\u4E2A\u5468\u671F ")])),_:1})]),_:1}),u(c,{label:"\u5956\u52B1\u79EF\u5206",prop:"point"},{default:i(()=>[u(r,{modelValue:a(l).point,"onUpdate:modelValue":e[1]||(e[1]=t=>a(l).point=t),min:0,precision:0},null,8,["modelValue"])]),_:1}),u(c,{label:"\u5956\u52B1\u7ECF\u9A8C",prop:"experience"},{default:i(()=>[u(r,{modelValue:a(l).experience,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).experience=t),min:0,precision:0},null,8,["modelValue"])]),_:1}),u(c,{label:"\u5F00\u542F\u72B6\u6001",prop:"status"},{default:i(()=>[u(h,{modelValue:a(l).status,"onUpdate:modelValue":e[3]||(e[3]=t=>a(l).status=t)},{default:i(()=>[(f(!0),$(ee,null,ae(a(z)(a(B).COMMON_STATUS),t=>(f(),b(M,{key:t.value,value:t.value},{default:i(()=>[g(le(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[N,a(n)]])]),_:1},8,["title","modelValue"])}}});export{ue as _,ie as d,te as g};
