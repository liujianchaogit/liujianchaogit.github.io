import{d as H,_ as L}from"./index-DiGvuAxb.js";import{_ as N}from"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";import{k as P,r as n,P as Q,y as b,m as v,z as o,H as a,u as l,l as $,G as B,$ as D,Z as I,E as _,A as J,h as M}from"./form-create-D7wT855o.js";import{b as O,c as W}from"./index-CxqcPtv1.js";import{g as X}from"./index-Hyo7zWMy.js";import{h as Y,ai as ee,x as ae,Q as le,k as oe,f as te,i as de,Z as ne,_ as se,aj as ue}from"./form-designer-drfGvdgz.js";const me=P({name:"InfraCodegenImportTable",__name:"ImportTable",emits:["success"],setup(re,{expose:k,emit:x}){const S=H(),u=n(!1),s=n(!0),h=n([]),t=Q({name:void 0,comment:void 0,dataSourceConfigId:0}),R=n(),r=n([]),m=async()=>{s.value=!0;try{h.value=await O(t)}finally{s.value=!1}},U=async()=>{t.name=void 0,t.comment=void 0,t.dataSourceConfigId=r.value[0].id,await m()};k({open:async()=>{r.value=await X(),t.dataSourceConfigId=r.value[0].id,u.value=!0,await m()}});const w=()=>{u.value=!1,i.value=[]},g=n(),i=n([]),K=c=>{var e;(e=l(g))==null||e.toggleRowSelection(c)},Z=c=>{i.value=c.map(e=>e.name)},T=async()=>{s.value=!0;try{await W({dataSourceConfigId:t.dataSourceConfigId,tableNames:i.value}),S.success("\u5BFC\u5165\u6210\u529F"),j("success"),w()}finally{s.value=!1}},j=x;return(c,e)=>{const q=le,z=ae,p=ee,C=oe,V=L,f=te,A=Y,y=se,E=de,F=N,G=ue;return v(),b(F,{modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=d=>M(u)?u.value=d:null),title:"\u5BFC\u5165\u8868",width:"800px"},{footer:o(()=>[a(f,{disabled:l(i).length===0||l(s),type:"primary",onClick:T},{default:o(()=>e[6]||(e[6]=[_(" \u5BFC\u5165 ")])),_:1},8,["disabled"]),a(f,{onClick:w},{default:o(()=>e[7]||(e[7]=[_("\u5173\u95ED")])),_:1})]),default:o(()=>[a(A,{ref_key:"queryFormRef",ref:R,inline:!0,model:l(t),"label-width":"68px"},{default:o(()=>[a(p,{label:"\u6570\u636E\u6E90",prop:"dataSourceConfigId"},{default:o(()=>[a(z,{modelValue:l(t).dataSourceConfigId,"onUpdate:modelValue":e[0]||(e[0]=d=>l(t).dataSourceConfigId=d),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90"},{default:o(()=>[(v(!0),$(B,null,D(l(r),d=>(v(),b(q,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u540D\u79F0",prop:"name"},{default:o(()=>[a(C,{modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=d=>l(t).name=d),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",onKeyup:I(m,["enter"])},null,8,["modelValue"])]),_:1}),a(p,{label:"\u8868\u63CF\u8FF0",prop:"comment"},{default:o(()=>[a(C,{modelValue:l(t).comment,"onUpdate:modelValue":e[2]||(e[2]=d=>l(t).comment=d),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",onKeyup:I(m,["enter"])},null,8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(f,{onClick:m},{default:o(()=>[a(V,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=_(" \u641C\u7D22 "))]),_:1}),a(f,{onClick:U},{default:o(()=>[a(V,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=_(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"]),a(E,null,{default:o(()=>[J((v(),b(l(ne),{ref_key:"tableRef",ref:g,data:l(h),height:"260px",onRowClick:K,onSelectionChange:Z},{default:o(()=>[a(y,{type:"selection",width:"55"}),a(y,{"show-overflow-tooltip":!0,label:"\u8868\u540D\u79F0",prop:"name"}),a(y,{"show-overflow-tooltip":!0,label:"\u8868\u63CF\u8FF0",prop:"comment"})]),_:1},8,["data"])),[[G,l(s)]])]),_:1})]),_:1},8,["modelValue"])}}});export{me as _};
