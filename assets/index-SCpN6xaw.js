import{d as pe,a as re,u as ce,h as ue,D as V,_ as de}from"./index-DiGvuAxb.js";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang-BymgqOtI.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-CByQaegm.js";import{_ as ge}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C0SI8VIx.js";import{k as xe,r as g,P as ye,e as ve,af as _e,l as N,m as n,H as l,z as t,u as s,Z as be,G as U,$ as F,y as r,A as x,E as d,C as q,v as i,F as k,B as ke}from"./form-create-D7wT855o.js";import{d as he}from"./formatTime-DeTj2b0K.js";import{P as I}from"./index-Dns6CMpc.js";import{_ as we}from"./PluginConfigForm.vue_vue_type_script_setup_true_lang-CZOBLEAD.js";import{h as Ce,ai as Pe,k as Te,x as Ve,Q as Ne,ap as Ue,f as Ie,Z as Se,_ as De,D as Ee,aj as Le,i as Oe,j as je,ac as ze,ak as Ge,a6 as Ye,V as Fe}from"./form-designer-drfGvdgz.js";import"./color-BN7ZL7BD.js";import"./Dialog.vue_vue_type_style_index_0_lang-WG3ZquOK.js";const qe={class:"p-4 relative"},Ke={class:"flex items-center mb-3"},Ae={class:"mr-2.5 flex items-center"},Re={class:"text-[16px] font-600 flex-1"},Ze={class:"inline-flex items-center"},Be={class:"flex items-center text-[14px]"},He={class:"flex-1"},Qe={class:"mb-2.5 last:mb-0"},$e={class:"text-[#0b1d30] whitespace-normal break-all"},Je={class:"mb-2.5 last:mb-0"},Me={class:"text-[#0b1d30]"},We={class:"mb-2.5 last:mb-0"},Xe={class:"text-[#0b1d30]"},el={class:"mb-2.5 last:mb-0"},ll={class:"flex items-center px-0"},al=xe({name:"IoTPlugin",__name:"index",setup(tl){const b=pe(),{t:K}=re(),C=g(!0),P=g([]),S=g(0),o=ye({pageNo:1,pageSize:10,name:void 0,status:void 0}),D=g(),A=g("/src/assets/svgs/iot/card-fill.svg"),y=g("card"),v=async()=>{C.value=!0;try{const c=await I.getPluginConfigPage(o);P.value=c.list,S.value=c.total}finally{C.value=!1}},h=()=>{o.pageNo=1,v()},R=()=>{D.value.resetFields(),h()},E=g(),T=(c,e)=>{E.value.open(c,e)},{push:Z}=ce(),L=c=>{Z({name:"IoTPluginDetail",params:{id:c}})},O=async c=>{try{await b.delConfirm(),await I.deletePluginConfig(c),b.success(K("common.delSuccess")),await v()}catch{}};return ve(()=>{v()}),(c,e)=>{const B=Te,w=Pe,H=Ne,Q=Ve,m=de,p=Ie,$=Ue,J=Ce,j=ge,f=De,z=fe,M=Ee,W=Se,X=Ge,ee=Ye,le=Fe,ae=ze,te=je,se=Oe,ie=me,_=_e("hasPermi"),ne=Le;return n(),N(U,null,[l(j,null,{default:t(()=>[l(J,{class:"-mb-15px",model:s(o),ref_key:"queryFormRef",ref:D,inline:!0,"label-width":"68px"},{default:t(()=>[l(w,{label:"\u63D2\u4EF6\u540D\u79F0",prop:"name"},{default:t(()=>[l(B,{modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=a=>s(o).name=a),placeholder:"\u8BF7\u8F93\u5165\u63D2\u4EF6\u540D\u79F0",clearable:"",onKeyup:be(h,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(w,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[l(Q,{modelValue:s(o).status,"onUpdate:modelValue":e[1]||(e[1]=a=>s(o).status=a),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:"",onChange:h,class:"!w-240px"},{default:t(()=>[(n(!0),N(U,null,F(s(ue)(s(V).IOT_PLUGIN_STATUS),a=>(n(),r(H,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(w,{class:"float-right !mr-0 !mb-0"},{default:t(()=>[l($,null,{default:t(()=>[l(p,{type:s(y)==="card"?"primary":"default",onClick:e[2]||(e[2]=a=>y.value="card")},{default:t(()=>[l(m,{icon:"ep:grid"})]),_:1},8,["type"]),l(p,{type:s(y)==="list"?"primary":"default",onClick:e[3]||(e[3]=a=>y.value="list")},{default:t(()=>[l(m,{icon:"ep:list"})]),_:1},8,["type"])]),_:1})]),_:1}),l(w,null,{default:t(()=>[l(p,{onClick:h},{default:t(()=>[l(m,{icon:"ep:search",class:"mr-5px"}),e[7]||(e[7]=d(" \u641C\u7D22"))]),_:1}),l(p,{onClick:R},{default:t(()=>[l(m,{icon:"ep:refresh",class:"mr-5px"}),e[8]||(e[8]=d(" \u91CD\u7F6E"))]),_:1}),x((n(),r(p,{type:"primary",plain:"",onClick:e[4]||(e[4]=a=>T("create"))},{default:t(()=>[l(m,{icon:"ep:plus",class:"mr-5px"}),e[9]||(e[9]=d(" \u65B0\u589E "))]),_:1})),[[_,["iot:plugin-config:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(j,null,{default:t(()=>[s(y)==="list"?x((n(),r(W,{key:0,data:s(P),stripe:!0,"show-overflow-tooltip":!0},{default:t(()=>[l(f,{label:"\u63D2\u4EF6\u540D\u79F0",align:"center",prop:"name"}),l(f,{label:"\u63D2\u4EF6\u6807\u8BC6",align:"center",prop:"pluginKey"}),l(f,{label:"jar \u5305",align:"center",prop:"fileName"}),l(f,{label:"\u7248\u672C\u53F7",align:"center",prop:"version"}),l(f,{label:"\u90E8\u7F72\u65B9\u5F0F",align:"center",prop:"deployType"},{default:t(a=>[l(z,{type:s(V).IOT_PLUGIN_DEPLOY_TYPE,value:a.row.deployType},null,8,["type","value"])]),_:1}),l(f,{label:"\u72B6\u6001",align:"center",prop:"status"},{default:t(a=>[l(M,{modelValue:a.row.status,"onUpdate:modelValue":u=>a.row.status=u,"active-value":1,"inactive-value":0,onChange:u=>(async(oe,G)=>{try{const Y=G===1?"\u542F\u7528":"\u505C\u7528";await b.confirm('\u786E\u8BA4\u8981"'+Y+'"\u63D2\u4EF6\u5417?'),await I.updatePluginStatus({id:oe,status:G}),b.success("\u66F4\u65B0\u72B6\u6001\u6210\u529F"),v()}catch{b.error("\u66F4\u65B0\u72B6\u6001\u5931\u8D25")}})(a.row.id,Number(u))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(f,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:s(he),width:"180px"},null,8,["formatter"]),l(f,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:t(a=>[x((n(),r(p,{link:"",type:"primary",onClick:u=>L(a.row.id)},{default:t(()=>e[10]||(e[10]=[d(" \u67E5\u770B ")])),_:2},1032,["onClick"])),[[_,["iot:product:query"]]]),x((n(),r(p,{link:"",type:"primary",onClick:u=>T("update",a.row.id)},{default:t(()=>e[11]||(e[11]=[d(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["iot:plugin-config:update"]]]),x((n(),r(p,{link:"",type:"danger",onClick:u=>O(a.row.id)},{default:t(()=>e[12]||(e[12]=[d(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["iot:plugin-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[ne,s(C)]]):q("",!0),s(y)==="card"?(n(),r(se,{key:1,gutter:16},{default:t(()=>[(n(!0),N(U,null,F(s(P),a=>(n(),r(te,{key:a.id,xs:24,sm:12,md:12,lg:6,class:"mb-4"},{default:t(()=>[l(ae,{class:"h-full transition-colors relative overflow-hidden","body-style":{padding:"0"}},{default:t(()=>[i("div",qe,[i("div",Ke,[i("div",Ae,[l(X,{src:s(A),class:"w-[18px] h-[18px]"},null,8,["src"])]),i("div",Re,k(a.name),1),i("div",Ze,[i("div",{class:ke(["w-1 h-1 rounded-full mr-1.5",a.status===1?"bg-[var(--el-color-success)]":"bg-[var(--el-color-danger)]"])},null,2),l(ee,{class:"!text-xs font-bold",type:a.status===1?"success":"danger"},{default:t(()=>[d(k(a.status===1?"\u5F00\u542F":"\u7981\u7528"),1)]),_:2},1032,["type"])])]),i("div",Be,[i("div",He,[i("div",Qe,[e[13]||(e[13]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u63D2\u4EF6\u6807\u8BC6",-1)),i("span",$e,k(a.pluginKey),1)]),i("div",Je,[e[14]||(e[14]=i("span",{class:"text-[#717c8e] mr-2.5"},"jar \u5305",-1)),i("span",Me,k(a.fileName),1)]),i("div",We,[e[15]||(e[15]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u7248\u672C\u53F7",-1)),i("span",Xe,k(a.version),1)]),i("div",el,[e[16]||(e[16]=i("span",{class:"text-[#717c8e] mr-2.5"},"\u90E8\u7F72\u65B9\u5F0F",-1)),l(z,{type:s(V).IOT_PLUGIN_DEPLOY_TYPE,value:a.deployType},null,8,["type","value"])])])]),l(le,{class:"!my-3"}),i("div",ll,[x((n(),r(p,{class:"flex-1 !px-2 !h-[32px] text-[13px]",type:"primary",plain:"",onClick:u=>T("update",a.id)},{default:t(()=>[l(m,{icon:"ep:edit-pen",class:"mr-1"}),e[17]||(e[17]=d(" \u7F16\u8F91 "))]),_:2},1032,["onClick"])),[[_,["iot:plugin-config:update"]]]),l(p,{class:"flex-1 !px-2 !h-[32px] !ml-[10px] text-[13px]",type:"warning",plain:"",onClick:u=>L(a.id)},{default:t(()=>[l(m,{icon:"ep:view",class:"mr-1"}),e[18]||(e[18]=d(" \u8BE6\u60C5 "))]),_:2},1032,["onClick"]),e[19]||(e[19]=i("div",{class:"mx-[10px] h-[20px] w-[1px] bg-[#dcdfe6]"},null,-1)),x((n(),r(p,{class:"!px-2 !h-[32px] text-[13px]",type:"danger",plain:"",onClick:u=>O(a.id)},{default:t(()=>[l(m,{icon:"ep:delete"})]),_:2},1032,["onClick"])),[[_,["iot:device:delete"]]])])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):q("",!0),l(ie,{total:s(S),page:s(o).pageNo,"onUpdate:page":e[5]||(e[5]=a=>s(o).pageNo=a),limit:s(o).pageSize,"onUpdate:limit":e[6]||(e[6]=a=>s(o).pageSize=a),onPagination:v},null,8,["total","page","limit"])]),_:1}),l(we,{ref_key:"formRef",ref:E,onSuccess:v},null,512)],64)}}});export{al as default};
